graph TB
    subgraph "Phase 3: Advanced OpenAI Patterns Architecture"
        subgraph "Pattern Registry (Enhanced)"
            PR[Pattern Registry]
            PR -->|6 patterns| LG[LangGraph Patterns]
            PR -->|6 patterns| OA[OpenAI Patterns]
        end

        subgraph "OpenAI Patterns (Phase 3)"
            OA --> AP[Assistant Pattern âœ…]
            OA --> FCP[Function Calling âœ…]
            OA --> CP[Conversation Pattern ðŸš§]
            OA --> SP[Streaming Pattern ðŸš§]
            OA --> MAP[Multi-Agent Pattern ðŸš§]
            OA --> RP[RAG Pattern ðŸš§]
        end

        subgraph "Conversation Pattern Components"
            CP --> CM[ConversationManager]
            CP --> CPR[ContextPreserver]
            CP --> CF[ConversationFormatter]
            CM --> TH[Thread History]
            CPR --> IC[Investigation Context]
            CF --> MF[MessageFormatter]
        end

        subgraph "Streaming Pattern Components"
            SP --> ASH[AdvancedStreamingHandler]
            SP --> PA[ProgressiveAnalyzer]
            SP --> SC[StreamingCoordinator]
            ASH --> WS[WebSocket Manager]
            PA --> RA[Risk Analysis Updates]
            SC --> RT[Real-time Broadcasting]
        end

        subgraph "Multi-Agent Pattern Components"
            MAP --> AC[AgentCoordinator]
            MAP --> HM[HandoffManager]
            MAP --> RS[ResultSynthesizer]
            AC --> DA[Domain Agents]
            HM --> AH[Agent Handoffs]
            RS --> FR[Fraud Results]
        end

        subgraph "RAG Pattern Components"
            RP --> RR[RAGRetriever]
            RP --> KE[KnowledgeEnhancer]
            RP --> VSI[VectorSearchIntegrator]
            RR --> KB[Knowledge Base]
            KE --> CA[Context Augmentation]
            VSI --> VS[Vector Search]
        end

        subgraph "Tool Ecosystem Integration"
            TE[Tool Ecosystem]
            TE --> ST[Splunk Tool]
            TE --> SLT[SumoLogic Tool]
            TE --> SNT[Snowflake Tool]
            TE --> RET[Retriever Tool]
            CP & SP & MAP & RP --> TE
        end

        subgraph "WebSocket Infrastructure"
            WSI[WebSocket Infrastructure]
            WSI --> SH[StreamingHandler]
            WSI --> WB[WebSocket Broadcasting]
            WSI --> PC[Progress Channels]
            SP --> WSI
            CP --> WSI
        end

        subgraph "Domain Agent Integration"
            DAI[Domain Agents]
            DAI --> NA[Network Agent]
            DAI --> DEA[Device Agent]
            DAI --> LA[Location Agent]
            DAI --> LOA[Logs Agent]
            MAP --> DAI
        end

        subgraph "Knowledge Systems"
            KS[Knowledge Systems]
            KS --> VDB[Vector Database]
            KS --> HD[Historical Data]
            KS --> FP[Fraud Patterns]
            RP --> KS
        end
    end

    subgraph "Implementation Flow"
        IF1[Week 5.1: Conversation Pattern]
        IF2[Week 5.2: Streaming Pattern]
        IF3[Week 6.1: Multi-Agent Pattern]
        IF4[Week 6.2: RAG Pattern]
        IF1 --> IF2 --> IF3 --> IF4
    end

    subgraph "Quality Assurance"
        QA1[Unit Testing]
        QA2[Integration Testing]
        QA3[Performance Testing]
        QA4[Security Review]
        QA1 & QA2 & QA3 --> QA4
    end

    style CP fill:#FFE4B5
    style SP fill:#FFE4B5
    style MAP fill:#FFE4B5
    style RP fill:#FFE4B5
    style AP fill:#90EE90
    style FCP fill:#90EE90