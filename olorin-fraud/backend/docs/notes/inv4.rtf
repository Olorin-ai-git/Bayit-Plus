{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Bold;\f1\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red180\green36\blue25;\red46\green174\blue187;\red0\green0\blue0;
\red64\green11\blue217;\red159\green160\blue28;\red47\green180\blue29;}
{\*\expandedcolortbl;;\cssrgb\c76411\c21697\c12527;\cssrgb\c20199\c73241\c78251;\csgray\c0;
\cssrgb\c32309\c18666\c88229;\cssrgb\c68469\c68012\c14211;\cssrgb\c20241\c73898\c14950;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs22 \cf2 \CocoaLigature0 \uc0\u10140   \cf3 olorin-server
\f1\b0 \cf4  
\f0\b \cf5 git:(\cf2 001-you-editing-fraud\cf5 ) \cf6 \uc0\u10007 
\f1\b0 \cf4  ./scripts/start_server.sh\
\cf5 [*]\cf4  Olorin Server Startup Script\
\uc0\u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \
\cf7 [\uc0\u10003 ]\cf4  Firebase CLI found\
\cf5 [*]\cf4  Retrieving secrets (.env first, then Firebase project: olorin-ai)\
\cf7 [\uc0\u10003 ]\cf4  JWT_SECRET_KEY retrieved\
\cf7 [\uc0\u10003 ]\cf4  ANTHROPIC_API_KEY retrieved\
\cf7 [\uc0\u10003 ]\cf4  OPENAI_API_KEY retrieved\
\cf7 [\uc0\u10003 ]\cf4  Snowflake configuration loaded\
\cf5    \uc0\u55357 \u56522  Snowflake Connection Details:\cf4 \
\cf5    \uc0\u9492 \u9472  Account: 
\f0\b \cf6 ETMZUSX-LW98386
\f1\b0 \cf4 \
\cf5    \uc0\u9492 \u9472  User: 
\f0\b \cf6 manual_review_agent_ro
\f1\b0 \cf4 \
\cf5    \uc0\u9492 \u9472  Database: 
\f0\b \cf6 DBT
\f1\b0 \cf4 \
\cf5    \uc0\u9492 \u9472  Schema: 
\f0\b \cf6 DBT_PROD
\f1\b0 \cf4 \
\cf5    \uc0\u9492 \u9472  Warehouse: 
\f0\b \cf6 manual_review_agent_wh
\f1\b0 \cf4 \
\cf5    \uc0\u9492 \u9472  Role: 
\f0\b \cf6 PUBLIC
\f1\b0 \cf4 \
\cf5    \uc0\u9492 \u9472  Full Table: \cf7 DBT.DBT_PROD.TRANSACTIONS_ENRICHED\cf4 \
\cf7 [\uc0\u10003 ]\cf4  Secrets loaded successfully\
\cf5 [*]\cf4  Starting Olorin server on port 8090 with log level: info\
\cf7 [\uc0\u10003 ]\cf4  Changed to directory: /Users/gklainert/Documents/olorin/olorin-server\
\cf5 [*]\cf4  Checking Poetry dependencies...\
\cf7 [\uc0\u10003 ]\cf4  Server starting...\
\cf5 \uc0\u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \cf4 \
\cf7    Olorin Server - Running on http://localhost:8090\cf4 \
\cf7    API Docs: http://localhost:8090/docs\cf4 \
\cf7    Health: http://localhost:8090/health\cf4 \
\cf5 \uc0\u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \u9552 \cf4 \
\cf5 [*]\cf4  Starting server in foreground to display all startup and connection logs...\
\
\cf7 \uc0\u55357 \u56960  Server starting - you will see all startup logs including Snowflake connection attempts!\cf4 \
\
2025-11-14 07:56:13 \cf5 [INFO]\cf4  app.service.middleware.middleware_config: CORS configured for local environment with 16 allowed origins\
2025-11-14 07:56:13,050 [INFO] app.service.middleware.middleware_config: [] Investigation ID middleware configured for log stream correlation\
2025-11-14 07:56:13,051 [INFO] app.service.middleware.middleware_config: [] Rate limiting configured for local: 500 requests per 60 seconds\
2025-11-14 07:56:13,051 [INFO] app.middleware.logstream_rate_limiter: [] Log stream rate limiting configured for local: streaming=30 req/60s, ingestion=20 req/60s\
2025-11-14 07:56:13,283 [INFO] app.service.config_loader: [] Loaded .env configuration from /Users/gklainert/Documents/olorin/olorin-server/.env\
2025-11-14 07:56:13,283 [INFO] app.service.config_loader: [] Firebase Secret Manager disabled - using .env only\
2025-11-14 07:56:13,283 [INFO] app.service.config_loader: [] ConfigLoader initialized for environment: local\
2025-11-14 07:56:13,283 [INFO] app.security.auth: [] JWT secret loaded from Firebase Secrets Manager\
2025-11-14 07:56:13,286 [INFO] app.service.middleware.middleware_config: [] Production error middleware configured for environment: local\
2025-11-14 07:56:13,684 [INFO] app.service.agent.journey_tracker: [] Initialized LangGraphJourneyTracker with output: logs/journey_tracking\
2025-11-14 07:56:13,686 [INFO] app.service.agent.chain_of_thought_logger: [] Initialized ChainOfThoughtLogger with directory: logs/chain_of_thought\
\uc0\u9989  Loaded .env file with 13 enabled tools\
\uc0\u9989  Schema constants loaded: 333 columns validated for DBT.DBT_PROD.TXS (SNOWFLAKE)\
2025-11-14 07:56:13,872 [INFO] app.service.agent.tools.snowflake_tool.client: [] Using REAL Snowflake client (USE_SNOWFLAKE=true)\
[API_ROUTER] Attempting to import analytics router...\
2025-11-14 07:56:16,778 [INFO] app.router.api_router: [] Attempting to import analytics router...\
2025-11-14 07:56:16,780 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.cohort_analyzer: [] CohortAnalyzer initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.experiment_manager: [] ExperimentManager initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.drift_detector: [] DriftDetector initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.replay_engine: [] ReplayEngine initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.explainer: [] Explainer initialized with SNOWFLAKE provider\
2025-11-14 07:56:16,780 [INFO] app.service.analytics.pipeline_monitor: [] PipelineMonitor initialized with SNOWFLAKE provider\
[API_ROUTER] Analytics router imported: prefix=/analytics, routes=51\
2025-11-14 07:56:17,435 [INFO] app.router.api_router: [] Analytics router imported successfully, prefix: /analytics, routes: 51\
[API_ROUTER] \uc0\u9989  Analytics router included successfully\
2025-11-14 07:56:17,448 [INFO] app.router.api_router: [] \uc0\u9989  Analytics router included successfully with prefix: /analytics\
2025-11-14 07:56:17,519 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: [] \uc0\u9989  Migration utilities loaded - backward compatibility maintained\
2025-11-14 07:56:17,519 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: []    All original functionality preserved through new modular system\
2025-11-14 07:56:17,519 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: []    Components: Feature flags, graph selection, rollback, integration\
2025-11-14 07:56:17,519 [INFO] app.service.agent.orchestration.hybrid.observability.counters: [] \uc0\u55357 \u56522  Initialized 25 observability counters\
2025-11-14 07:56:17,520 [INFO] app.service.agent.tools.tool_registry: [] Splunk tool registered (enabled via USE_SPLUNK=true)\
2025-11-14 07:56:17,520 [INFO] app.service.agent.tools.tool_registry: [] SumoLogic tool registered (enabled via USE_SUMO_LOGIC=true)\
2025-11-14 07:56:17,520 [INFO] app.service.agent.tools.tool_registry: [] Snowflake tool registered (enabled via USE_SNOWFLAKE=true)\
2025-11-14 07:56:17,537 [INFO] app.service.agent.tools.tool_registry: [] Anomaly detection tools registered (fetch_series, detect_anomalies, list_anomalies, open_investigation, attach_evidence, segment_hunter, entity_extractor, anomaly_correlator)\
2025-11-14 07:56:17,539 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register device fingerprint tool: "DeviceFingerprintTool" object has no field "signal_processor"\
2025-11-14 07:56:17,543 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register MaxMind minFraud tool: "MaxMindMinFraudTool" object has no field "maxmind_client"\
2025-11-14 07:56:17,544 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register Composio tool: COMPOSIO_API_KEY not configured. Set environment variable or configure secret.\
2025-11-14 07:56:17,643 [INFO] app.service.graph.graph_client_abstraction: [] No graph provider configured, defaulting to Neo4j\
2025-11-14 07:56:17,643 [WARNING] app.service.graph.neo4j_client: [] Neo4j credentials not configured\
2025-11-14 07:56:17,643 [WARNING] app.service.graph.graph_client_abstraction: [] Neo4j not available, graph operations will fail gracefully\
2025-11-14 07:56:17,645 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register graph feature tool: "GraphFeatureTool" object has no field "feature_computer"\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] AbuseIPDB IP reputation tool registered\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal IP analysis tool registered\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal domain analysis tool registered\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal file analysis tool registered\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal URL analysis tool registered\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] Shodan infrastructure analysis tool registered\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] Shodan search tool registered\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] MCP servers disabled - skipping MCP server tool registration\
2025-11-14 07:56:17,645 [INFO] app.service.agent.tools.tool_registry: [] Tool registry initialized with 18 tools\
2025-11-14 07:56:17,645 [INFO] app.router.mcp_bridge_router: [] MCP bridge initialized with tools\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)\
2025-11-14 07:56:17,671 [INFO] app.test.data.mock_transactions.mock_data_loader: [] Initialized MockDataLoader with base path: /Users/gklainert/Documents/olorin/olorin-server/app/test/data/mock_transactions\
/Users/gklainert/Documents/olorin/olorin-server/app/router/autonomous_investigation_router.py:312: DeprecationWarning: `example` has been deprecated, please use `examples` instead\
  investigation_id: str = Path(description="Unique investigation identifier", example="multi_a1b2c3d4")\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1093: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn(\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)\
2025-11-14 07:56:17,990 [INFO] app.service.router.router_config: [] All core routers have been included (WebSocket disabled)\
2025-11-14 07:56:17,990 [INFO] app.service.router.router_config: [] Error handlers registered\
2025-11-14 07:56:17,990 [INFO] app.service.router.router_config: [] pskhealth not available, using enhanced health router\
2025-11-14 07:56:17,990 [INFO] app.service.router.router_config: [] App metrics exposed\
2025-11-14 07:56:17,990 [INFO] uvicorn.error: [] Started server process [68150]\
2025-11-14 07:56:17,991 [INFO] uvicorn.error: [] Waiting for application startup.\
2025-11-14 07:56:17,991 [INFO] app.service: [] \uc0\u55357 \u56960  Starting Olorin application...\
2025-11-14 07:56:17,991 [INFO] app.service: [] \uc0\u55357 \u56615  Validating log stream configuration...\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1093: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn(\
2025-11-14 07:56:18,024 [ERROR] app.config.logstream_validator: [] \uc0\u10060  LOG STREAM CONFIGURATION VALIDATION FAILED\
\
Missing or invalid environment variables:\
\
  \uc0\u10060  frontend_log_endpoint:\
     Field required\
\
  \uc0\u10060  backend_log_endpoint:\
     Field required\
\
  \uc0\u10060  provider_timeout_ms:\
     Field required\
\
\
Please set all required LOGSTREAM_* environment variables.\
See app/config/logstream_config.py for required configuration.\
2025-11-14 07:56:18,024 [ERROR] app.service: [] \uc0\u10060  Log stream configuration validation failed: \u10060  LOG STREAM CONFIGURATION VALIDATION FAILED\
\
Missing or invalid environment variables:\
\
  \uc0\u10060  frontend_log_endpoint:\
     Field required\
\
  \uc0\u10060  backend_log_endpoint:\
     Field required\
\
  \uc0\u10060  provider_timeout_ms:\
     Field required\
\
\
Please set all required LOGSTREAM_* environment variables.\
See app/config/logstream_config.py for required configuration.\
2025-11-14 07:56:18,024 [ERROR] app.service: []    Set SKIP_LOGSTREAM_VALIDATION=true to continue startup without log streaming\
2025-11-14 07:56:18,024 [INFO] app.service: [] \uc0\u55357 \u56772 \u65039  Initializing database...\
2025-11-14 07:56:18,033 [INFO] app.persistence.database: [] Database initialized with URL: sqlite:///./olorin_test.db\
2025-11-14 07:56:18,042 [INFO] app.persistence.database: [] Database tables created\
2025-11-14 07:56:18,043 [INFO] app.service: [] \uc0\u9989  Database tables creation attempted\
2025-11-14 07:56:18,043 [INFO] app.service: [] \uc0\u55357 \u56589  Verifying required tables...\
2025-11-14 07:56:18,044 [INFO] app.service: [] \uc0\u9989  All required tables verified: \{'investigation_states', 'detection_runs', 'detectors', 'anomaly_events'\}\
2025-11-14 07:56:18,044 [INFO] app.service: [] \uc0\u55357 \u56589  Verifying database indexes...\
2025-11-14 07:56:18,044 [INFO] app.service: [] \uc0\u55357 \u56589  Checking for database configuration issues...\
2025-11-14 07:56:18,044 [INFO] app.service: [] \uc0\u9989  Using SQLite for investigation state management\
2025-11-14 07:56:18,044 [INFO] app.service: []    Database path: sqlite:///./olorin_test.db\
2025-11-14 07:56:18,044 [INFO] app.service: [] \uc0\u55357 \u56580  Running database migrations...\
[2025-11-14T07:56:18-0500] INFO [] module=runner: Skipping Snowflake-specific migration 002_add_experiments_tables.sql (database type: sqlite)\
[2025-11-14T07:56:18-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T07:56:18-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 006_add_transaction_windows_view.sql (database type: sqlite)\
[2025-11-14T07:56:18-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_device_signals.sql (database type: sqlite)\
[2025-11-14T07:56:18-0500] INFO [] module=runner: Skipping Snowflake-specific migration 008_create_dynamic_tables.sql (database type: sqlite)\
[2025-11-14T07:56:18-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T07:56:18-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_graph_features.sql (database type: sqlite)\
[2025-11-14T07:56:18-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_ip_risk_scores.sql (database type: sqlite)\
[2025-11-14T07:56:18-0500] INFO [] module=runner: Skipping Snowflake-specific migration 008_create_snowpipe_tables.sql (database type: sqlite)\
[2025-11-14T07:56:18-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T07:56:18-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 009_create_device_features_view.sql (database type: sqlite)\
2025-11-14 07:56:18,056 [INFO] app.service: [] \uc0\u9989  Database migrations completed successfully\
2025-11-14 07:56:18,056 [INFO] app.service: [] \uc0\u55357 \u56588  Initializing database provider...\
2025-11-14 07:56:18,056 [INFO] app.service: [] \uc0\u9989  Database provider initialized: SnowflakeProvider\
2025-11-14 07:56:18,056 [INFO] app.service: [] \uc0\u9989  Database connection established: SnowflakeProvider\
2025-11-14 07:56:18,056 [INFO] app.service: [] \uc0\u55357 \u56589  Validating database schema parity...\
2025-11-14 07:56:18,056 [INFO] app.service: [] \uc0\u8505 \u65039  Schema validation skipped (using Snowflake as source of truth)\
2025-11-14 07:56:18,056 [INFO] app.service.performance.performance_manager: [] Starting Olorin application with performance optimizations...\
2025-11-14 07:56:18,066 [INFO] app.service.performance.performance_manager: [] \uc0\u10003  Performance optimization system initialized successfully\
2025-11-14 07:56:18,066 [INFO] app.service.performance.performance_manager: [] Performance targets:\
2025-11-14 07:56:18,066 [INFO] app.service.performance.performance_manager: []   - api_latency: -40% improvement target\
2025-11-14 07:56:18,066 [INFO] app.service.performance.performance_manager: []   - agent_execution: -50% improvement target\
2025-11-14 07:56:18,066 [INFO] app.service.performance.performance_manager: []   - cache_hit_rate: +200% improvement target\
2025-11-14 07:56:18,066 [INFO] app.service.performance.performance_manager: []   - memory_usage: -25% improvement target\
2025-11-14 07:56:18,066 [INFO] app.service.performance.performance_manager: []   - throughput: +100% improvement target\
2025-11-14 07:56:18,066 [INFO] app.service: [] \uc0\u55358 \u56598  Initializing agent system...\
2025-11-14 07:56:18,071 [INFO] app.service.agent.agent_factory: [] RAG modules loaded successfully\
2025-11-14 07:56:18,079 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'utility'], tool_names: None\
2025-11-14 07:56:18,079 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 07:56:18,079 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 07:56:18,079 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'utility'], specific: None)\
2025-11-14 07:56:18,079 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 07:56:18,079 [INFO] app.service.agent.agent: [] Initialized 18 tools for structured agents (including 5 threat intelligence tools, 3 database tools)\
2025-11-14 07:56:18,080 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 07:56:18,080 [INFO] app.service.agent.recursion_guard: [] Initialized global RecursionGuard\
2025-11-14 07:56:18,080 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 07:56:18,104 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 07:56:18,104 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 07:56:18,104 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 07:56:18,104 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 07:56:18,104 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 07:56:18,104 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 07:56:18,104 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 07:56:18,104 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 07:56:18,105 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 07:56:18,105 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 07:56:18,107 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 07:56:18,119 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 07:56:18,119 [INFO] app.service.agent_init: [] \uc0\u9989  Parallel graph initialized\
2025-11-14 07:56:18,119 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=False, enhanced_tools=True, subgraphs=False\
2025-11-14 07:56:18,119 [INFO] app.service.agent.orchestration.graph_builder: [] Creating sequential graph with controlled agent execution\
2025-11-14 07:56:18,142 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 07:56:18,142 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 07:56:18,142 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 07:56:18,142 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 07:56:18,142 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 07:56:18,142 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 07:56:18,142 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 07:56:18,142 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 07:56:18,143 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 07:56:18,143 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 07:56:18,145 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 07:56:18,148 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Sequential agent graph compiled successfully\
2025-11-14 07:56:18,148 [INFO] app.service.agent_init: [] \uc0\u9989  Sequential graph initialized\
2025-11-14 07:56:18,148 [INFO] app.service.agent_init: [] \uc0\u9989  At least one agent graph initialized\
2025-11-14 07:56:18,148 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 07:56:18,148 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 07:56:18,148 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 07:56:18,148 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager initialized\
2025-11-14 07:56:18,148 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Feature flags: 7 flags\
2025-11-14 07:56:18,148 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Components: All migration and integration components loaded\
2025-11-14 07:56:18,148 [INFO] app.service.agent_init: [] \uc0\u55358 \u56800  Hybrid Intelligence Graph system initialized\
2025-11-14 07:56:18,148 [INFO] app.service.agent_init: [] \uc0\u55357 \u57001  Feature flags status:\
2025-11-14 07:56:18,148 [INFO] app.service.agent_init: []    hybrid_graph_v1: \uc0\u9989  (100% rollout)\
2025-11-14 07:56:18,148 [INFO] app.service.agent_init: []    ai_confidence_engine: \uc0\u9989  (100% rollout)\
2025-11-14 07:56:18,148 [INFO] app.service.agent_init: []    ab_test_hybrid_vs_clean: \uc0\u10060  (0% rollout)\
2025-11-14 07:56:18,149 [INFO] app.service: [] \uc0\u9989  Agent system initialized successfully\
2025-11-14 07:56:18,149 [INFO] app.service: [] \uc0\u55357 \u56960  Initializing RAG system...\
2025-11-14 07:56:18,150 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56960  Initializing PostgreSQL + pgvector RAG system...\
2025-11-14 07:56:18,152 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56522  Initializing SQLite database for RAG...\
2025-11-14 07:56:18,153 [INFO] app.service.database.vector_database_config: [] SQLite engine initialized\
2025-11-14 07:56:18,154 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG database tables created/verified\
2025-11-14 07:56:18,154 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  SQLite vector database initialized successfully\
2025-11-14 07:56:18,154 [INFO] app.service.rag.startup_integration: [] \uc0\u55358 \u56800  Initializing embedding service...\
2025-11-14 07:56:18,167 [INFO] app.service.rag.embedding_service: [] OpenAI embedding provider initialized\
2025-11-14 07:56:18,231 [WARNING] app.service.rag.embedding_service: [] HuggingFace provider not available: dlopen(/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/_C.cpython-311-darwin.so, 0x0002): Library not loaded: @loader_path/libtorch_cpu.dylib\
  Referenced from: <93B052AD-B16C-3D0F-A6FC-DFFBB7CD9584> /Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/lib/libtorch_python.dylib\
  Reason: tried: '/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/lib/libtorch_cpu.dylib' (no such file), '/usr/local/lib/libtorch_cpu.dylib' (no such file), '/usr/lib/libtorch_cpu.dylib' (no such file, not in dyld cache)\
2025-11-14 07:56:18,231 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Embedding service initialized with providers: openai\
2025-11-14 07:56:18,231 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56538  Initializing enhanced knowledge base...\
2025-11-14 07:56:18,232 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u55357 \u56960  Initializing Enhanced Knowledge Base...\
2025-11-14 07:56:18,249 [INFO] app.service.rag.enhanced_knowledge_base: [] Found 4 empty collections - consider populating with domain knowledge\
2025-11-14 07:56:18,249 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u9989  Enhanced Knowledge Base initialized successfully\
2025-11-14 07:56:18,249 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u9989  Enhanced Knowledge Base ready for fraud investigations\
2025-11-14 07:56:18,249 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Enhanced knowledge base initialized successfully\
2025-11-14 07:56:18,249 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56589  Performing RAG system health check...\
2025-11-14 07:56:18,250 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56520  RAG health check: 5 collections available\
2025-11-14 07:56:18,251 [WARNING] app.service.rag.startup_integration: [] Failed to create default data source: Instance <RAGDataSource at 0x1500d63d0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)\
2025-11-14 07:56:18,251 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56522  RAG system status: \{'database': True, 'embeddings': True, 'knowledge_base': True, 'overall': True\}\
2025-11-14 07:56:18,251 [INFO] app.service.rag.investigation_indexing_background: [] Started investigation indexing background service (poll interval: 60s)\
2025-11-14 07:56:18,251 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Background investigation indexing started\
2025-11-14 07:56:18,251 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG system initialization completed successfully\
2025-11-14 07:56:18,251 [INFO] app.service: [] \uc0\u9989  RAG system initialized successfully\
2025-11-14 07:56:18,251 [INFO] app.service: [] \uc0\u55357 \u56580  Scheduling background task to load top risk entities from Snowflake...\
2025-11-14 07:56:18,251 [INFO] app.service: [] \uc0\u9989  Background task scheduled - server will start without waiting for risk entities\
2025-11-14 07:56:18,251 [INFO] app.service: [] \uc0\u55357 \u56589  Validating anomaly detection configuration...\
2025-11-14 07:56:18,286 [INFO] app.service: [] \uc0\u9989  Anomaly detection configuration validated successfully\
2025-11-14 07:56:18,286 [INFO] app.service: [] \uc0\u9200  Initializing detection scheduler...\
2025-11-14 07:56:18,319 [INFO] app.service.anomaly.scheduler: [] Detection scheduler initialized: enabled=True, default_interval=15 minutes\
2025-11-14 07:56:18,330 [INFO] app.service.anomaly.scheduler_jobs: [] Registered 12 detector jobs\
2025-11-14 07:56:18,330 [INFO] app.service.anomaly.scheduler: [] Detection scheduler started successfully\
2025-11-14 07:56:18,330 [INFO] app.service: [] \uc0\u9989  Detection scheduler started\
2025-11-14 07:56:18,330 [INFO] app.service: [] Olorin application startup completed\
2025-11-14 07:56:18,337 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 07:56:18,337 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 07:56:18,762 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 07:56:18,830 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 07:56:18,830 [INFO] app.service: [] \uc0\u55357 \u56523  Loading top risk entities from Snowflake (background task)...\
2025-11-14 07:56:18,830 [INFO] app.service: [] \uc0\u55357 \u56550  Importing risk analyzer...\
2025-11-14 07:56:18,830 [INFO] app.service: [] \uc0\u55356 \u57325  Creating risk analyzer instance...\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] RiskAnalyzer initialized with SNOWFLAKE provider\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] Risk Analyzer configured: time_window=7d, group_by=email, top=10.0%\
2025-11-14 07:56:18,830 [INFO] app.service: [] \uc0\u55357 \u56588  Attempting to connect to Snowflake and fetch top risk entities...\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56580  Starting risk analysis with params: time_window=7d, group_by=email, top_percentage=10.0\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9201 \u65039  Parsing time window: 7d\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9201 \u65039  Parsed to 168 hours\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56588  Connecting to SNOWFLAKE database...\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9989  SNOWFLAKE connection initialized (lazy connection)\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55356 \u57303 \u65039  Building risk query for email filtering...\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56589  Executing SNOWFLAKE query for email filtering:\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] Query: \
        WITH risk_calculations AS (\
            SELECT\
                EMAIL as entity,\
                COUNT(*) as transaction_count,\
                SUM(PAID_AMOUNT_VALUE_IN_CURRENCY) as total_amount,\
                AVG(MODEL_SCORE) as avg_risk_score,\
                SUM(MODEL_SCORE * PAID_AMOUNT_VALUE_IN_CURRENCY) * COUNT(*) as risk_weighted_value,\
                MAX(MODEL_SCORE) as max_risk_score,\
                MIN(MODEL_SCORE) as min_risk_score,\
                SUM(CASE WHEN IS_FRAUD_T...\
2025-11-14 07:56:18,830 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9889  Sending query to SNOWFLAKE...\
2025-11-14 07:56:18,830 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: WITH risk_calculations AS (\
            SELECT\
                EMAIL as entity,\
                COUNT(*) as transaction_count,\
                SUM(PAID_AMOUNT_VALUE_IN_CURRENCY) as total_amount,\
     ...\
2025-11-14 07:56:19,091 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 07:56:19,150 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T07:56:19-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T07:56:19-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 07:56:21,933 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 07:56:27,404 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 61780 rows\
2025-11-14 07:56:27,404 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 61780 rows returned\
2025-11-14 07:56:27,404 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56522  Query returned 61780 rows\
2025-11-14 07:56:27,547 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9989  Risk analysis completed: 61780 entities identified (from 61780 query rows)\
2025-11-14 07:56:27,547 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56522  Top 3 riskiest entities:\
2025-11-14 07:56:27,547 [INFO] app.service.analytics.risk_analyzer: []    1. Entity: meiling.soto.garrido@gmail.com | Transactions: 9 | Risk Score: 0.746\
2025-11-14 07:56:27,547 [INFO] app.service.analytics.risk_analyzer: []    2. Entity: moeller2media@gmail.com | Transactions: 20 | Risk Score: 0.393\
2025-11-14 07:56:27,547 [INFO] app.service.analytics.risk_analyzer: []    3. Entity: okuoku1959122@gmail.com | Transactions: 7 | Risk Score: 0.464\
2025-11-14 07:56:27,547 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 07:56:27,555 [INFO] app.service: [] \uc0\u55357 \u56522  Risk analyzer returned results: <class 'dict'> with keys: ['status', 'entities', 'summary', 'timestamp']\
2025-11-14 07:56:27,555 [INFO] app.service: [] \uc0\u9989  Successfully loaded 61780 top risk entities from Snowflake\
2025-11-14 07:56:27,555 [INFO] app.service: [] \uc0\u55357 \u56510  Stored risk entities in app state\
2025-11-14 07:56:27,555 [INFO] app.service: [] \uc0\u55357 \u56960  Starting automatic comparisons for top 3 riskiest entities...\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Starting auto-comparisons for top 3 riskiest entities\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: []    Entity type (from group_by): email\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Auto-Comparison 1/3\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: []    Entity: meiling.soto.garrido@gmail.com\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: []    Entity Type: email\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: []    Risk Score: 0.746\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: []    Transactions: 9\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Running auto-comparison for entity: email=meiling.soto.garrido@gmail.com\
2025-11-14 07:56:27,561 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Looking for historical investigations between 2025-05-18 and 2025-08-16\
2025-11-14 07:56:27,938 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Found historical investigation: auto-comp-1ba6606d6091\
2025-11-14 07:56:27,938 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Prediction Validation Setup:\
2025-11-14 07:56:27,938 [INFO] app.service.investigation.auto_comparison: []    Window A (Historical Investigation): 2025-08-02 to 2025-08-16\
2025-11-14 07:56:27,938 [INFO] app.service.investigation.auto_comparison: []    Window B (Validation Period): 2025-08-16 to 2025-11-14\
2025-11-14 07:56:27,938 [INFO] app.service.investigation.auto_comparison: []    Predicted Risk: None\
2025-11-14 07:56:27,939 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-02T08:51:02.699363-04:00' AND TX_DATETIME < '2025-08-16T08:51:02.699363-04:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido...\
2025-11-14 07:56:28,096 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 07:56:28,096 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 07:56:28,096 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-16T08:51:02.699363-04:00' AND TX_DATETIME < '2025-11-14T08:51:02.699363-04:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido...\
2025-11-14 07:56:28,246 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 07:56:28,246 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 07:56:28,246 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email:meiling.soto.garrido@gmail.com in comparison windows. Window A: 0 transactions, Window B: 0 transactions. Skipping comparison - entity may not have sufficient historical data.\
2025-11-14 07:56:28,247 [INFO] uvicorn.error: [] Application startup complete.\
2025-11-14 07:56:29,247 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 07:56:29,248 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Auto-Comparison 2/3\
2025-11-14 07:56:29,248 [INFO] app.service.investigation.auto_comparison: []    Entity: moeller2media@gmail.com\
2025-11-14 07:56:29,248 [INFO] app.service.investigation.auto_comparison: []    Entity Type: email\
2025-11-14 07:56:29,248 [INFO] app.service.investigation.auto_comparison: []    Risk Score: 0.393\
2025-11-14 07:56:29,248 [INFO] app.service.investigation.auto_comparison: []    Transactions: 20\
2025-11-14 07:56:29,248 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 07:56:29,248 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Running auto-comparison for entity: email=moeller2media@gmail.com\
2025-11-14 07:56:29,248 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Looking for historical investigations between 2025-05-18 and 2025-08-16\
2025-11-14 07:56:29,627 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Found historical investigation: auto-comp-114a527271a9\
2025-11-14 07:56:29,627 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Prediction Validation Setup:\
2025-11-14 07:56:29,627 [INFO] app.service.investigation.auto_comparison: []    Window A (Historical Investigation): 2025-08-02 to 2025-08-16\
2025-11-14 07:56:29,627 [INFO] app.service.investigation.auto_comparison: []    Window B (Validation Period): 2025-08-16 to 2025-11-14\
2025-11-14 07:56:29,627 [INFO] app.service.investigation.auto_comparison: []    Predicted Risk: None\
2025-11-14 07:56:29,628 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-02T08:53:23.790063-04:00' AND TX_DATETIME < '2025-08-16T08:53:23.790063-04:00' AND EMAIL_NORMALIZED = 'moeller2media@gmail....\
2025-11-14 07:56:30,426 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 07:56:30,427 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 07:56:30,427 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-16T08:53:23.790063-04:00' AND TX_DATETIME < '2025-11-14T08:53:23.790063-04:00' AND EMAIL_NORMALIZED = 'moeller2media@gmail....\
2025-11-14 07:56:33,613 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 07:56:33,613 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 07:56:33,613 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email:moeller2media@gmail.com in comparison windows. Window A: 0 transactions, Window B: 0 transactions. Skipping comparison - entity may not have sufficient historical data.\
2025-11-14 07:56:34,614 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 07:56:34,614 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Auto-Comparison 3/3\
2025-11-14 07:56:34,614 [INFO] app.service.investigation.auto_comparison: []    Entity: okuoku1959122@gmail.com\
2025-11-14 07:56:34,614 [INFO] app.service.investigation.auto_comparison: []    Entity Type: email\
2025-11-14 07:56:34,614 [INFO] app.service.investigation.auto_comparison: []    Risk Score: 0.464\
2025-11-14 07:56:34,614 [INFO] app.service.investigation.auto_comparison: []    Transactions: 7\
2025-11-14 07:56:34,614 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 07:56:34,614 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Running auto-comparison for entity: email=okuoku1959122@gmail.com\
2025-11-14 07:56:34,615 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Looking for historical investigations between 2025-05-18 and 2025-08-16\
2025-11-14 07:56:35,078 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Found historical investigation: inv-1762911549893-xk0267ez\
2025-11-14 07:56:35,078 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Prediction Validation Setup:\
2025-11-14 07:56:35,078 [INFO] app.service.investigation.auto_comparison: []    Window A (Historical Investigation): 2025-05-14 to 2025-11-10\
2025-11-14 07:56:35,078 [INFO] app.service.investigation.auto_comparison: []    Window B (Validation Period): 2025-11-10 to 2025-11-14\
2025-11-14 07:56:35,078 [INFO] app.service.investigation.auto_comparison: []    Predicted Risk: None\
2025-11-14 07:56:35,078 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-05-14T22:40:00.434000-04:00' AND TX_DATETIME < '2025-11-10T21:40:00.434000-05:00' AND EMAIL_NORMALIZED = 'okuoku1959122@gmail....\
2025-11-14 07:56:40,623 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 07:56:40,624 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 07:56:40,624 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-11-10T21:40:00.434000-05:00' AND TX_DATETIME < '2025-11-14T07:56:34.615031-05:00' AND EMAIL_NORMALIZED = 'okuoku1959122@gmail....\
2025-11-14 07:56:41,011 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 07:56:41,011 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 07:56:41,011 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email:okuoku1959122@gmail.com in comparison windows. Window A: 0 transactions, Window B: 0 transactions. Skipping comparison - entity may not have sufficient historical data.\
2025-11-14 07:56:41,018 [INFO] uvicorn.access: [] 127.0.0.1:54515 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 07:56:41,025 [INFO] app.service.etag_service: [olorin_tid=7a9a5f97-928b-4241-9bd0-2fe52b69ddd8, investigation_id=2f94a99c-ce81-421b-bcf1-fd34413fcf83] etag_retrieved\
2025-11-14 07:56:41,026 [INFO] uvicorn.access: [] 127.0.0.1:54515 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 07:56:42,012 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 07:56:42,012 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Auto-comparison summary:\
2025-11-14 07:56:42,012 [INFO] app.service.investigation.auto_comparison: []    Total: 3\
2025-11-14 07:56:42,012 [INFO] app.service.investigation.auto_comparison: []    Successful: 0\
2025-11-14 07:56:42,012 [INFO] app.service.investigation.auto_comparison: []    Failed: 3\
2025-11-14 07:56:42,012 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 07:56:42,012 [INFO] app.service: [] \uc0\u9989  Auto-comparisons completed: 3 reports generated\
2025-11-14 07:57:18,836 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 07:57:18,836 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 07:57:19,018 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 07:57:19,089 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 07:57:34,732 [INFO] uvicorn.access: [] 127.0.0.1:54775 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 07:57:34,748 [INFO] app.service.etag_service: [investigation_id=52afbbd1-e9ec-427d-bfd0-0c80f7b42e15, olorin_tid=f750c6b9-0294-4554-8764-9708cfd438cc] etag_retrieved\
2025-11-14 07:57:34,752 [INFO] uvicorn.access: [] 127.0.0.1:54775 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 07:58:19,093 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 07:58:19,093 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 07:58:19,294 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 07:58:19,364 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 07:58:34,754 [INFO] uvicorn.access: [] 127.0.0.1:55054 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 07:58:34,776 [INFO] app.service.etag_service: [olorin_tid=1f5b6771-f20b-4fba-a75a-d99960614693, investigation_id=c51d4691-714f-4652-9cd7-273b72182bdc] etag_retrieved\
2025-11-14 07:58:34,784 [INFO] uvicorn.access: [] 127.0.0.1:55054 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 07:59:19,369 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 07:59:19,369 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 07:59:19,557 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 07:59:19,620 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 07:59:34,741 [INFO] uvicorn.access: [] 127.0.0.1:55342 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 07:59:34,763 [INFO] app.service.etag_service: [investigation_id=420d5d4e-934d-4a99-9fa1-0c1af2505688, olorin_tid=fd123193-b097-4490-9a0a-6b7c3146ac3a] etag_retrieved\
2025-11-14 07:59:34,766 [INFO] uvicorn.access: [] 127.0.0.1:55342 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:00:19,625 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:00:19,625 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:00:19,818 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:00:19,881 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:00:34,760 [INFO] uvicorn.access: [] 127.0.0.1:55607 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:00:34,775 [INFO] app.service.etag_service: [olorin_tid=6828434d-261e-45e6-bd06-97871fc65188, investigation_id=21b398d4-b2a4-4bd3-a556-3a117ed5ed08] etag_retrieved\
2025-11-14 08:00:34,781 [INFO] uvicorn.access: [] 127.0.0.1:55607 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:01:19,884 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:01:19,885 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:01:20,074 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:01:20,142 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:01:34,744 [INFO] uvicorn.access: [] 127.0.0.1:55914 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:01:34,772 [INFO] app.service.etag_service: [olorin_tid=87056cf9-01f7-4d4a-86ee-7deffcd542b4, investigation_id=93335db6-3fb1-4e9b-9bd9-ec961f11f30e] etag_retrieved\
2025-11-14 08:01:34,775 [INFO] uvicorn.access: [] 127.0.0.1:55914 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:02:20,129 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:02:20,129 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:02:20,432 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:02:20,504 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:02:34,711 [INFO] uvicorn.access: [] 127.0.0.1:56188 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:02:34,719 [INFO] app.service.etag_service: [olorin_tid=cc0aaf7e-6191-448c-a575-785fa69a18b9, investigation_id=0b14c55e-f94c-4b4a-bcdf-8905c9bf61fb] etag_retrieved\
2025-11-14 08:02:34,723 [INFO] uvicorn.access: [] 127.0.0.1:56188 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:03:20,513 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:03:20,513 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:03:20,817 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:03:20,884 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:03:34,725 [INFO] uvicorn.access: [] 127.0.0.1:56486 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:03:34,804 [INFO] app.service.etag_service: [investigation_id=b541a13e-2132-4a7f-9b3a-6be32b34776c, olorin_tid=526215db-2238-4ec4-8f50-56958f12ba51] etag_retrieved\
2025-11-14 08:03:34,810 [INFO] uvicorn.access: [] 127.0.0.1:56486 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:04:20,886 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:04:20,886 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:04:21,067 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:04:21,130 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:04:34,716 [INFO] uvicorn.access: [] 127.0.0.1:56764 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:04:34,734 [INFO] app.service.etag_service: [investigation_id=80501e44-18fd-464d-9703-ae3e38e98f93, olorin_tid=9bb8eef2-25af-4e4d-9ac8-be005d0fe0d9] etag_retrieved\
2025-11-14 08:04:34,737 [INFO] uvicorn.access: [] 127.0.0.1:56764 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:05:21,132 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:05:21,132 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:05:21,338 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:05:21,403 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:05:34,723 [INFO] uvicorn.access: [] 127.0.0.1:57026 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:05:34,734 [INFO] app.service.etag_service: [olorin_tid=1d833727-c8ce-4aa0-85b8-a24825fa9b85, investigation_id=7a5af081-83a5-49d9-9188-89f647f2379f] etag_retrieved\
2025-11-14 08:05:34,739 [INFO] uvicorn.access: [] 127.0.0.1:57026 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:06:21,410 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:06:21,411 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:06:21,623 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:06:21,689 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:06:34,809 [INFO] uvicorn.access: [] 127.0.0.1:57294 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:06:34,831 [INFO] app.service.etag_service: [olorin_tid=d7d98459-026c-4b02-8578-95ba2f86391b, investigation_id=7b33d5ab-eca1-4ba6-9c4c-d5b33a341252] etag_retrieved\
2025-11-14 08:06:34,834 [INFO] uvicorn.access: [] 127.0.0.1:57296 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
StatReload detected changes in 'app/service/investigation/auto_comparison.py'. Reloading...\
2025-11-14 08:07:05,299 [INFO] uvicorn.error: [] Shutting down\
2025-11-14 08:07:05,401 [INFO] uvicorn.error: [] Waiting for application shutdown.\
2025-11-14 08:07:05,404 [INFO] app.service: [] Shutting down Olorin application...\
2025-11-14 08:07:05,405 [INFO] app.service: [] \uc0\u55357 \u56588  Disconnecting database provider...\
2025-11-14 08:07:05,405 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:07:05,405 [INFO] app.service: [] \uc0\u9989  Database provider disconnected\
2025-11-14 08:07:05,405 [INFO] app.service: [] \uc0\u9989  Async client cleanup completed\
2025-11-14 08:07:05,405 [INFO] app.service.rag.startup_integration: [] \uc0\u55358 \u56825  Cleaning up RAG system...\
2025-11-14 08:07:05,406 [INFO] app.service.rag.investigation_indexing_background: [] Stopped investigation indexing background service\
2025-11-14 08:07:05,411 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG system cleanup completed\
2025-11-14 08:07:05,412 [INFO] app.service: [] \uc0\u9989  RAG system cleanup completed\
2025-11-14 08:07:05,412 [INFO] app.service: [] \uc0\u9200  Stopping detection scheduler...\
2025-11-14 08:07:05,412 [INFO] app.service.anomaly.scheduler: [] Stopping detection scheduler...\
2025-11-14 08:07:05,412 [INFO] app.service.anomaly.scheduler: [] Detection scheduler stopped\
2025-11-14 08:07:05,412 [INFO] app.service: [] \uc0\u9989  Detection scheduler stopped\
2025-11-14 08:07:05,412 [INFO] app.service.performance.performance_manager: [] Shutting down performance optimization system...\
2025-11-14 08:07:05,413 [INFO] app.service.agent.tools.enhanced_cache.cache: [] Cache cleared\
2025-11-14 08:07:05,414 [INFO] app.service.performance.performance_manager: [] Performance optimization system shutdown completed\
2025-11-14 08:07:05,414 [INFO] app.service: [] Olorin application shutdown completed\
2025-11-14 08:07:05,414 [INFO] uvicorn.error: [] Application shutdown complete.\
2025-11-14 08:07:05,414 [INFO] uvicorn.error: [] Finished server process [68150]\
2025-11-14 08:07:06 \cf5 [INFO]\cf4  app.service.middleware.middleware_config: CORS configured for local environment with 16 allowed origins\
2025-11-14 08:07:06,345 [INFO] app.service.middleware.middleware_config: [] Investigation ID middleware configured for log stream correlation\
2025-11-14 08:07:06,346 [INFO] app.service.middleware.middleware_config: [] Rate limiting configured for local: 500 requests per 60 seconds\
2025-11-14 08:07:06,346 [INFO] app.middleware.logstream_rate_limiter: [] Log stream rate limiting configured for local: streaming=30 req/60s, ingestion=20 req/60s\
2025-11-14 08:07:06,560 [INFO] app.service.config_loader: [] Loaded .env configuration from /Users/gklainert/Documents/olorin/olorin-server/.env\
2025-11-14 08:07:06,560 [INFO] app.service.config_loader: [] Firebase Secret Manager disabled - using .env only\
2025-11-14 08:07:06,560 [INFO] app.service.config_loader: [] ConfigLoader initialized for environment: local\
2025-11-14 08:07:06,560 [INFO] app.security.auth: [] JWT secret loaded from Firebase Secrets Manager\
2025-11-14 08:07:06,563 [INFO] app.service.middleware.middleware_config: [] Production error middleware configured for environment: local\
2025-11-14 08:07:06,998 [INFO] app.service.agent.journey_tracker: [] Initialized LangGraphJourneyTracker with output: logs/journey_tracking\
2025-11-14 08:07:06,999 [INFO] app.service.agent.chain_of_thought_logger: [] Initialized ChainOfThoughtLogger with directory: logs/chain_of_thought\
\uc0\u9989  Loaded .env file with 13 enabled tools\
\uc0\u9989  Schema constants loaded: 333 columns validated for DBT.DBT_PROD.TXS (SNOWFLAKE)\
2025-11-14 08:07:07,202 [INFO] app.service.agent.tools.snowflake_tool.client: [] Using REAL Snowflake client (USE_SNOWFLAKE=true)\
[API_ROUTER] Attempting to import analytics router...\
2025-11-14 08:07:10,332 [INFO] app.router.api_router: [] Attempting to import analytics router...\
2025-11-14 08:07:10,335 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.cohort_analyzer: [] CohortAnalyzer initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.experiment_manager: [] ExperimentManager initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.drift_detector: [] DriftDetector initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.replay_engine: [] ReplayEngine initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.explainer: [] Explainer initialized with SNOWFLAKE provider\
2025-11-14 08:07:10,335 [INFO] app.service.analytics.pipeline_monitor: [] PipelineMonitor initialized with SNOWFLAKE provider\
[API_ROUTER] Analytics router imported: prefix=/analytics, routes=51\
2025-11-14 08:07:10,933 [INFO] app.router.api_router: [] Analytics router imported successfully, prefix: /analytics, routes: 51\
[API_ROUTER] \uc0\u9989  Analytics router included successfully\
2025-11-14 08:07:10,946 [INFO] app.router.api_router: [] \uc0\u9989  Analytics router included successfully with prefix: /analytics\
2025-11-14 08:07:11,018 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: [] \uc0\u9989  Migration utilities loaded - backward compatibility maintained\
2025-11-14 08:07:11,019 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: []    All original functionality preserved through new modular system\
2025-11-14 08:07:11,019 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: []    Components: Feature flags, graph selection, rollback, integration\
2025-11-14 08:07:11,019 [INFO] app.service.agent.orchestration.hybrid.observability.counters: [] \uc0\u55357 \u56522  Initialized 25 observability counters\
2025-11-14 08:07:11,019 [INFO] app.service.agent.tools.tool_registry: [] Splunk tool registered (enabled via USE_SPLUNK=true)\
2025-11-14 08:07:11,019 [INFO] app.service.agent.tools.tool_registry: [] SumoLogic tool registered (enabled via USE_SUMO_LOGIC=true)\
2025-11-14 08:07:11,019 [INFO] app.service.agent.tools.tool_registry: [] Snowflake tool registered (enabled via USE_SNOWFLAKE=true)\
2025-11-14 08:07:11,037 [INFO] app.service.agent.tools.tool_registry: [] Anomaly detection tools registered (fetch_series, detect_anomalies, list_anomalies, open_investigation, attach_evidence, segment_hunter, entity_extractor, anomaly_correlator)\
2025-11-14 08:07:11,039 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register device fingerprint tool: "DeviceFingerprintTool" object has no field "signal_processor"\
2025-11-14 08:07:11,043 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register MaxMind minFraud tool: "MaxMindMinFraudTool" object has no field "maxmind_client"\
2025-11-14 08:07:11,044 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register Composio tool: COMPOSIO_API_KEY not configured. Set environment variable or configure secret.\
2025-11-14 08:07:11,149 [INFO] app.service.graph.graph_client_abstraction: [] No graph provider configured, defaulting to Neo4j\
2025-11-14 08:07:11,149 [WARNING] app.service.graph.neo4j_client: [] Neo4j credentials not configured\
2025-11-14 08:07:11,149 [WARNING] app.service.graph.graph_client_abstraction: [] Neo4j not available, graph operations will fail gracefully\
2025-11-14 08:07:11,151 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register graph feature tool: "GraphFeatureTool" object has no field "feature_computer"\
2025-11-14 08:07:11,151 [INFO] app.service.agent.tools.tool_registry: [] AbuseIPDB IP reputation tool registered\
2025-11-14 08:07:11,151 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal IP analysis tool registered\
2025-11-14 08:07:11,151 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal domain analysis tool registered\
2025-11-14 08:07:11,151 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal file analysis tool registered\
2025-11-14 08:07:11,151 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal URL analysis tool registered\
2025-11-14 08:07:11,159 [INFO] app.service.agent.tools.tool_registry: [] Shodan infrastructure analysis tool registered\
2025-11-14 08:07:11,159 [INFO] app.service.agent.tools.tool_registry: [] Shodan search tool registered\
2025-11-14 08:07:11,159 [INFO] app.service.agent.tools.tool_registry: [] MCP servers disabled - skipping MCP server tool registration\
2025-11-14 08:07:11,159 [INFO] app.service.agent.tools.tool_registry: [] Tool registry initialized with 18 tools\
2025-11-14 08:07:11,159 [INFO] app.router.mcp_bridge_router: [] MCP bridge initialized with tools\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)\
2025-11-14 08:07:11,190 [INFO] app.test.data.mock_transactions.mock_data_loader: [] Initialized MockDataLoader with base path: /Users/gklainert/Documents/olorin/olorin-server/app/test/data/mock_transactions\
/Users/gklainert/Documents/olorin/olorin-server/app/router/autonomous_investigation_router.py:312: DeprecationWarning: `example` has been deprecated, please use `examples` instead\
  investigation_id: str = Path(description="Unique investigation identifier", example="multi_a1b2c3d4")\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1093: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn(\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)\
2025-11-14 08:07:11,556 [INFO] app.service.router.router_config: [] All core routers have been included (WebSocket disabled)\
2025-11-14 08:07:11,556 [INFO] app.service.router.router_config: [] Error handlers registered\
2025-11-14 08:07:11,556 [INFO] app.service.router.router_config: [] pskhealth not available, using enhanced health router\
2025-11-14 08:07:11,556 [INFO] app.service.router.router_config: [] App metrics exposed\
2025-11-14 08:07:11,557 [INFO] uvicorn.error: [] Started server process [84854]\
2025-11-14 08:07:11,557 [INFO] uvicorn.error: [] Waiting for application startup.\
2025-11-14 08:07:11,557 [INFO] app.service: [] \uc0\u55357 \u56960  Starting Olorin application...\
2025-11-14 08:07:11,557 [INFO] app.service: [] \uc0\u55357 \u56615  Validating log stream configuration...\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1093: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn(\
2025-11-14 08:07:11,592 [ERROR] app.config.logstream_validator: [] \uc0\u10060  LOG STREAM CONFIGURATION VALIDATION FAILED\
\
Missing or invalid environment variables:\
\
  \uc0\u10060  frontend_log_endpoint:\
     Field required\
\
  \uc0\u10060  backend_log_endpoint:\
     Field required\
\
  \uc0\u10060  provider_timeout_ms:\
     Field required\
\
\
Please set all required LOGSTREAM_* environment variables.\
See app/config/logstream_config.py for required configuration.\
2025-11-14 08:07:11,592 [ERROR] app.service: [] \uc0\u10060  Log stream configuration validation failed: \u10060  LOG STREAM CONFIGURATION VALIDATION FAILED\
\
Missing or invalid environment variables:\
\
  \uc0\u10060  frontend_log_endpoint:\
     Field required\
\
  \uc0\u10060  backend_log_endpoint:\
     Field required\
\
  \uc0\u10060  provider_timeout_ms:\
     Field required\
\
\
Please set all required LOGSTREAM_* environment variables.\
See app/config/logstream_config.py for required configuration.\
2025-11-14 08:07:11,592 [ERROR] app.service: []    Set SKIP_LOGSTREAM_VALIDATION=true to continue startup without log streaming\
2025-11-14 08:07:11,592 [INFO] app.service: [] \uc0\u55357 \u56772 \u65039  Initializing database...\
2025-11-14 08:07:11,601 [INFO] app.persistence.database: [] Database initialized with URL: sqlite:///./olorin_test.db\
2025-11-14 08:07:11,607 [INFO] app.persistence.database: [] Database tables created\
2025-11-14 08:07:11,607 [INFO] app.service: [] \uc0\u9989  Database tables creation attempted\
2025-11-14 08:07:11,607 [INFO] app.service: [] \uc0\u55357 \u56589  Verifying required tables...\
2025-11-14 08:07:11,608 [INFO] app.service: [] \uc0\u9989  All required tables verified: \{'anomaly_events', 'investigation_states', 'detection_runs', 'detectors'\}\
2025-11-14 08:07:11,608 [INFO] app.service: [] \uc0\u55357 \u56589  Verifying database indexes...\
2025-11-14 08:07:11,609 [INFO] app.service: [] \uc0\u55357 \u56589  Checking for database configuration issues...\
2025-11-14 08:07:11,609 [INFO] app.service: [] \uc0\u9989  Using SQLite for investigation state management\
2025-11-14 08:07:11,609 [INFO] app.service: []    Database path: sqlite:///./olorin_test.db\
2025-11-14 08:07:11,609 [INFO] app.service: [] \uc0\u55357 \u56580  Running database migrations...\
[2025-11-14T08:07:11-0500] INFO [] module=runner: Skipping Snowflake-specific migration 002_add_experiments_tables.sql (database type: sqlite)\
[2025-11-14T08:07:11-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:07:11-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 006_add_transaction_windows_view.sql (database type: sqlite)\
[2025-11-14T08:07:11-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_device_signals.sql (database type: sqlite)\
[2025-11-14T08:07:11-0500] INFO [] module=runner: Skipping Snowflake-specific migration 008_create_dynamic_tables.sql (database type: sqlite)\
[2025-11-14T08:07:11-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:07:11-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_graph_features.sql (database type: sqlite)\
[2025-11-14T08:07:11-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_ip_risk_scores.sql (database type: sqlite)\
[2025-11-14T08:07:11-0500] INFO [] module=runner: Skipping Snowflake-specific migration 008_create_snowpipe_tables.sql (database type: sqlite)\
[2025-11-14T08:07:11-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:07:11-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 009_create_device_features_view.sql (database type: sqlite)\
2025-11-14 08:07:11,623 [INFO] app.service: [] \uc0\u9989  Database migrations completed successfully\
2025-11-14 08:07:11,623 [INFO] app.service: [] \uc0\u55357 \u56588  Initializing database provider...\
2025-11-14 08:07:11,623 [INFO] app.service: [] \uc0\u9989  Database provider initialized: SnowflakeProvider\
2025-11-14 08:07:11,623 [INFO] app.service: [] \uc0\u9989  Database connection established: SnowflakeProvider\
2025-11-14 08:07:11,623 [INFO] app.service: [] \uc0\u55357 \u56589  Validating database schema parity...\
2025-11-14 08:07:11,623 [INFO] app.service: [] \uc0\u8505 \u65039  Schema validation skipped (using Snowflake as source of truth)\
2025-11-14 08:07:11,623 [INFO] app.service.performance.performance_manager: [] Starting Olorin application with performance optimizations...\
2025-11-14 08:07:11,633 [INFO] app.service.performance.performance_manager: [] \uc0\u10003  Performance optimization system initialized successfully\
2025-11-14 08:07:11,633 [INFO] app.service.performance.performance_manager: [] Performance targets:\
2025-11-14 08:07:11,633 [INFO] app.service.performance.performance_manager: []   - api_latency: -40% improvement target\
2025-11-14 08:07:11,633 [INFO] app.service.performance.performance_manager: []   - agent_execution: -50% improvement target\
2025-11-14 08:07:11,633 [INFO] app.service.performance.performance_manager: []   - cache_hit_rate: +200% improvement target\
2025-11-14 08:07:11,633 [INFO] app.service.performance.performance_manager: []   - memory_usage: -25% improvement target\
2025-11-14 08:07:11,633 [INFO] app.service.performance.performance_manager: []   - throughput: +100% improvement target\
2025-11-14 08:07:11,633 [INFO] app.service: [] \uc0\u55358 \u56598  Initializing agent system...\
2025-11-14 08:07:11,638 [INFO] app.service.agent.agent_factory: [] RAG modules loaded successfully\
2025-11-14 08:07:11,647 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'utility'], tool_names: None\
2025-11-14 08:07:11,647 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:07:11,647 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:07:11,647 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'utility'], specific: None)\
2025-11-14 08:07:11,647 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:07:11,647 [INFO] app.service.agent.agent: [] Initialized 18 tools for structured agents (including 5 threat intelligence tools, 3 database tools)\
2025-11-14 08:07:11,649 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 08:07:11,649 [INFO] app.service.agent.recursion_guard: [] Initialized global RecursionGuard\
2025-11-14 08:07:11,649 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 08:07:11,674 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:07:11,674 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:07:11,674 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:07:11,674 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:07:11,674 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:07:11,674 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:07:11,674 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:07:11,674 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:07:11,675 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:07:11,675 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:07:11,677 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:07:11,689 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 08:07:11,690 [INFO] app.service.agent_init: [] \uc0\u9989  Parallel graph initialized\
2025-11-14 08:07:11,690 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=False, enhanced_tools=True, subgraphs=False\
2025-11-14 08:07:11,690 [INFO] app.service.agent.orchestration.graph_builder: [] Creating sequential graph with controlled agent execution\
2025-11-14 08:07:11,714 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:07:11,714 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:07:11,714 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:07:11,714 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:07:11,714 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:07:11,714 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:07:11,714 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:07:11,714 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:07:11,715 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:07:11,715 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:07:11,717 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:07:11,720 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Sequential agent graph compiled successfully\
2025-11-14 08:07:11,720 [INFO] app.service.agent_init: [] \uc0\u9989  Sequential graph initialized\
2025-11-14 08:07:11,720 [INFO] app.service.agent_init: [] \uc0\u9989  At least one agent graph initialized\
2025-11-14 08:07:11,721 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:07:11,721 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:07:11,721 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:07:11,721 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager initialized\
2025-11-14 08:07:11,721 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Feature flags: 7 flags\
2025-11-14 08:07:11,721 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Components: All migration and integration components loaded\
2025-11-14 08:07:11,721 [INFO] app.service.agent_init: [] \uc0\u55358 \u56800  Hybrid Intelligence Graph system initialized\
2025-11-14 08:07:11,721 [INFO] app.service.agent_init: [] \uc0\u55357 \u57001  Feature flags status:\
2025-11-14 08:07:11,721 [INFO] app.service.agent_init: []    hybrid_graph_v1: \uc0\u9989  (100% rollout)\
2025-11-14 08:07:11,721 [INFO] app.service.agent_init: []    ai_confidence_engine: \uc0\u9989  (100% rollout)\
2025-11-14 08:07:11,721 [INFO] app.service.agent_init: []    ab_test_hybrid_vs_clean: \uc0\u10060  (0% rollout)\
2025-11-14 08:07:11,722 [INFO] app.service: [] \uc0\u9989  Agent system initialized successfully\
2025-11-14 08:07:11,722 [INFO] app.service: [] \uc0\u55357 \u56960  Initializing RAG system...\
2025-11-14 08:07:11,724 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56960  Initializing PostgreSQL + pgvector RAG system...\
2025-11-14 08:07:11,727 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56522  Initializing SQLite database for RAG...\
2025-11-14 08:07:11,727 [INFO] app.service.database.vector_database_config: [] SQLite engine initialized\
2025-11-14 08:07:11,729 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG database tables created/verified\
2025-11-14 08:07:11,729 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  SQLite vector database initialized successfully\
2025-11-14 08:07:11,729 [INFO] app.service.rag.startup_integration: [] \uc0\u55358 \u56800  Initializing embedding service...\
2025-11-14 08:07:11,742 [INFO] app.service.rag.embedding_service: [] OpenAI embedding provider initialized\
2025-11-14 08:07:11,801 [WARNING] app.service.rag.embedding_service: [] HuggingFace provider not available: dlopen(/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/_C.cpython-311-darwin.so, 0x0002): Library not loaded: @loader_path/libtorch_cpu.dylib\
  Referenced from: <93B052AD-B16C-3D0F-A6FC-DFFBB7CD9584> /Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/lib/libtorch_python.dylib\
  Reason: tried: '/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/lib/libtorch_cpu.dylib' (no such file), '/usr/local/lib/libtorch_cpu.dylib' (no such file), '/usr/lib/libtorch_cpu.dylib' (no such file, not in dyld cache)\
2025-11-14 08:07:11,802 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Embedding service initialized with providers: openai\
2025-11-14 08:07:11,802 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56538  Initializing enhanced knowledge base...\
2025-11-14 08:07:11,802 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u55357 \u56960  Initializing Enhanced Knowledge Base...\
2025-11-14 08:07:11,818 [INFO] app.service.rag.enhanced_knowledge_base: [] Found 4 empty collections - consider populating with domain knowledge\
2025-11-14 08:07:11,818 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u9989  Enhanced Knowledge Base initialized successfully\
2025-11-14 08:07:11,818 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u9989  Enhanced Knowledge Base ready for fraud investigations\
2025-11-14 08:07:11,818 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Enhanced knowledge base initialized successfully\
2025-11-14 08:07:11,818 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56589  Performing RAG system health check...\
2025-11-14 08:07:11,820 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56520  RAG health check: 5 collections available\
2025-11-14 08:07:11,820 [WARNING] app.service.rag.startup_integration: [] Failed to create default data source: Instance <RAGDataSource at 0x14b937ed0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)\
2025-11-14 08:07:11,821 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56522  RAG system status: \{'database': True, 'embeddings': True, 'knowledge_base': True, 'overall': True\}\
2025-11-14 08:07:11,821 [INFO] app.service.rag.investigation_indexing_background: [] Started investigation indexing background service (poll interval: 60s)\
2025-11-14 08:07:11,821 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Background investigation indexing started\
2025-11-14 08:07:11,821 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG system initialization completed successfully\
2025-11-14 08:07:11,821 [INFO] app.service: [] \uc0\u9989  RAG system initialized successfully\
2025-11-14 08:07:11,821 [INFO] app.service: [] \uc0\u55357 \u56580  Scheduling background task to load top risk entities from Snowflake...\
2025-11-14 08:07:11,821 [INFO] app.service: [] \uc0\u9989  Background task scheduled - server will start without waiting for risk entities\
2025-11-14 08:07:11,821 [INFO] app.service: [] \uc0\u55357 \u56589  Validating anomaly detection configuration...\
2025-11-14 08:07:11,858 [INFO] app.service: [] \uc0\u9989  Anomaly detection configuration validated successfully\
2025-11-14 08:07:11,858 [INFO] app.service: [] \uc0\u9200  Initializing detection scheduler...\
2025-11-14 08:07:11,891 [INFO] app.service.anomaly.scheduler: [] Detection scheduler initialized: enabled=True, default_interval=15 minutes\
2025-11-14 08:07:11,903 [INFO] app.service.anomaly.scheduler_jobs: [] Registered 12 detector jobs\
2025-11-14 08:07:11,903 [INFO] app.service.anomaly.scheduler: [] Detection scheduler started successfully\
2025-11-14 08:07:11,903 [INFO] app.service: [] \uc0\u9989  Detection scheduler started\
2025-11-14 08:07:11,903 [INFO] app.service: [] Olorin application startup completed\
2025-11-14 08:07:11,905 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:07:11,905 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:07:12,112 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:07:12,186 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:07:12,186 [INFO] app.service: [] \uc0\u55357 \u56523  Loading top risk entities from Snowflake (background task)...\
2025-11-14 08:07:12,186 [INFO] app.service: [] \uc0\u55357 \u56550  Importing risk analyzer...\
2025-11-14 08:07:12,186 [INFO] app.service: [] \uc0\u55356 \u57325  Creating risk analyzer instance...\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] RiskAnalyzer initialized with SNOWFLAKE provider\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] Risk Analyzer configured: time_window=7d, group_by=email, top=10.0%\
2025-11-14 08:07:12,186 [INFO] app.service: [] \uc0\u55357 \u56588  Attempting to connect to Snowflake and fetch top risk entities...\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56580  Starting risk analysis with params: time_window=7d, group_by=email, top_percentage=10.0\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9201 \u65039  Parsing time window: 7d\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9201 \u65039  Parsed to 168 hours\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56588  Connecting to SNOWFLAKE database...\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9989  SNOWFLAKE connection initialized (lazy connection)\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55356 \u57303 \u65039  Building risk query for email filtering...\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56589  Executing SNOWFLAKE query for email filtering:\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] Query: \
        WITH risk_calculations AS (\
            SELECT\
                EMAIL as entity,\
                COUNT(*) as transaction_count,\
                SUM(PAID_AMOUNT_VALUE_IN_CURRENCY) as total_amount,\
                AVG(MODEL_SCORE) as avg_risk_score,\
                SUM(MODEL_SCORE * PAID_AMOUNT_VALUE_IN_CURRENCY) * COUNT(*) as risk_weighted_value,\
                MAX(MODEL_SCORE) as max_risk_score,\
                MIN(MODEL_SCORE) as min_risk_score,\
                SUM(CASE WHEN IS_FRAUD_T...\
2025-11-14 08:07:12,186 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9889  Sending query to SNOWFLAKE...\
2025-11-14 08:07:12,187 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: WITH risk_calculations AS (\
            SELECT\
                EMAIL as entity,\
                COUNT(*) as transaction_count,\
                SUM(PAID_AMOUNT_VALUE_IN_CURRENCY) as total_amount,\
     ...\
2025-11-14 08:07:12,479 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:07:12,531 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:07:12-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:07:12-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
StatReload detected changes in 'app/service/investigation/auto_comparison.py'. Reloading...\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:07:15,455 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:07:22,761 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 61703 rows\
2025-11-14 08:07:22,762 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 61703 rows returned\
2025-11-14 08:07:22,762 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56522  Query returned 61703 rows\
2025-11-14 08:07:22,907 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9989  Risk analysis completed: 61703 entities identified (from 61703 query rows)\
2025-11-14 08:07:22,907 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56522  Top 3 riskiest entities:\
2025-11-14 08:07:22,907 [INFO] app.service.analytics.risk_analyzer: []    1. Entity: meiling.soto.garrido@gmail.com | Transactions: 9 | Risk Score: 0.746\
2025-11-14 08:07:22,907 [INFO] app.service.analytics.risk_analyzer: []    2. Entity: moeller2media@gmail.com | Transactions: 20 | Risk Score: 0.393\
2025-11-14 08:07:22,907 [INFO] app.service.analytics.risk_analyzer: []    3. Entity: okuoku1959122@gmail.com | Transactions: 7 | Risk Score: 0.464\
2025-11-14 08:07:22,907 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:07:22,916 [INFO] app.service: [] \uc0\u55357 \u56522  Risk analyzer returned results: <class 'dict'> with keys: ['status', 'entities', 'summary', 'timestamp']\
2025-11-14 08:07:22,916 [INFO] app.service: [] \uc0\u9989  Successfully loaded 61703 top risk entities from Snowflake\
2025-11-14 08:07:22,916 [INFO] app.service: [] \uc0\u55357 \u56510  Stored risk entities in app state\
2025-11-14 08:07:22,916 [INFO] app.service: [] \uc0\u55357 \u56960  Starting automatic comparisons for top 3 riskiest entities...\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Starting auto-comparisons for top 3 riskiest entities\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: []    Entity type (from group_by): email\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Auto-Comparison 1/3\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: []    Entity: meiling.soto.garrido@gmail.com\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: []    Entity Type: email\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: []    Risk Score: 0.746\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: []    Transactions: 9\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Running auto-comparison for entity: email=meiling.soto.garrido@gmail.com\
2025-11-14 08:07:22,925 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Looking for historical investigations between 2025-05-18 and 2025-08-16\
2025-11-14 08:07:23,332 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  Investigation auto-comp-1ba6606d6091 is not completed (status: IN-PROGRESS), skipping...\
2025-11-14 08:07:23,333 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No historical investigation found - creating new investigation...\
2025-11-14 08:07:23,333 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-02T08:07:22.925269-05:00' AND TX_DATETIME < '2025-08-16T08:07:22.925269-05:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido...\
2025-11-14 08:07:26,915 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:07:26,916 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:07:26,916 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-16T08:07:22.925269-05:00' AND TX_DATETIME < '2025-11-14T08:07:22.925269-05:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido...\
2025-11-14 08:07:42,823 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:07:42,826 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:07:42,826 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found in desired historical window (2025-08-02 to 2025-08-16)\
2025-11-14 08:07:42,826 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Finding actual transaction date range for email=meiling.soto.garrido@gmail.com...\
2025-11-14 08:07:42,829 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
                MIN(TX_DATETIME) as earliest_date,\
                MAX(TX_DATETIME) as latest_date,\
                COUNT(*) as tx_count\
            FROM DBT.DBT_PROD.TXS\
            WHERE TX_...\
2025-11-14 08:07:56,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:07:56,598 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:07:56,598 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email=meiling.soto.garrido@gmail.com in last 180 days\
2025-11-14 08:07:56,598 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating historical investigation:\
2025-11-14 08:07:56,598 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-08-02 to 2025-08-16\
2025-11-14 08:07:56,599 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating investigation auto-comp-8610b2043851 for email=meiling.soto.garrido@gmail.com\
2025-11-14 08:07:56,600 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-08-02 to 2025-08-16\
2025-11-14 08:07:56,637 [INFO] app.service.investigation_trigger_service: [] Extracted structured investigation request for auto-comp-8610b2043851: entity_id=meiling.soto.garrido@gmail.com, entity_type=email\
2025-11-14 08:07:56,639 [INFO] app.service.investigation_trigger_service: [] Initialized progress_json for investigation auto-comp-8610b2043851\
2025-11-14 08:07:56,641 [INFO] app.service.investigation_trigger_service: [] State update verification for auto-comp-8610b2043851: lifecycle_stage=IN_PROGRESS, status=IN_PROGRESS, version=2, progress_json_initialized=True\
2025-11-14 08:07:56,643 [INFO] app.service.investigation_trigger_service: [] Updated investigation auto-comp-8610b2043851 state to IN_PROGRESS (version 1 -> 2)\
2025-11-14 08:07:56,643 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Triggering investigation execution for auto-comp-8610b2043851...\
2025-11-14 08:07:56,644 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Investigation auto-comp-8610b2043851 created and execution triggered, waiting for completion...\
2025-11-14 08:07:56,644 [INFO] uvicorn.error: [] Application startup complete.\
2025-11-14 08:07:56,645 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9881 \u65039  BACKGROUND TASK STARTED: execute_structured_investigation for auto-comp-8610b2043851\
2025-11-14 08:07:56,645 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960 \u55357 \u56960 \u55357 \u56960  STARTING BACKGROUND INVESTIGATION: auto-comp-8610b2043851\
2025-11-14 08:07:56,646 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-8610b2043851 already in IN_PROGRESS status\
2025-11-14 08:07:56,647 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960  STARTING REAL AUTONOMOUS INVESTIGATION: auto-comp-8610b2043851\
2025-11-14 08:07:56,647 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verified entity information: email=meiling.soto.garrido@gmail.com...\
2025-11-14 08:07:56,647 [INFO] app.service.agent.recursion_guard: [] Created execution context for investigation auto-comp-8610b2043851, thread auto-comp-8610b2043851-None\
2025-11-14 08:07:56,647 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u57057 \u65039  Created RecursionGuard context for investigation auto-comp-8610b2043851 with thread_id auto-comp-8610b2043851-None\
2025-11-14 08:07:56,647 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verification complete - execution can proceed for auto-comp-8610b2043851\
2025-11-14 08:07:56,647 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-8610b2043851 already in IN_PROGRESS status\
2025-11-14 08:07:56,650 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-8610b2043851: \{'status': 'in_progress', 'current_phase': 'agent_initialization'\}\
2025-11-14 08:07:56,655 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_initialization\
2025-11-14 08:07:56,655 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 0% | Phases: 0 completed\
2025-11-14 08:07:56,655 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_initialization\
2025-11-14 08:07:56,655 [WARNING] app.service.agent.journey_tracker: [] No active journey for investigation: auto-comp-8610b2043851. Creating emergency journey for node tracking.\
2025-11-14 08:07:56,655 [INFO] app.service.agent.journey_tracker: [] Started journey tracking for investigation: auto-comp-8610b2043851\
2025-11-14 08:07:56,658 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-8610b2043851: \{'current_phase': 'agent_initialization', 'progress_percentage': 5.0, 'status': 'in_progress'\}\
2025-11-14 08:07:56,658 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55357 \u56615  Creating REAL LangGraph agent system for auto-comp-8610b2043851\
2025-11-14 08:07:56,658 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 08:07:56,658 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 08:07:56,684 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:07:56,684 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:07:56,684 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:07:56,685 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:07:56,685 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:07:56,685 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:07:56,685 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:07:56,685 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:07:56,687 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:07:56,687 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:07:56,690 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:07:56,693 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 08:07:56,693 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  context_preparation\
2025-11-14 08:07:56,693 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 25% | Phases: 1 completed\
2025-11-14 08:07:56,693 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: context_preparation\
2025-11-14 08:07:56,696 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-8610b2043851: \{'current_phase': 'context_preparation', 'progress_percentage': 15.0\}\
2025-11-14 08:07:56,696 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55358 \u56800  Creating REAL agent context for auto-comp-8610b2043851\
2025-11-14 08:07:56,696 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56589  EXECUTING REAL AGENT INVESTIGATION: auto-comp-8610b2043851\
2025-11-14 08:07:56,697 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_execution\
2025-11-14 08:07:56,697 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 50% | Phases: 2 completed\
2025-11-14 08:07:56,697 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_execution\
2025-11-14 08:07:56,699 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-8610b2043851: \{'current_phase': 'agent_execution', 'progress_percentage': 25.0\}\
2025-11-14 08:07:56,700 [INFO] app.router.controllers.investigation_agent_tracking: [] \uc0\u55357 \u56523  ATTEMPTING TO LOG LLM INTERACTION FOR: auto-comp-8610b2043851\
2025-11-14 08:07:56,700 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  LLM Call: MultiAgentOrchestrator \u8594  gpt-4o\
2025-11-14 08:07:56,700 [INFO] app.service.logging.autonomous_investigation_logger: []            Tools: langgraph_parallel_execution | Tokens: 124.80000000000001\
2025-11-14 08:07:56,700 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Initiating real structured investigation with Device, Location, Network, Logs, and Risk Analysis age...\
2025-11-14 08:07:56,700 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  Decision: DeviceAnalysisAgent \u8594  device_analysis_start\
2025-11-14 08:07:56,700 [INFO] app.service.logging.autonomous_investigation_logger: []            Confidence: 95.00 | Outcome: N/A\
2025-11-14 08:07:56,700 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Analyzing device fingerprint inconsistencies and spoofing indicators\
2025-11-14 08:07:56,701 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56598  INVOKING REAL AGENTS: Device, Location, Network, Logs, Risk Analysis\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager: Getting investigation graph\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Investigation: auto-comp-8610b2043851\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u55357 \u56599  Service adapter: Getting investigation graph\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Investigation: auto-comp-8610b2043851\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Entity type: email\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: [] \uc0\u55356 \u57263  Selecting investigation graph with typed results\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Investigation: auto-comp-8610b2043851\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Entity type: email\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Fallback counter: 0\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    \uc0\u55358 \u56800  Hybrid intelligence graph selected\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u55357 \u56580  LEGACY: Initializing HybridGraphBuilder wrapper (intelligence_mode: adaptive, llm=None)\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u9989  Delegating to new modular hybrid intelligence system\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55357 \u56550  Using 14 focused components for improved maintainability\
2025-11-14 08:07:56,701 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55356 \u57261  DEMO MODE: Using rule-based heuristics (no API costs)\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_builders: [] \uc0\u55357 \u56615  Hybrid graph streaming: enabled\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u55357 \u56580  LEGACY: build_hybrid_investigation_graph called\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u10145 \u65039  Delegating to modular graph builder\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55357 \u56522  Parameters: enhanced_tools=True, streaming=True, interrupts=False, investigation_id=auto-comp-8610b2043851\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Building hybrid intelligence graph\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Enhanced tools: True\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Streaming enabled: True\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Creating hybrid intelligence graph foundation\
2025-11-14 08:07:56,702 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:07:56,705 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], tool_names: None\
2025-11-14 08:07:56,705 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:07:56,705 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:07:56,705 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], specific: None)\
2025-11-14 08:07:56,706 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:07:56,706 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56550  Loaded 18 tools for hybrid investigation\
2025-11-14 08:07:56,706 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u9989  [Hybrid] Using EnhancedToolNode with 18 tools and persistence enabled\
2025-11-14 08:07:56,706 [INFO] app.service.agent.orchestration.hybrid.graph.builders.node_factory: [] \uc0\u55356 \u57303 \u65039  Node factory completed: 16 nodes created\
2025-11-14 08:07:56,707 [INFO] app.service.agent.orchestration.hybrid.graph.builders.memory_provider: [] \uc0\u55357 \u57057 \u65039  Using in-memory storage for hybrid graph (Redis checkpoint unavailable)\
2025-11-14 08:07:56,752 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u9989  Hybrid intelligence graph compiled successfully\
2025-11-14 08:07:56,753 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Nodes: 19\
2025-11-14 08:07:56,753 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:07:56,753 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u9989  LEGACY: Graph building delegated successfully\
2025-11-14 08:07:56,753 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57263  100% backward compatibility maintained\
2025-11-14 08:07:56,753 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57303 \u65039  Using modular architecture with 14 components\
2025-11-14 08:07:56,753 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u9989  Investigation graph ready: auto-comp-8610b2043851\
2025-11-14 08:07:56,753 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u9989  Investigation graph ready: auto-comp-8610b2043851\
2025-11-14 08:07:56,753 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56800  Using Hybrid Intelligence graph for investigation: auto-comp-8610b2043851\
2025-11-14 08:07:56,753 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56960  EXECUTING CLEAN GRAPH ORCHESTRATION (replacing old agent service)\
2025-11-14 08:07:57 \cf5 [INFO]\cf4  app.service.middleware.middleware_config: CORS configured for local environment with 16 allowed origins\
2025-11-14 08:07:57,531 [INFO] app.service.middleware.middleware_config: [] Investigation ID middleware configured for log stream correlation\
2025-11-14 08:07:57,532 [INFO] app.service.middleware.middleware_config: [] Rate limiting configured for local: 500 requests per 60 seconds\
2025-11-14 08:07:57,532 [INFO] app.middleware.logstream_rate_limiter: [] Log stream rate limiting configured for local: streaming=30 req/60s, ingestion=20 req/60s\
2025-11-14 08:07:57,751 [INFO] app.service.config_loader: [] Loaded .env configuration from /Users/gklainert/Documents/olorin/olorin-server/.env\
2025-11-14 08:07:57,751 [INFO] app.service.config_loader: [] Firebase Secret Manager disabled - using .env only\
2025-11-14 08:07:57,751 [INFO] app.service.config_loader: [] ConfigLoader initialized for environment: local\
2025-11-14 08:07:57,751 [INFO] app.security.auth: [] JWT secret loaded from Firebase Secrets Manager\
2025-11-14 08:07:57,754 [INFO] app.service.middleware.middleware_config: [] Production error middleware configured for environment: local\
2025-11-14 08:07:58,142 [INFO] app.service.agent.journey_tracker: [] Initialized LangGraphJourneyTracker with output: logs/journey_tracking\
2025-11-14 08:07:58,143 [INFO] app.service.agent.chain_of_thought_logger: [] Initialized ChainOfThoughtLogger with directory: logs/chain_of_thought\
\uc0\u9989  Loaded .env file with 13 enabled tools\
\uc0\u9989  Schema constants loaded: 333 columns validated for DBT.DBT_PROD.TXS (SNOWFLAKE)\
2025-11-14 08:07:58,357 [INFO] app.service.agent.tools.snowflake_tool.client: [] Using REAL Snowflake client (USE_SNOWFLAKE=true)\
[API_ROUTER] Attempting to import analytics router...\
2025-11-14 08:08:01,713 [INFO] app.router.api_router: [] Attempting to import analytics router...\
2025-11-14 08:08:01,715 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.cohort_analyzer: [] CohortAnalyzer initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.experiment_manager: [] ExperimentManager initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.drift_detector: [] DriftDetector initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.replay_engine: [] ReplayEngine initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.explainer: [] Explainer initialized with SNOWFLAKE provider\
2025-11-14 08:08:01,715 [INFO] app.service.analytics.pipeline_monitor: [] PipelineMonitor initialized with SNOWFLAKE provider\
[API_ROUTER] Analytics router imported: prefix=/analytics, routes=51\
2025-11-14 08:08:02,283 [INFO] app.router.api_router: [] Analytics router imported successfully, prefix: /analytics, routes: 51\
[API_ROUTER] \uc0\u9989  Analytics router included successfully\
2025-11-14 08:08:02,296 [INFO] app.router.api_router: [] \uc0\u9989  Analytics router included successfully with prefix: /analytics\
2025-11-14 08:08:02,360 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: [] \uc0\u9989  Migration utilities loaded - backward compatibility maintained\
2025-11-14 08:08:02,361 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: []    All original functionality preserved through new modular system\
2025-11-14 08:08:02,361 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: []    Components: Feature flags, graph selection, rollback, integration\
2025-11-14 08:08:02,361 [INFO] app.service.agent.orchestration.hybrid.observability.counters: [] \uc0\u55357 \u56522  Initialized 25 observability counters\
2025-11-14 08:08:02,361 [INFO] app.service.agent.tools.tool_registry: [] Splunk tool registered (enabled via USE_SPLUNK=true)\
2025-11-14 08:08:02,361 [INFO] app.service.agent.tools.tool_registry: [] SumoLogic tool registered (enabled via USE_SUMO_LOGIC=true)\
2025-11-14 08:08:02,361 [INFO] app.service.agent.tools.tool_registry: [] Snowflake tool registered (enabled via USE_SNOWFLAKE=true)\
2025-11-14 08:08:02,377 [INFO] app.service.agent.tools.tool_registry: [] Anomaly detection tools registered (fetch_series, detect_anomalies, list_anomalies, open_investigation, attach_evidence, segment_hunter, entity_extractor, anomaly_correlator)\
2025-11-14 08:08:02,379 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register device fingerprint tool: "DeviceFingerprintTool" object has no field "signal_processor"\
2025-11-14 08:08:02,383 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register MaxMind minFraud tool: "MaxMindMinFraudTool" object has no field "maxmind_client"\
2025-11-14 08:08:02,385 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register Composio tool: COMPOSIO_API_KEY not configured. Set environment variable or configure secret.\
2025-11-14 08:08:02,487 [INFO] app.service.graph.graph_client_abstraction: [] No graph provider configured, defaulting to Neo4j\
2025-11-14 08:08:02,487 [WARNING] app.service.graph.neo4j_client: [] Neo4j credentials not configured\
2025-11-14 08:08:02,487 [WARNING] app.service.graph.graph_client_abstraction: [] Neo4j not available, graph operations will fail gracefully\
2025-11-14 08:08:02,489 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register graph feature tool: "GraphFeatureTool" object has no field "feature_computer"\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] AbuseIPDB IP reputation tool registered\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal IP analysis tool registered\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal domain analysis tool registered\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal file analysis tool registered\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal URL analysis tool registered\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] Shodan infrastructure analysis tool registered\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] Shodan search tool registered\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] MCP servers disabled - skipping MCP server tool registration\
2025-11-14 08:08:02,489 [INFO] app.service.agent.tools.tool_registry: [] Tool registry initialized with 18 tools\
2025-11-14 08:08:02,489 [INFO] app.router.mcp_bridge_router: [] MCP bridge initialized with tools\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)\
2025-11-14 08:08:02,515 [INFO] app.test.data.mock_transactions.mock_data_loader: [] Initialized MockDataLoader with base path: /Users/gklainert/Documents/olorin/olorin-server/app/test/data/mock_transactions\
/Users/gklainert/Documents/olorin/olorin-server/app/router/autonomous_investigation_router.py:312: DeprecationWarning: `example` has been deprecated, please use `examples` instead\
  investigation_id: str = Path(description="Unique investigation identifier", example="multi_a1b2c3d4")\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1093: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn(\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)\
StatReload detected changes in 'app/service/investigation/auto_comparison.py'. Reloading...\
2025-11-14 08:08:02,827 [INFO] app.service.router.router_config: [] All core routers have been included (WebSocket disabled)\
2025-11-14 08:08:02,827 [INFO] app.service.router.router_config: [] Error handlers registered\
2025-11-14 08:08:02,827 [INFO] app.service.router.router_config: [] pskhealth not available, using enhanced health router\
2025-11-14 08:08:02,827 [INFO] app.service.router.router_config: [] App metrics exposed\
2025-11-14 08:08:02,828 [INFO] uvicorn.error: [] Started server process [86505]\
2025-11-14 08:08:02,828 [INFO] uvicorn.error: [] Waiting for application startup.\
2025-11-14 08:08:02,828 [INFO] app.service: [] \uc0\u55357 \u56960  Starting Olorin application...\
2025-11-14 08:08:02,828 [INFO] app.service: [] \uc0\u55357 \u56615  Validating log stream configuration...\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1093: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn(\
2025-11-14 08:08:02,860 [ERROR] app.config.logstream_validator: [] \uc0\u10060  LOG STREAM CONFIGURATION VALIDATION FAILED\
\
Missing or invalid environment variables:\
\
  \uc0\u10060  frontend_log_endpoint:\
     Field required\
\
  \uc0\u10060  backend_log_endpoint:\
     Field required\
\
  \uc0\u10060  provider_timeout_ms:\
     Field required\
\
\
Please set all required LOGSTREAM_* environment variables.\
See app/config/logstream_config.py for required configuration.\
2025-11-14 08:08:02,860 [ERROR] app.service: [] \uc0\u10060  Log stream configuration validation failed: \u10060  LOG STREAM CONFIGURATION VALIDATION FAILED\
\
Missing or invalid environment variables:\
\
  \uc0\u10060  frontend_log_endpoint:\
     Field required\
\
  \uc0\u10060  backend_log_endpoint:\
     Field required\
\
  \uc0\u10060  provider_timeout_ms:\
     Field required\
\
\
Please set all required LOGSTREAM_* environment variables.\
See app/config/logstream_config.py for required configuration.\
2025-11-14 08:08:02,860 [ERROR] app.service: []    Set SKIP_LOGSTREAM_VALIDATION=true to continue startup without log streaming\
2025-11-14 08:08:02,860 [INFO] app.service: [] \uc0\u55357 \u56772 \u65039  Initializing database...\
2025-11-14 08:08:02,868 [INFO] app.persistence.database: [] Database initialized with URL: sqlite:///./olorin_test.db\
2025-11-14 08:08:02,872 [INFO] app.persistence.database: [] Database tables created\
2025-11-14 08:08:02,872 [INFO] app.service: [] \uc0\u9989  Database tables creation attempted\
2025-11-14 08:08:02,872 [INFO] app.service: [] \uc0\u55357 \u56589  Verifying required tables...\
2025-11-14 08:08:02,873 [INFO] app.service: [] \uc0\u9989  All required tables verified: \{'anomaly_events', 'investigation_states', 'detectors', 'detection_runs'\}\
2025-11-14 08:08:02,873 [INFO] app.service: [] \uc0\u55357 \u56589  Verifying database indexes...\
2025-11-14 08:08:02,873 [INFO] app.service: [] \uc0\u55357 \u56589  Checking for database configuration issues...\
2025-11-14 08:08:02,873 [INFO] app.service: [] \uc0\u9989  Using SQLite for investigation state management\
2025-11-14 08:08:02,873 [INFO] app.service: []    Database path: sqlite:///./olorin_test.db\
2025-11-14 08:08:02,873 [INFO] app.service: [] \uc0\u55357 \u56580  Running database migrations...\
[2025-11-14T08:08:02-0500] INFO [] module=runner: Skipping Snowflake-specific migration 002_add_experiments_tables.sql (database type: sqlite)\
[2025-11-14T08:08:02-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:08:02-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 006_add_transaction_windows_view.sql (database type: sqlite)\
[2025-11-14T08:08:02-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_device_signals.sql (database type: sqlite)\
[2025-11-14T08:08:02-0500] INFO [] module=runner: Skipping Snowflake-specific migration 008_create_dynamic_tables.sql (database type: sqlite)\
[2025-11-14T08:08:02-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:08:02-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_graph_features.sql (database type: sqlite)\
[2025-11-14T08:08:02-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_ip_risk_scores.sql (database type: sqlite)\
[2025-11-14T08:08:02-0500] INFO [] module=runner: Skipping Snowflake-specific migration 008_create_snowpipe_tables.sql (database type: sqlite)\
[2025-11-14T08:08:02-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:08:02-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 009_create_device_features_view.sql (database type: sqlite)\
2025-11-14 08:08:02,885 [INFO] app.service: [] \uc0\u9989  Database migrations completed successfully\
2025-11-14 08:08:02,885 [INFO] app.service: [] \uc0\u55357 \u56588  Initializing database provider...\
2025-11-14 08:08:02,885 [INFO] app.service: [] \uc0\u9989  Database provider initialized: SnowflakeProvider\
2025-11-14 08:08:02,885 [INFO] app.service: [] \uc0\u9989  Database connection established: SnowflakeProvider\
2025-11-14 08:08:02,885 [INFO] app.service: [] \uc0\u55357 \u56589  Validating database schema parity...\
2025-11-14 08:08:02,885 [INFO] app.service: [] \uc0\u8505 \u65039  Schema validation skipped (using Snowflake as source of truth)\
2025-11-14 08:08:02,885 [INFO] app.service.performance.performance_manager: [] Starting Olorin application with performance optimizations...\
2025-11-14 08:08:02,895 [INFO] app.service.performance.performance_manager: [] \uc0\u10003  Performance optimization system initialized successfully\
2025-11-14 08:08:02,895 [INFO] app.service.performance.performance_manager: [] Performance targets:\
2025-11-14 08:08:02,895 [INFO] app.service.performance.performance_manager: []   - api_latency: -40% improvement target\
2025-11-14 08:08:02,895 [INFO] app.service.performance.performance_manager: []   - agent_execution: -50% improvement target\
2025-11-14 08:08:02,895 [INFO] app.service.performance.performance_manager: []   - cache_hit_rate: +200% improvement target\
2025-11-14 08:08:02,895 [INFO] app.service.performance.performance_manager: []   - memory_usage: -25% improvement target\
2025-11-14 08:08:02,895 [INFO] app.service.performance.performance_manager: []   - throughput: +100% improvement target\
2025-11-14 08:08:02,895 [INFO] app.service: [] \uc0\u55358 \u56598  Initializing agent system...\
2025-11-14 08:08:02,899 [INFO] app.service.agent.agent_factory: [] RAG modules loaded successfully\
2025-11-14 08:08:02,914 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'utility'], tool_names: None\
2025-11-14 08:08:02,914 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:02,914 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:02,914 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'utility'], specific: None)\
2025-11-14 08:08:02,914 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:02,916 [INFO] app.service.agent.agent: [] Initialized 18 tools for structured agents (including 5 threat intelligence tools, 3 database tools)\
2025-11-14 08:08:02,918 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 08:08:02,918 [INFO] app.service.agent.recursion_guard: [] Initialized global RecursionGuard\
2025-11-14 08:08:02,918 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 08:08:02,947 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:08:02,947 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:02,947 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:02,947 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:08:02,947 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:02,947 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:08:02,947 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:08:02,947 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:08:02,948 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:08:02,948 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:08:02,950 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:08:02,961 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 08:08:02,961 [INFO] app.service.agent_init: [] \uc0\u9989  Parallel graph initialized\
2025-11-14 08:08:02,961 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=False, enhanced_tools=True, subgraphs=False\
2025-11-14 08:08:02,961 [INFO] app.service.agent.orchestration.graph_builder: [] Creating sequential graph with controlled agent execution\
2025-11-14 08:08:02,983 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:08:02,983 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:02,983 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:02,983 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:08:02,983 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:02,983 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:08:02,983 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:08:02,983 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:08:02,984 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:08:02,984 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:08:02,986 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:08:02,989 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Sequential agent graph compiled successfully\
2025-11-14 08:08:02,989 [INFO] app.service.agent_init: [] \uc0\u9989  Sequential graph initialized\
2025-11-14 08:08:02,989 [INFO] app.service.agent_init: [] \uc0\u9989  At least one agent graph initialized\
2025-11-14 08:08:02,989 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:08:02,989 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:08:02,989 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:08:02,989 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager initialized\
2025-11-14 08:08:02,989 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Feature flags: 7 flags\
2025-11-14 08:08:02,989 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Components: All migration and integration components loaded\
2025-11-14 08:08:02,989 [INFO] app.service.agent_init: [] \uc0\u55358 \u56800  Hybrid Intelligence Graph system initialized\
2025-11-14 08:08:02,989 [INFO] app.service.agent_init: [] \uc0\u55357 \u57001  Feature flags status:\
2025-11-14 08:08:02,989 [INFO] app.service.agent_init: []    hybrid_graph_v1: \uc0\u9989  (100% rollout)\
2025-11-14 08:08:02,989 [INFO] app.service.agent_init: []    ai_confidence_engine: \uc0\u9989  (100% rollout)\
2025-11-14 08:08:02,989 [INFO] app.service.agent_init: []    ab_test_hybrid_vs_clean: \uc0\u10060  (0% rollout)\
2025-11-14 08:08:02,990 [INFO] app.service: [] \uc0\u9989  Agent system initialized successfully\
2025-11-14 08:08:02,990 [INFO] app.service: [] \uc0\u55357 \u56960  Initializing RAG system...\
2025-11-14 08:08:02,991 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56960  Initializing PostgreSQL + pgvector RAG system...\
2025-11-14 08:08:02,993 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56522  Initializing SQLite database for RAG...\
2025-11-14 08:08:02,993 [INFO] app.service.database.vector_database_config: [] SQLite engine initialized\
2025-11-14 08:08:02,995 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG database tables created/verified\
2025-11-14 08:08:02,995 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  SQLite vector database initialized successfully\
2025-11-14 08:08:02,995 [INFO] app.service.rag.startup_integration: [] \uc0\u55358 \u56800  Initializing embedding service...\
2025-11-14 08:08:03,007 [INFO] app.service.rag.embedding_service: [] OpenAI embedding provider initialized\
2025-11-14 08:08:03,030 [WARNING] app.service.rag.embedding_service: [] HuggingFace provider not available: dlopen(/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/_C.cpython-311-darwin.so, 0x0002): Library not loaded: @loader_path/libtorch_cpu.dylib\
  Referenced from: <93B052AD-B16C-3D0F-A6FC-DFFBB7CD9584> /Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/lib/libtorch_python.dylib\
  Reason: tried: '/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/lib/libtorch_cpu.dylib' (no such file), '/usr/local/lib/libtorch_cpu.dylib' (no such file), '/usr/lib/libtorch_cpu.dylib' (no such file, not in dyld cache)\
2025-11-14 08:08:03,030 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Embedding service initialized with providers: openai\
2025-11-14 08:08:03,030 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56538  Initializing enhanced knowledge base...\
2025-11-14 08:08:03,030 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u55357 \u56960  Initializing Enhanced Knowledge Base...\
2025-11-14 08:08:03,045 [INFO] app.service.rag.enhanced_knowledge_base: [] Found 4 empty collections - consider populating with domain knowledge\
2025-11-14 08:08:03,045 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u9989  Enhanced Knowledge Base initialized successfully\
2025-11-14 08:08:03,045 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u9989  Enhanced Knowledge Base ready for fraud investigations\
2025-11-14 08:08:03,045 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Enhanced knowledge base initialized successfully\
2025-11-14 08:08:03,045 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56589  Performing RAG system health check...\
2025-11-14 08:08:03,046 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56520  RAG health check: 5 collections available\
2025-11-14 08:08:03,047 [WARNING] app.service.rag.startup_integration: [] Failed to create default data source: Instance <RAGDataSource at 0x14c27ad90> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)\
2025-11-14 08:08:03,047 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56522  RAG system status: \{'database': True, 'embeddings': True, 'knowledge_base': True, 'overall': True\}\
2025-11-14 08:08:03,047 [INFO] app.service.rag.investigation_indexing_background: [] Started investigation indexing background service (poll interval: 60s)\
2025-11-14 08:08:03,047 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Background investigation indexing started\
2025-11-14 08:08:03,047 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG system initialization completed successfully\
2025-11-14 08:08:03,047 [INFO] app.service: [] \uc0\u9989  RAG system initialized successfully\
2025-11-14 08:08:03,047 [INFO] app.service: [] \uc0\u55357 \u56580  Scheduling background task to load top risk entities from Snowflake...\
2025-11-14 08:08:03,047 [INFO] app.service: [] \uc0\u9989  Background task scheduled - server will start without waiting for risk entities\
2025-11-14 08:08:03,047 [INFO] app.service: [] \uc0\u55357 \u56589  Validating anomaly detection configuration...\
2025-11-14 08:08:03,080 [INFO] app.service: [] \uc0\u9989  Anomaly detection configuration validated successfully\
2025-11-14 08:08:03,080 [INFO] app.service: [] \uc0\u9200  Initializing detection scheduler...\
2025-11-14 08:08:03,110 [INFO] app.service.anomaly.scheduler: [] Detection scheduler initialized: enabled=True, default_interval=15 minutes\
2025-11-14 08:08:03,121 [INFO] app.service.anomaly.scheduler_jobs: [] Registered 12 detector jobs\
2025-11-14 08:08:03,121 [INFO] app.service.anomaly.scheduler: [] Detection scheduler started successfully\
2025-11-14 08:08:03,121 [INFO] app.service: [] \uc0\u9989  Detection scheduler started\
2025-11-14 08:08:03,121 [INFO] app.service: [] Olorin application startup completed\
2025-11-14 08:08:03,123 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'COMPLETED', 'IN_PROGRESS'\}\
2025-11-14 08:08:03,123 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:08:03,324 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:08:03,394 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:08:03,395 [INFO] app.service: [] \uc0\u55357 \u56523  Loading top risk entities from Snowflake (background task)...\
2025-11-14 08:08:03,395 [INFO] app.service: [] \uc0\u55357 \u56550  Importing risk analyzer...\
2025-11-14 08:08:03,395 [INFO] app.service: [] \uc0\u55356 \u57325  Creating risk analyzer instance...\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] RiskAnalyzer initialized with SNOWFLAKE provider\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] Risk Analyzer configured: time_window=7d, group_by=email, top=10.0%\
2025-11-14 08:08:03,395 [INFO] app.service: [] \uc0\u55357 \u56588  Attempting to connect to Snowflake and fetch top risk entities...\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56580  Starting risk analysis with params: time_window=7d, group_by=email, top_percentage=10.0\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9201 \u65039  Parsing time window: 7d\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9201 \u65039  Parsed to 168 hours\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56588  Connecting to SNOWFLAKE database...\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9989  SNOWFLAKE connection initialized (lazy connection)\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55356 \u57303 \u65039  Building risk query for email filtering...\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56589  Executing SNOWFLAKE query for email filtering:\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] Query: \
        WITH risk_calculations AS (\
            SELECT\
                EMAIL as entity,\
                COUNT(*) as transaction_count,\
                SUM(PAID_AMOUNT_VALUE_IN_CURRENCY) as total_amount,\
                AVG(MODEL_SCORE) as avg_risk_score,\
                SUM(MODEL_SCORE * PAID_AMOUNT_VALUE_IN_CURRENCY) * COUNT(*) as risk_weighted_value,\
                MAX(MODEL_SCORE) as max_risk_score,\
                MIN(MODEL_SCORE) as min_risk_score,\
                SUM(CASE WHEN IS_FRAUD_T...\
2025-11-14 08:08:03,395 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9889  Sending query to SNOWFLAKE...\
2025-11-14 08:08:03,396 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: WITH risk_calculations AS (\
            SELECT\
                EMAIL as entity,\
                COUNT(*) as transaction_count,\
                SUM(PAID_AMOUNT_VALUE_IN_CURRENCY) as total_amount,\
     ...\
2025-11-14 08:08:03,641 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:08:03,690 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:08:03,690 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:08:03,690 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:08:03,690 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:08:03,690 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:08:03,691 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:08:03,691 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:08:03,691 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:08:03,691 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:08:03,691 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:08:03,691 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:08:03,691 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:08:03,691 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:08:03-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:08:03-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:08:04,362 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:08:09,639 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 61697 rows\
2025-11-14 08:08:09,640 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 61697 rows returned\
2025-11-14 08:08:09,640 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56522  Query returned 61697 rows\
2025-11-14 08:08:09,780 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9989  Risk analysis completed: 61697 entities identified (from 61697 query rows)\
2025-11-14 08:08:09,780 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56522  Top 3 riskiest entities:\
2025-11-14 08:08:09,780 [INFO] app.service.analytics.risk_analyzer: []    1. Entity: meiling.soto.garrido@gmail.com | Transactions: 9 | Risk Score: 0.746\
2025-11-14 08:08:09,780 [INFO] app.service.analytics.risk_analyzer: []    2. Entity: moeller2media@gmail.com | Transactions: 20 | Risk Score: 0.393\
2025-11-14 08:08:09,780 [INFO] app.service.analytics.risk_analyzer: []    3. Entity: okuoku1959122@gmail.com | Transactions: 7 | Risk Score: 0.464\
2025-11-14 08:08:09,780 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:08:09,787 [INFO] app.service: [] \uc0\u55357 \u56522  Risk analyzer returned results: <class 'dict'> with keys: ['status', 'entities', 'summary', 'timestamp']\
2025-11-14 08:08:09,787 [INFO] app.service: [] \uc0\u9989  Successfully loaded 61697 top risk entities from Snowflake\
2025-11-14 08:08:09,787 [INFO] app.service: [] \uc0\u55357 \u56510  Stored risk entities in app state\
2025-11-14 08:08:09,787 [INFO] app.service: [] \uc0\u55357 \u56960  Starting automatic comparisons for top 3 riskiest entities...\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Starting auto-comparisons for top 3 riskiest entities\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: []    Entity type (from group_by): email\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Auto-Comparison 1/3\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: []    Entity: meiling.soto.garrido@gmail.com\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: []    Entity Type: email\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: []    Risk Score: 0.746\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: []    Transactions: 9\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Running auto-comparison for entity: email=meiling.soto.garrido@gmail.com\
2025-11-14 08:08:09,794 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Looking for historical investigations between 2025-05-18 and 2025-08-16\
2025-11-14 08:08:10,157 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  Investigation auto-comp-8610b2043851 is not completed (status: IN-PROGRESS), skipping...\
2025-11-14 08:08:10,157 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No historical investigation found - creating new investigation...\
2025-11-14 08:08:10,158 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-02T08:08:09.794269-05:00' AND TX_DATETIME < '2025-08-16T08:08:09.794269-05:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido...\
2025-11-14 08:08:11,520 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:08:11,522 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:08:11,523 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-16T08:08:09.794269-05:00' AND TX_DATETIME < '2025-11-14T08:08:09.794269-05:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido...\
2025-11-14 08:08:14,931 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:08:14,932 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:08:14,933 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found in desired historical window (2025-08-02 to 2025-08-16)\
2025-11-14 08:08:14,933 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Finding actual transaction date range for email=meiling.soto.garrido@gmail.com...\
2025-11-14 08:08:14,935 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
                MIN(TX_DATETIME) as earliest_date,\
                MAX(TX_DATETIME) as latest_date,\
                COUNT(*) as tx_count\
            FROM DBT.DBT_PROD.TXS\
            WHERE TX_...\
2025-11-14 08:08:20,873 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:08:20,874 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:08:20,874 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email=meiling.soto.garrido@gmail.com in last 180 days\
2025-11-14 08:08:20,874 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating historical investigation:\
2025-11-14 08:08:20,874 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-08-02 to 2025-08-16\
2025-11-14 08:08:20,874 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating investigation auto-comp-0b9764e8c40e for email=meiling.soto.garrido@gmail.com\
2025-11-14 08:08:20,874 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-08-02 to 2025-08-16\
2025-11-14 08:08:20,910 [INFO] app.service.investigation_trigger_service: [] Extracted structured investigation request for auto-comp-0b9764e8c40e: entity_id=meiling.soto.garrido@gmail.com, entity_type=email\
2025-11-14 08:08:20,911 [INFO] app.service.investigation_trigger_service: [] Initialized progress_json for investigation auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,913 [INFO] app.service.investigation_trigger_service: [] State update verification for auto-comp-0b9764e8c40e: lifecycle_stage=IN_PROGRESS, status=IN_PROGRESS, version=2, progress_json_initialized=True\
2025-11-14 08:08:20,914 [INFO] app.service.investigation_trigger_service: [] Updated investigation auto-comp-0b9764e8c40e state to IN_PROGRESS (version 1 -> 2)\
2025-11-14 08:08:20,914 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Triggering investigation execution for auto-comp-0b9764e8c40e...\
2025-11-14 08:08:20,915 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Investigation auto-comp-0b9764e8c40e created and execution triggered, waiting for completion...\
2025-11-14 08:08:20,916 [INFO] uvicorn.error: [] Application startup complete.\
2025-11-14 08:08:20,916 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9881 \u65039  BACKGROUND TASK STARTED: execute_structured_investigation for auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,916 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960 \u55357 \u56960 \u55357 \u56960  STARTING BACKGROUND INVESTIGATION: auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,917 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-0b9764e8c40e already in IN_PROGRESS status\
2025-11-14 08:08:20,917 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960  STARTING REAL AUTONOMOUS INVESTIGATION: auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,918 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verified entity information: email=meiling.soto.garrido@gmail.com...\
2025-11-14 08:08:20,918 [INFO] app.service.agent.recursion_guard: [] Created execution context for investigation auto-comp-0b9764e8c40e, thread auto-comp-0b9764e8c40e-None\
2025-11-14 08:08:20,918 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u57057 \u65039  Created RecursionGuard context for investigation auto-comp-0b9764e8c40e with thread_id auto-comp-0b9764e8c40e-None\
2025-11-14 08:08:20,918 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verification complete - execution can proceed for auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,918 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-0b9764e8c40e already in IN_PROGRESS status\
2025-11-14 08:08:20,920 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-0b9764e8c40e: \{'status': 'in_progress', 'current_phase': 'agent_initialization'\}\
2025-11-14 08:08:20,921 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_initialization\
2025-11-14 08:08:20,921 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 0% | Phases: 0 completed\
2025-11-14 08:08:20,921 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_initialization\
2025-11-14 08:08:20,921 [WARNING] app.service.agent.journey_tracker: [] No active journey for investigation: auto-comp-0b9764e8c40e. Creating emergency journey for node tracking.\
2025-11-14 08:08:20,921 [INFO] app.service.agent.journey_tracker: [] Started journey tracking for investigation: auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,926 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-0b9764e8c40e: \{'current_phase': 'agent_initialization', 'progress_percentage': 5.0, 'status': 'in_progress'\}\
2025-11-14 08:08:20,926 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55357 \u56615  Creating REAL LangGraph agent system for auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,926 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 08:08:20,926 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 08:08:20,950 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:08:20,950 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:20,950 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:20,950 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:08:20,950 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:20,950 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:08:20,950 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:08:20,950 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:08:20,951 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:08:20,951 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:08:20,953 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:08:20,955 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 08:08:20,955 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  context_preparation\
2025-11-14 08:08:20,955 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 25% | Phases: 1 completed\
2025-11-14 08:08:20,955 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: context_preparation\
2025-11-14 08:08:20,959 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-0b9764e8c40e: \{'current_phase': 'context_preparation', 'progress_percentage': 15.0\}\
2025-11-14 08:08:20,959 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55358 \u56800  Creating REAL agent context for auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,959 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56589  EXECUTING REAL AGENT INVESTIGATION: auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,959 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_execution\
2025-11-14 08:08:20,959 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 50% | Phases: 2 completed\
2025-11-14 08:08:20,959 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_execution\
2025-11-14 08:08:20,961 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-0b9764e8c40e: \{'current_phase': 'agent_execution', 'progress_percentage': 25.0\}\
2025-11-14 08:08:20,962 [INFO] app.router.controllers.investigation_agent_tracking: [] \uc0\u55357 \u56523  ATTEMPTING TO LOG LLM INTERACTION FOR: auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,962 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  LLM Call: MultiAgentOrchestrator \u8594  gpt-4o\
2025-11-14 08:08:20,962 [INFO] app.service.logging.autonomous_investigation_logger: []            Tools: langgraph_parallel_execution | Tokens: 124.80000000000001\
2025-11-14 08:08:20,962 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Initiating real structured investigation with Device, Location, Network, Logs, and Risk Analysis age...\
2025-11-14 08:08:20,962 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  Decision: DeviceAnalysisAgent \u8594  device_analysis_start\
2025-11-14 08:08:20,962 [INFO] app.service.logging.autonomous_investigation_logger: []            Confidence: 95.00 | Outcome: N/A\
2025-11-14 08:08:20,962 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Analyzing device fingerprint inconsistencies and spoofing indicators\
2025-11-14 08:08:20,962 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56598  INVOKING REAL AGENTS: Device, Location, Network, Logs, Risk Analysis\
2025-11-14 08:08:20,962 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager: Getting investigation graph\
2025-11-14 08:08:20,962 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Investigation: auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,962 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u55357 \u56599  Service adapter: Getting investigation graph\
2025-11-14 08:08:20,962 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Investigation: auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,962 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Entity type: email\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: [] \uc0\u55356 \u57263  Selecting investigation graph with typed results\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Investigation: auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Entity type: email\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Fallback counter: 0\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    \uc0\u55358 \u56800  Hybrid intelligence graph selected\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u55357 \u56580  LEGACY: Initializing HybridGraphBuilder wrapper (intelligence_mode: adaptive, llm=None)\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u9989  Delegating to new modular hybrid intelligence system\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55357 \u56550  Using 14 focused components for improved maintainability\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55356 \u57261  DEMO MODE: Using rule-based heuristics (no API costs)\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_builders: [] \uc0\u55357 \u56615  Hybrid graph streaming: enabled\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u55357 \u56580  LEGACY: build_hybrid_investigation_graph called\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u10145 \u65039  Delegating to modular graph builder\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55357 \u56522  Parameters: enhanced_tools=True, streaming=True, interrupts=False, investigation_id=auto-comp-0b9764e8c40e\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Building hybrid intelligence graph\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Enhanced tools: True\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Streaming enabled: True\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Creating hybrid intelligence graph foundation\
2025-11-14 08:08:20,963 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:08:20,966 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], tool_names: None\
2025-11-14 08:08:20,966 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:20,966 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:20,966 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], specific: None)\
2025-11-14 08:08:20,966 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:20,966 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56550  Loaded 18 tools for hybrid investigation\
2025-11-14 08:08:20,966 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u9989  [Hybrid] Using EnhancedToolNode with 18 tools and persistence enabled\
2025-11-14 08:08:20,966 [INFO] app.service.agent.orchestration.hybrid.graph.builders.node_factory: [] \uc0\u55356 \u57303 \u65039  Node factory completed: 16 nodes created\
2025-11-14 08:08:20,967 [INFO] app.service.agent.orchestration.hybrid.graph.builders.memory_provider: [] \uc0\u55357 \u57057 \u65039  Using in-memory storage for hybrid graph (Redis checkpoint unavailable)\
2025-11-14 08:08:21,008 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u9989  Hybrid intelligence graph compiled successfully\
2025-11-14 08:08:21,008 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Nodes: 19\
2025-11-14 08:08:21,008 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:08:21,008 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u9989  LEGACY: Graph building delegated successfully\
2025-11-14 08:08:21,008 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57263  100% backward compatibility maintained\
2025-11-14 08:08:21,008 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57303 \u65039  Using modular architecture with 14 components\
2025-11-14 08:08:21,008 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u9989  Investigation graph ready: auto-comp-0b9764e8c40e\
2025-11-14 08:08:21,009 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u9989  Investigation graph ready: auto-comp-0b9764e8c40e\
2025-11-14 08:08:21,009 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56800  Using Hybrid Intelligence graph for investigation: auto-comp-0b9764e8c40e\
2025-11-14 08:08:21,009 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56960  EXECUTING CLEAN GRAPH ORCHESTRATION (replacing old agent service)\
2025-11-14 08:08:21 \cf5 [INFO]\cf4  app.service.middleware.middleware_config: CORS configured for local environment with 16 allowed origins\
2025-11-14 08:08:21,758 [INFO] app.service.middleware.middleware_config: [] Investigation ID middleware configured for log stream correlation\
2025-11-14 08:08:21,759 [INFO] app.service.middleware.middleware_config: [] Rate limiting configured for local: 500 requests per 60 seconds\
2025-11-14 08:08:21,759 [INFO] app.middleware.logstream_rate_limiter: [] Log stream rate limiting configured for local: streaming=30 req/60s, ingestion=20 req/60s\
2025-11-14 08:08:21,962 [INFO] app.service.config_loader: [] Loaded .env configuration from /Users/gklainert/Documents/olorin/olorin-server/.env\
2025-11-14 08:08:21,962 [INFO] app.service.config_loader: [] Firebase Secret Manager disabled - using .env only\
2025-11-14 08:08:21,962 [INFO] app.service.config_loader: [] ConfigLoader initialized for environment: local\
2025-11-14 08:08:21,962 [INFO] app.security.auth: [] JWT secret loaded from Firebase Secrets Manager\
2025-11-14 08:08:21,966 [INFO] app.service.middleware.middleware_config: [] Production error middleware configured for environment: local\
2025-11-14 08:08:22,351 [INFO] app.service.agent.journey_tracker: [] Initialized LangGraphJourneyTracker with output: logs/journey_tracking\
2025-11-14 08:08:22,353 [INFO] app.service.agent.chain_of_thought_logger: [] Initialized ChainOfThoughtLogger with directory: logs/chain_of_thought\
\uc0\u9989  Loaded .env file with 13 enabled tools\
\uc0\u9989  Schema constants loaded: 333 columns validated for DBT.DBT_PROD.TXS (SNOWFLAKE)\
2025-11-14 08:08:22,540 [INFO] app.service.agent.tools.snowflake_tool.client: [] Using REAL Snowflake client (USE_SNOWFLAKE=true)\
[API_ROUTER] Attempting to import analytics router...\
2025-11-14 08:08:25,140 [INFO] app.router.api_router: [] Attempting to import analytics router...\
2025-11-14 08:08:25,142 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.cohort_analyzer: [] CohortAnalyzer initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.experiment_manager: [] ExperimentManager initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.drift_detector: [] DriftDetector initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.precision_recall: [] PrecisionRecallCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.latency_calculator: [] LatencyCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.throughput_calculator: [] ThroughputCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.metrics_calculator: [] MetricsCalculator initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.replay_engine: [] ReplayEngine initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.explainer: [] Explainer initialized with SNOWFLAKE provider\
2025-11-14 08:08:25,142 [INFO] app.service.analytics.pipeline_monitor: [] PipelineMonitor initialized with SNOWFLAKE provider\
[API_ROUTER] Analytics router imported: prefix=/analytics, routes=51\
2025-11-14 08:08:25,680 [INFO] app.router.api_router: [] Analytics router imported successfully, prefix: /analytics, routes: 51\
[API_ROUTER] \uc0\u9989  Analytics router included successfully\
2025-11-14 08:08:25,693 [INFO] app.router.api_router: [] \uc0\u9989  Analytics router included successfully with prefix: /analytics\
2025-11-14 08:08:25,761 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: [] \uc0\u9989  Migration utilities loaded - backward compatibility maintained\
2025-11-14 08:08:25,761 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: []    All original functionality preserved through new modular system\
2025-11-14 08:08:25,761 [INFO] app.service.agent.orchestration.hybrid.migration_utilities: []    Components: Feature flags, graph selection, rollback, integration\
2025-11-14 08:08:25,761 [INFO] app.service.agent.orchestration.hybrid.observability.counters: [] \uc0\u55357 \u56522  Initialized 25 observability counters\
2025-11-14 08:08:25,761 [INFO] app.service.agent.tools.tool_registry: [] Splunk tool registered (enabled via USE_SPLUNK=true)\
2025-11-14 08:08:25,761 [INFO] app.service.agent.tools.tool_registry: [] SumoLogic tool registered (enabled via USE_SUMO_LOGIC=true)\
2025-11-14 08:08:25,761 [INFO] app.service.agent.tools.tool_registry: [] Snowflake tool registered (enabled via USE_SNOWFLAKE=true)\
2025-11-14 08:08:25,776 [INFO] app.service.agent.tools.tool_registry: [] Anomaly detection tools registered (fetch_series, detect_anomalies, list_anomalies, open_investigation, attach_evidence, segment_hunter, entity_extractor, anomaly_correlator)\
2025-11-14 08:08:25,778 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register device fingerprint tool: "DeviceFingerprintTool" object has no field "signal_processor"\
2025-11-14 08:08:25,782 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register MaxMind minFraud tool: "MaxMindMinFraudTool" object has no field "maxmind_client"\
2025-11-14 08:08:25,783 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register Composio tool: COMPOSIO_API_KEY not configured. Set environment variable or configure secret.\
2025-11-14 08:08:25,874 [INFO] app.service.graph.graph_client_abstraction: [] No graph provider configured, defaulting to Neo4j\
2025-11-14 08:08:25,874 [WARNING] app.service.graph.neo4j_client: [] Neo4j credentials not configured\
2025-11-14 08:08:25,874 [WARNING] app.service.graph.graph_client_abstraction: [] Neo4j not available, graph operations will fail gracefully\
2025-11-14 08:08:25,876 [WARNING] app.service.agent.tools.tool_registry: [] Failed to register graph feature tool: "GraphFeatureTool" object has no field "feature_computer"\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] AbuseIPDB IP reputation tool registered\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal IP analysis tool registered\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal domain analysis tool registered\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal file analysis tool registered\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] VirusTotal URL analysis tool registered\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] Shodan infrastructure analysis tool registered\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] Shodan search tool registered\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] MCP servers disabled - skipping MCP server tool registration\
2025-11-14 08:08:25,876 [INFO] app.service.agent.tools.tool_registry: [] Tool registry initialized with 18 tools\
2025-11-14 08:08:25,876 [INFO] app.router.mcp_bridge_router: [] MCP bridge initialized with tools\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)\
2025-11-14 08:08:25,903 [INFO] app.test.data.mock_transactions.mock_data_loader: [] Initialized MockDataLoader with base path: /Users/gklainert/Documents/olorin/olorin-server/app/test/data/mock_transactions\
/Users/gklainert/Documents/olorin/olorin-server/app/router/autonomous_investigation_router.py:312: DeprecationWarning: `example` has been deprecated, please use `examples` instead\
  investigation_id: str = Path(description="Unique investigation identifier", example="multi_a1b2c3d4")\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1093: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn(\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)\
2025-11-14 08:08:26,216 [INFO] app.service.router.router_config: [] All core routers have been included (WebSocket disabled)\
2025-11-14 08:08:26,216 [INFO] app.service.router.router_config: [] Error handlers registered\
2025-11-14 08:08:26,216 [INFO] app.service.router.router_config: [] pskhealth not available, using enhanced health router\
2025-11-14 08:08:26,216 [INFO] app.service.router.router_config: [] App metrics exposed\
2025-11-14 08:08:26,217 [INFO] uvicorn.error: [] Started server process [87451]\
2025-11-14 08:08:26,217 [INFO] uvicorn.error: [] Waiting for application startup.\
2025-11-14 08:08:26,217 [INFO] app.service: [] \uc0\u55357 \u56960  Starting Olorin application...\
2025-11-14 08:08:26,217 [INFO] app.service: [] \uc0\u55357 \u56615  Validating log stream configuration...\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/pydantic/fields.py:1093: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/\
  warn(\
2025-11-14 08:08:26,249 [ERROR] app.config.logstream_validator: [] \uc0\u10060  LOG STREAM CONFIGURATION VALIDATION FAILED\
\
Missing or invalid environment variables:\
\
  \uc0\u10060  frontend_log_endpoint:\
     Field required\
\
  \uc0\u10060  backend_log_endpoint:\
     Field required\
\
  \uc0\u10060  provider_timeout_ms:\
     Field required\
\
\
Please set all required LOGSTREAM_* environment variables.\
See app/config/logstream_config.py for required configuration.\
2025-11-14 08:08:26,249 [ERROR] app.service: [] \uc0\u10060  Log stream configuration validation failed: \u10060  LOG STREAM CONFIGURATION VALIDATION FAILED\
\
Missing or invalid environment variables:\
\
  \uc0\u10060  frontend_log_endpoint:\
     Field required\
\
  \uc0\u10060  backend_log_endpoint:\
     Field required\
\
  \uc0\u10060  provider_timeout_ms:\
     Field required\
\
\
Please set all required LOGSTREAM_* environment variables.\
See app/config/logstream_config.py for required configuration.\
2025-11-14 08:08:26,249 [ERROR] app.service: []    Set SKIP_LOGSTREAM_VALIDATION=true to continue startup without log streaming\
2025-11-14 08:08:26,249 [INFO] app.service: [] \uc0\u55357 \u56772 \u65039  Initializing database...\
2025-11-14 08:08:26,257 [INFO] app.persistence.database: [] Database initialized with URL: sqlite:///./olorin_test.db\
2025-11-14 08:08:26,262 [INFO] app.persistence.database: [] Database tables created\
2025-11-14 08:08:26,262 [INFO] app.service: [] \uc0\u9989  Database tables creation attempted\
2025-11-14 08:08:26,262 [INFO] app.service: [] \uc0\u55357 \u56589  Verifying required tables...\
2025-11-14 08:08:26,263 [INFO] app.service: [] \uc0\u9989  All required tables verified: \{'detectors', 'detection_runs', 'anomaly_events', 'investigation_states'\}\
2025-11-14 08:08:26,263 [INFO] app.service: [] \uc0\u55357 \u56589  Verifying database indexes...\
2025-11-14 08:08:26,263 [INFO] app.service: [] \uc0\u55357 \u56589  Checking for database configuration issues...\
2025-11-14 08:08:26,263 [INFO] app.service: [] \uc0\u9989  Using SQLite for investigation state management\
2025-11-14 08:08:26,263 [INFO] app.service: []    Database path: sqlite:///./olorin_test.db\
2025-11-14 08:08:26,263 [INFO] app.service: [] \uc0\u55357 \u56580  Running database migrations...\
[2025-11-14T08:08:26-0500] INFO [] module=runner: Skipping Snowflake-specific migration 002_add_experiments_tables.sql (database type: sqlite)\
[2025-11-14T08:08:26-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:08:26-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 006_add_transaction_windows_view.sql (database type: sqlite)\
[2025-11-14T08:08:26-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_device_signals.sql (database type: sqlite)\
[2025-11-14T08:08:26-0500] INFO [] module=runner: Skipping Snowflake-specific migration 008_create_dynamic_tables.sql (database type: sqlite)\
[2025-11-14T08:08:26-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:08:26-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_graph_features.sql (database type: sqlite)\
[2025-11-14T08:08:26-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 008_create_ip_risk_scores.sql (database type: sqlite)\
[2025-11-14T08:08:26-0500] INFO [] module=runner: Skipping Snowflake-specific migration 008_create_snowpipe_tables.sql (database type: sqlite)\
[2025-11-14T08:08:26-0500] INFO [] module=runner:   Note: Snowflake migrations must be run separately against Snowflake database\
[2025-11-14T08:08:26-0500] INFO [] module=runner: Skipping PostgreSQL-specific migration 009_create_device_features_view.sql (database type: sqlite)\
2025-11-14 08:08:26,275 [INFO] app.service: [] \uc0\u9989  Database migrations completed successfully\
2025-11-14 08:08:26,275 [INFO] app.service: [] \uc0\u55357 \u56588  Initializing database provider...\
2025-11-14 08:08:26,276 [INFO] app.service: [] \uc0\u9989  Database provider initialized: SnowflakeProvider\
2025-11-14 08:08:26,276 [INFO] app.service: [] \uc0\u9989  Database connection established: SnowflakeProvider\
2025-11-14 08:08:26,276 [INFO] app.service: [] \uc0\u55357 \u56589  Validating database schema parity...\
2025-11-14 08:08:26,276 [INFO] app.service: [] \uc0\u8505 \u65039  Schema validation skipped (using Snowflake as source of truth)\
2025-11-14 08:08:26,276 [INFO] app.service.performance.performance_manager: [] Starting Olorin application with performance optimizations...\
2025-11-14 08:08:26,284 [INFO] app.service.performance.performance_manager: [] \uc0\u10003  Performance optimization system initialized successfully\
2025-11-14 08:08:26,284 [INFO] app.service.performance.performance_manager: [] Performance targets:\
2025-11-14 08:08:26,284 [INFO] app.service.performance.performance_manager: []   - api_latency: -40% improvement target\
2025-11-14 08:08:26,284 [INFO] app.service.performance.performance_manager: []   - agent_execution: -50% improvement target\
2025-11-14 08:08:26,284 [INFO] app.service.performance.performance_manager: []   - cache_hit_rate: +200% improvement target\
2025-11-14 08:08:26,284 [INFO] app.service.performance.performance_manager: []   - memory_usage: -25% improvement target\
2025-11-14 08:08:26,284 [INFO] app.service.performance.performance_manager: []   - throughput: +100% improvement target\
2025-11-14 08:08:26,284 [INFO] app.service: [] \uc0\u55358 \u56598  Initializing agent system...\
2025-11-14 08:08:26,288 [INFO] app.service.agent.agent_factory: [] RAG modules loaded successfully\
2025-11-14 08:08:26,295 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'utility'], tool_names: None\
2025-11-14 08:08:26,295 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:26,295 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:26,295 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'utility'], specific: None)\
2025-11-14 08:08:26,296 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:26,296 [INFO] app.service.agent.agent: [] Initialized 18 tools for structured agents (including 5 threat intelligence tools, 3 database tools)\
2025-11-14 08:08:26,297 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 08:08:26,297 [INFO] app.service.agent.recursion_guard: [] Initialized global RecursionGuard\
2025-11-14 08:08:26,297 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 08:08:26,320 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:08:26,320 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:26,320 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:26,320 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:08:26,320 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:26,320 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:08:26,320 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:08:26,320 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:08:26,321 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:08:26,321 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:08:26,323 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:08:26,334 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 08:08:26,335 [INFO] app.service.agent_init: [] \uc0\u9989  Parallel graph initialized\
2025-11-14 08:08:26,335 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=False, enhanced_tools=True, subgraphs=False\
2025-11-14 08:08:26,335 [INFO] app.service.agent.orchestration.graph_builder: [] Creating sequential graph with controlled agent execution\
2025-11-14 08:08:26,357 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:08:26,357 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:26,357 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:26,358 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:08:26,358 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:26,358 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:08:26,358 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:08:26,358 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:08:26,358 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:08:26,358 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:08:26,360 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:08:26,363 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Sequential agent graph compiled successfully\
2025-11-14 08:08:26,363 [INFO] app.service.agent_init: [] \uc0\u9989  Sequential graph initialized\
2025-11-14 08:08:26,363 [INFO] app.service.agent_init: [] \uc0\u9989  At least one agent graph initialized\
2025-11-14 08:08:26,363 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:08:26,363 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:08:26,363 [INFO] app.service.agent.orchestration.hybrid.migration.feature_flags.environment_loader: [] \uc0\u55357 \u57001  Environment override: hybrid_graph_v1 enabled via HYBRID_FLAG_HYBRID_GRAPH_V1\
2025-11-14 08:08:26,363 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager initialized\
2025-11-14 08:08:26,363 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Feature flags: 7 flags\
2025-11-14 08:08:26,363 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Components: All migration and integration components loaded\
2025-11-14 08:08:26,363 [INFO] app.service.agent_init: [] \uc0\u55358 \u56800  Hybrid Intelligence Graph system initialized\
2025-11-14 08:08:26,363 [INFO] app.service.agent_init: [] \uc0\u55357 \u57001  Feature flags status:\
2025-11-14 08:08:26,363 [INFO] app.service.agent_init: []    hybrid_graph_v1: \uc0\u9989  (100% rollout)\
2025-11-14 08:08:26,363 [INFO] app.service.agent_init: []    ai_confidence_engine: \uc0\u9989  (100% rollout)\
2025-11-14 08:08:26,363 [INFO] app.service.agent_init: []    ab_test_hybrid_vs_clean: \uc0\u10060  (0% rollout)\
2025-11-14 08:08:26,364 [INFO] app.service: [] \uc0\u9989  Agent system initialized successfully\
2025-11-14 08:08:26,364 [INFO] app.service: [] \uc0\u55357 \u56960  Initializing RAG system...\
2025-11-14 08:08:26,365 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56960  Initializing PostgreSQL + pgvector RAG system...\
2025-11-14 08:08:26,367 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56522  Initializing SQLite database for RAG...\
2025-11-14 08:08:26,368 [INFO] app.service.database.vector_database_config: [] SQLite engine initialized\
2025-11-14 08:08:26,369 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG database tables created/verified\
2025-11-14 08:08:26,369 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  SQLite vector database initialized successfully\
2025-11-14 08:08:26,369 [INFO] app.service.rag.startup_integration: [] \uc0\u55358 \u56800  Initializing embedding service...\
2025-11-14 08:08:26,381 [INFO] app.service.rag.embedding_service: [] OpenAI embedding provider initialized\
2025-11-14 08:08:26,405 [WARNING] app.service.rag.embedding_service: [] HuggingFace provider not available: dlopen(/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/_C.cpython-311-darwin.so, 0x0002): Library not loaded: @loader_path/libtorch_cpu.dylib\
  Referenced from: <93B052AD-B16C-3D0F-A6FC-DFFBB7CD9584> /Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/lib/libtorch_python.dylib\
  Reason: tried: '/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/torch/lib/libtorch_cpu.dylib' (no such file), '/usr/local/lib/libtorch_cpu.dylib' (no such file), '/usr/lib/libtorch_cpu.dylib' (no such file, not in dyld cache)\
2025-11-14 08:08:26,405 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Embedding service initialized with providers: openai\
2025-11-14 08:08:26,405 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56538  Initializing enhanced knowledge base...\
2025-11-14 08:08:26,405 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u55357 \u56960  Initializing Enhanced Knowledge Base...\
2025-11-14 08:08:26,419 [INFO] app.service.rag.enhanced_knowledge_base: [] Found 4 empty collections - consider populating with domain knowledge\
2025-11-14 08:08:26,420 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u9989  Enhanced Knowledge Base initialized successfully\
2025-11-14 08:08:26,420 [INFO] app.service.rag.enhanced_knowledge_base: [] \uc0\u9989  Enhanced Knowledge Base ready for fraud investigations\
2025-11-14 08:08:26,420 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Enhanced knowledge base initialized successfully\
2025-11-14 08:08:26,420 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56589  Performing RAG system health check...\
2025-11-14 08:08:26,421 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56520  RAG health check: 5 collections available\
2025-11-14 08:08:26,422 [WARNING] app.service.rag.startup_integration: [] Failed to create default data source: Instance <RAGDataSource at 0x14b877310> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)\
2025-11-14 08:08:26,422 [INFO] app.service.rag.startup_integration: [] \uc0\u55357 \u56522  RAG system status: \{'database': True, 'embeddings': True, 'knowledge_base': True, 'overall': True\}\
2025-11-14 08:08:26,422 [INFO] app.service.rag.investigation_indexing_background: [] Started investigation indexing background service (poll interval: 60s)\
2025-11-14 08:08:26,422 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  Background investigation indexing started\
2025-11-14 08:08:26,422 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG system initialization completed successfully\
2025-11-14 08:08:26,422 [INFO] app.service: [] \uc0\u9989  RAG system initialized successfully\
2025-11-14 08:08:26,422 [INFO] app.service: [] \uc0\u55357 \u56580  Scheduling background task to load top risk entities from Snowflake...\
2025-11-14 08:08:26,422 [INFO] app.service: [] \uc0\u9989  Background task scheduled - server will start without waiting for risk entities\
2025-11-14 08:08:26,422 [INFO] app.service: [] \uc0\u55357 \u56589  Validating anomaly detection configuration...\
2025-11-14 08:08:26,456 [INFO] app.service: [] \uc0\u9989  Anomaly detection configuration validated successfully\
2025-11-14 08:08:26,456 [INFO] app.service: [] \uc0\u9200  Initializing detection scheduler...\
2025-11-14 08:08:26,488 [INFO] app.service.anomaly.scheduler: [] Detection scheduler initialized: enabled=True, default_interval=15 minutes\
2025-11-14 08:08:26,499 [INFO] app.service.anomaly.scheduler_jobs: [] Registered 12 detector jobs\
2025-11-14 08:08:26,499 [INFO] app.service.anomaly.scheduler: [] Detection scheduler started successfully\
2025-11-14 08:08:26,499 [INFO] app.service: [] \uc0\u9989  Detection scheduler started\
2025-11-14 08:08:26,499 [INFO] app.service: [] Olorin application startup completed\
2025-11-14 08:08:26,501 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:08:26,501 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:08:26,693 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:08:26,759 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:08:26,759 [INFO] app.service: [] \uc0\u55357 \u56523  Loading top risk entities from Snowflake (background task)...\
2025-11-14 08:08:26,759 [INFO] app.service: [] \uc0\u55357 \u56550  Importing risk analyzer...\
2025-11-14 08:08:26,759 [INFO] app.service: [] \uc0\u55356 \u57325  Creating risk analyzer instance...\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] RiskAnalyzer initialized with SNOWFLAKE provider\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] Risk Analyzer configured: time_window=7d, group_by=email, top=10.0%\
2025-11-14 08:08:26,759 [INFO] app.service: [] \uc0\u55357 \u56588  Attempting to connect to Snowflake and fetch top risk entities...\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56580  Starting risk analysis with params: time_window=7d, group_by=email, top_percentage=10.0\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9201 \u65039  Parsing time window: 7d\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9201 \u65039  Parsed to 168 hours\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56588  Connecting to SNOWFLAKE database...\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9989  SNOWFLAKE connection initialized (lazy connection)\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55356 \u57303 \u65039  Building risk query for email filtering...\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56589  Executing SNOWFLAKE query for email filtering:\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] Query: \
        WITH risk_calculations AS (\
            SELECT\
                EMAIL as entity,\
                COUNT(*) as transaction_count,\
                SUM(PAID_AMOUNT_VALUE_IN_CURRENCY) as total_amount,\
                AVG(MODEL_SCORE) as avg_risk_score,\
                SUM(MODEL_SCORE * PAID_AMOUNT_VALUE_IN_CURRENCY) * COUNT(*) as risk_weighted_value,\
                MAX(MODEL_SCORE) as max_risk_score,\
                MIN(MODEL_SCORE) as min_risk_score,\
                SUM(CASE WHEN IS_FRAUD_T...\
2025-11-14 08:08:26,759 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9889  Sending query to SNOWFLAKE...\
2025-11-14 08:08:26,760 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: WITH risk_calculations AS (\
            SELECT\
                EMAIL as entity,\
                COUNT(*) as transaction_count,\
                SUM(PAID_AMOUNT_VALUE_IN_CURRENCY) as total_amount,\
     ...\
2025-11-14 08:08:26,999 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:08:27,050 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:08:27,051 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:08:27-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:08:27-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:08:30,070 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:08:35,627 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 61695 rows\
2025-11-14 08:08:35,627 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 61695 rows returned\
2025-11-14 08:08:35,627 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56522  Query returned 61695 rows\
2025-11-14 08:08:35,767 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u9989  Risk analysis completed: 61695 entities identified (from 61695 query rows)\
2025-11-14 08:08:35,767 [INFO] app.service.analytics.risk_analyzer: [] \uc0\u55357 \u56522  Top 3 riskiest entities:\
2025-11-14 08:08:35,767 [INFO] app.service.analytics.risk_analyzer: []    1. Entity: meiling.soto.garrido@gmail.com | Transactions: 9 | Risk Score: 0.746\
2025-11-14 08:08:35,767 [INFO] app.service.analytics.risk_analyzer: []    2. Entity: moeller2media@gmail.com | Transactions: 20 | Risk Score: 0.393\
2025-11-14 08:08:35,767 [INFO] app.service.analytics.risk_analyzer: []    3. Entity: okuoku1959122@gmail.com | Transactions: 7 | Risk Score: 0.464\
2025-11-14 08:08:35,767 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:08:35,775 [INFO] app.service: [] \uc0\u55357 \u56522  Risk analyzer returned results: <class 'dict'> with keys: ['status', 'entities', 'summary', 'timestamp']\
2025-11-14 08:08:35,775 [INFO] app.service: [] \uc0\u9989  Successfully loaded 61695 top risk entities from Snowflake\
2025-11-14 08:08:35,775 [INFO] app.service: [] \uc0\u55357 \u56510  Stored risk entities in app state\
2025-11-14 08:08:35,775 [INFO] app.service: [] \uc0\u55357 \u56960  Starting automatic comparisons for top 3 riskiest entities...\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Starting auto-comparisons for top 3 riskiest entities\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: []    Entity type (from group_by): email\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Auto-Comparison 1/3\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: []    Entity: meiling.soto.garrido@gmail.com\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: []    Entity Type: email\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: []    Risk Score: 0.746\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: []    Transactions: 9\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 08:08:35,776 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Running auto-comparison for entity: email=meiling.soto.garrido@gmail.com\
2025-11-14 08:08:35,777 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Looking for historical investigations between 2025-05-18 and 2025-08-16\
2025-11-14 08:08:36,157 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  Investigation auto-comp-0b9764e8c40e is not completed (status: IN-PROGRESS), skipping...\
2025-11-14 08:08:36,157 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No historical investigation found - creating new investigation...\
2025-11-14 08:08:36,157 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-02T08:08:35.777009-05:00' AND TX_DATETIME < '2025-08-16T08:08:35.777009-05:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido...\
2025-11-14 08:08:36,940 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:08:36,941 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:08:36,941 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-16T08:08:35.777009-05:00' AND TX_DATETIME < '2025-11-14T08:08:35.777009-05:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido...\
2025-11-14 08:08:40,692 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:08:40,692 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:08:40,692 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found in desired historical window (2025-08-02 to 2025-08-16)\
2025-11-14 08:08:40,692 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Finding actual transaction date range for email=meiling.soto.garrido@gmail.com...\
2025-11-14 08:08:40,693 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
                MIN(TX_DATETIME) as earliest_date,\
                MAX(TX_DATETIME) as latest_date,\
                COUNT(*) as tx_count\
            FROM DBT.DBT_PROD.TXS\
            WHERE TX_...\
2025-11-14 08:08:46,875 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:08:46,875 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:08:46,875 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email=meiling.soto.garrido@gmail.com in last 180 days\
2025-11-14 08:08:46,875 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating historical investigation:\
2025-11-14 08:08:46,875 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-08-02 to 2025-08-16\
2025-11-14 08:08:46,875 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating investigation auto-comp-fa5c5cc6cfea for email=meiling.soto.garrido@gmail.com\
2025-11-14 08:08:46,875 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-08-02 to 2025-08-16\
2025-11-14 08:08:46,884 [INFO] app.service.investigation_trigger_service: [] Extracted structured investigation request for auto-comp-fa5c5cc6cfea: entity_id=meiling.soto.garrido@gmail.com, entity_type=email\
2025-11-14 08:08:46,884 [INFO] app.service.investigation_trigger_service: [] Initialized progress_json for investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,886 [INFO] app.service.investigation_trigger_service: [] State update verification for auto-comp-fa5c5cc6cfea: lifecycle_stage=IN_PROGRESS, status=IN_PROGRESS, version=2, progress_json_initialized=True\
2025-11-14 08:08:46,887 [INFO] app.service.investigation_trigger_service: [] Updated investigation auto-comp-fa5c5cc6cfea state to IN_PROGRESS (version 1 -> 2)\
2025-11-14 08:08:46,887 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Triggering investigation execution for auto-comp-fa5c5cc6cfea...\
2025-11-14 08:08:46,887 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Investigation auto-comp-fa5c5cc6cfea created and execution triggered, waiting for completion...\
2025-11-14 08:08:46,887 [INFO] uvicorn.error: [] Application startup complete.\
2025-11-14 08:08:46,888 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9881 \u65039  BACKGROUND TASK STARTED: execute_structured_investigation for auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,888 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960 \u55357 \u56960 \u55357 \u56960  STARTING BACKGROUND INVESTIGATION: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,889 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-fa5c5cc6cfea already in IN_PROGRESS status\
2025-11-14 08:08:46,889 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960  STARTING REAL AUTONOMOUS INVESTIGATION: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,889 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verified entity information: email=meiling.soto.garrido@gmail.com...\
2025-11-14 08:08:46,889 [INFO] app.service.agent.recursion_guard: [] Created execution context for investigation auto-comp-fa5c5cc6cfea, thread auto-comp-fa5c5cc6cfea-None\
2025-11-14 08:08:46,889 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u57057 \u65039  Created RecursionGuard context for investigation auto-comp-fa5c5cc6cfea with thread_id auto-comp-fa5c5cc6cfea-None\
2025-11-14 08:08:46,889 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verification complete - execution can proceed for auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,889 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-fa5c5cc6cfea already in IN_PROGRESS status\
2025-11-14 08:08:46,891 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-fa5c5cc6cfea: \{'status': 'in_progress', 'current_phase': 'agent_initialization'\}\
2025-11-14 08:08:46,892 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_initialization\
2025-11-14 08:08:46,892 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 0% | Phases: 0 completed\
2025-11-14 08:08:46,892 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_initialization\
2025-11-14 08:08:46,892 [WARNING] app.service.agent.journey_tracker: [] No active journey for investigation: auto-comp-fa5c5cc6cfea. Creating emergency journey for node tracking.\
2025-11-14 08:08:46,892 [INFO] app.service.agent.journey_tracker: [] Started journey tracking for investigation: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,895 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-fa5c5cc6cfea: \{'current_phase': 'agent_initialization', 'progress_percentage': 5.0, 'status': 'in_progress'\}\
2025-11-14 08:08:46,895 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55357 \u56615  Creating REAL LangGraph agent system for auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,895 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 08:08:46,895 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 08:08:46,918 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:08:46,918 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:46,918 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:46,918 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:08:46,918 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:46,918 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:08:46,918 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:08:46,918 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:08:46,919 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:08:46,919 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:08:46,921 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:08:46,924 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 08:08:46,924 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  context_preparation\
2025-11-14 08:08:46,924 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 25% | Phases: 1 completed\
2025-11-14 08:08:46,924 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: context_preparation\
2025-11-14 08:08:46,930 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-fa5c5cc6cfea: \{'current_phase': 'context_preparation', 'progress_percentage': 15.0\}\
2025-11-14 08:08:46,930 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55358 \u56800  Creating REAL agent context for auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,930 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56589  EXECUTING REAL AGENT INVESTIGATION: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,930 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_execution\
2025-11-14 08:08:46,930 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 50% | Phases: 2 completed\
2025-11-14 08:08:46,930 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_execution\
2025-11-14 08:08:46,932 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-fa5c5cc6cfea: \{'current_phase': 'agent_execution', 'progress_percentage': 25.0\}\
2025-11-14 08:08:46,933 [INFO] app.router.controllers.investigation_agent_tracking: [] \uc0\u55357 \u56523  ATTEMPTING TO LOG LLM INTERACTION FOR: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,933 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  LLM Call: MultiAgentOrchestrator \u8594  gpt-4o\
2025-11-14 08:08:46,933 [INFO] app.service.logging.autonomous_investigation_logger: []            Tools: langgraph_parallel_execution | Tokens: 124.80000000000001\
2025-11-14 08:08:46,933 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Initiating real structured investigation with Device, Location, Network, Logs, and Risk Analysis age...\
2025-11-14 08:08:46,933 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  Decision: DeviceAnalysisAgent \u8594  device_analysis_start\
2025-11-14 08:08:46,933 [INFO] app.service.logging.autonomous_investigation_logger: []            Confidence: 95.00 | Outcome: N/A\
2025-11-14 08:08:46,933 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Analyzing device fingerprint inconsistencies and spoofing indicators\
2025-11-14 08:08:46,934 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56598  INVOKING REAL AGENTS: Device, Location, Network, Logs, Risk Analysis\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager: Getting investigation graph\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Investigation: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u55357 \u56599  Service adapter: Getting investigation graph\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Investigation: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Entity type: email\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: [] \uc0\u55356 \u57263  Selecting investigation graph with typed results\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Investigation: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Entity type: email\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Fallback counter: 0\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    \uc0\u55358 \u56800  Hybrid intelligence graph selected\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u55357 \u56580  LEGACY: Initializing HybridGraphBuilder wrapper (intelligence_mode: adaptive, llm=None)\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u9989  Delegating to new modular hybrid intelligence system\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55357 \u56550  Using 14 focused components for improved maintainability\
2025-11-14 08:08:46,934 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55356 \u57261  DEMO MODE: Using rule-based heuristics (no API costs)\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_builders: [] \uc0\u55357 \u56615  Hybrid graph streaming: enabled\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u55357 \u56580  LEGACY: build_hybrid_investigation_graph called\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u10145 \u65039  Delegating to modular graph builder\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55357 \u56522  Parameters: enhanced_tools=True, streaming=True, interrupts=False, investigation_id=auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Building hybrid intelligence graph\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Enhanced tools: True\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Streaming enabled: True\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Creating hybrid intelligence graph foundation\
2025-11-14 08:08:46,935 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:08:46,937 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], tool_names: None\
2025-11-14 08:08:46,937 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:46,937 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:46,938 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], specific: None)\
2025-11-14 08:08:46,938 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:46,938 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56550  Loaded 18 tools for hybrid investigation\
2025-11-14 08:08:46,938 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u9989  [Hybrid] Using EnhancedToolNode with 18 tools and persistence enabled\
2025-11-14 08:08:46,938 [INFO] app.service.agent.orchestration.hybrid.graph.builders.node_factory: [] \uc0\u55356 \u57303 \u65039  Node factory completed: 16 nodes created\
2025-11-14 08:08:46,939 [INFO] app.service.agent.orchestration.hybrid.graph.builders.memory_provider: [] \uc0\u55357 \u57057 \u65039  Using in-memory storage for hybrid graph (Redis checkpoint unavailable)\
2025-11-14 08:08:46,977 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u9989  Hybrid intelligence graph compiled successfully\
2025-11-14 08:08:46,977 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Nodes: 19\
2025-11-14 08:08:46,978 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:08:46,978 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u9989  LEGACY: Graph building delegated successfully\
2025-11-14 08:08:46,978 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57263  100% backward compatibility maintained\
2025-11-14 08:08:46,978 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57303 \u65039  Using modular architecture with 14 components\
2025-11-14 08:08:46,978 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u9989  Investigation graph ready: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,978 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u9989  Investigation graph ready: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,978 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56800  Using Hybrid Intelligence graph for investigation: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,978 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56960  EXECUTING CLEAN GRAPH ORCHESTRATION (replacing old agent service)\
2025-11-14 08:08:46,989 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56615  Enhanced Tool Execution Logger initialized for investigation: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,989 [INFO] app.service.agent.orchestration.investigation_coordinator: [] \uc0\u55357 \u56613  START_INVESTIGATION FUNCTION CALLED \u55357 \u56613 \
2025-11-14 08:08:46,989 [INFO] app.service.agent.orchestration.investigation_coordinator: [] [start_investigation] initiating fraud investigation flow\
2025-11-14 08:08:46,989 [INFO] app.service.agent.orchestration.investigation_coordinator: [] [start_investigation] Using hybrid state structure - extracting from state\
2025-11-14 08:08:46,989 [INFO] app.service.agent.orchestration.investigation_coordinator: [] \uc0\u55357 \u56589  Hybrid state parameters: entity_id=meiling.soto.garrido@gmail.com, entity_type=email, investigation_id=auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,989 [INFO] app.service.agent.orchestration.investigation_coordinator: [] Set investigation context for auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,989 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u9989  Hybrid investigation started: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:46,989 [INFO] uvicorn.access: [] 127.0.0.1:57599 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:08:46,991 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Starting data retrieval\
2025-11-14 08:08:46,991 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Entity=meiling.soto.garrido@gmail.com (type: email)\
2025-11-14 08:08:46,991 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: SnowflakeProvider provider initialized\
2025-11-14 08:08:46,992 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Executing query for email=meiling.soto.garrido@gmail.com (column: EMAIL)\
2025-11-14 08:08:46,992 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT\
                        TX_ID_KEY,\
                        EMAIL,\
                        IP,\
                        PAID_AMOUNT_VALUE_IN_CURRENCY,\
                        PAID_AMOUNT_CURRENCY...\
2025-11-14 08:08:47,159 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 24 rows\
2025-11-14 08:08:47,159 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 24 rows returned\
2025-11-14 08:08:47,159 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u9989  DATABASE FETCH: Retrieved 24 transactions (query limit: 2000, matched: 24 for email=meiling.soto.garrido@gmail.com)\
2025-11-14 08:08:47,159 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Tracked as tool usage (total tools: 1)\
2025-11-14 08:08:47,162 [INFO] app.service.etag_service: [investigation_id=901cef9a-1eca-4099-8857-e3458508e9f7, olorin_tid=a543c6db-cad8-44c2-a184-1d9adae7f291] etag_retrieved\
2025-11-14 08:08:47,163 [CRITICAL] app.service.agent.orchestration.enhanced_routing: [] \uc0\u55357 \u56613  DEBUGGING: raw_data_or_investigation_routing CALLED\
2025-11-14 08:08:47,163 [CRITICAL] app.service.agent.orchestration.enhanced_routing: [] \uc0\u55357 \u56613  DEBUGGING: Investigation ID: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:47,163 [INFO] app.service.agent.orchestration.enhanced_routing: [] Determining investigation routing: raw data vs standard flow\
2025-11-14 08:08:47,163 [INFO] app.service.agent.orchestration.enhanced_routing: [] Database transaction data detected (24 rows from snowflake) - routing to standard fraud investigation (CSV data not found in messages)\
2025-11-14 08:08:47,164 [INFO] uvicorn.access: [] 127.0.0.1:57599 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:08:47,166 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: [] \uc0\u55358 \u56800  Hybrid-aware assistant preparing LLM context with AI recommendations\
2025-11-14 08:08:47,166 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: []    \uc0\u55358 \u56598  Running LLM with AI guidance context\
2025-11-14 08:08:47,166 [WARNING] app.service.llm_manager: [] Invalid selected model: gpt-4o, defaulting to gpt-5-mini\
2025-11-14 08:08:47,166 [INFO] app.service.llm_manager: [] LLM Manager configured: selected=gpt-5-mini, verification=claude-haiku-4-5\
2025-11-14 08:08:47,166 [INFO] app.service.llm_manager: [] \uc0\u55357 \u56960  Using GPT-5 Responses API for GPT-5 Mini\
2025-11-14 08:08:47,172 [INFO] app.service.llm_manager: [] \uc0\u9989  GPT-5 Responses API wrapper initialized (model: gpt-5-mini)\
2025-11-14 08:08:47,173 [INFO] app.service.agent.verification.verification_config: [] \uc0\u55357 \u56615  Verification configuration initialized - Enabled: True\
2025-11-14 08:08:47,173 [INFO] app.service.agent.verification.verification_models: [] \uc0\u55358 \u56598  Initializing verification models manager\
2025-11-14 08:08:47,173 [INFO] app.service.agent.verification.verification_models: [] \uc0\u9989  Initialized verification model: claude-haiku-4-5\
2025-11-14 08:08:47,333 [INFO] app.service.agent.verification.verification_models: [] \uc0\u9989  Initialized verification model: gpt-3.5-turbo\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_models: [] \uc0\u9989  Initialized verification model: gpt-4o-mini\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_models: [] \uc0\u55356 \u57263  Successfully initialized 3 verification models\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_cache: [] \uc0\u55357 \u56772 \u65039   Verification cache initialized - Enabled: True\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_logger: [] \uc0\u55357 \u56541  Verification logger initialized\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_metrics: [] \uc0\u55357 \u56522  Verification metrics system initialized\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.iterative_improver: [] \uc0\u55357 \u56580  Iterative improver initialized\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_service: [] \uc0\u55357 \u56589  LLM Verification Service initialized - ID: 7340e260\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_service: []    Enabled: True\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_service: []    Primary Model: claude-haiku-4-5\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_service: []    Cache Enabled: True\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_service: []    Max Retries: 3\
2025-11-14 08:08:47,346 [INFO] app.service.agent.verification.verification_service: []    Available Models: ['claude-haiku-4-5', 'gpt-3.5-turbo', 'gpt-4o-mini']\
2025-11-14 08:08:47,346 [INFO] app.service.llm_manager: [] LLM Verification System enabled\
2025-11-14 08:08:47,369 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:08:47,370 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:08:47,370 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:08:47,370 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:08:47,370 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:08:47,370 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:08:47,370 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:08:47,370 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:08:47,370 [INFO] app.service.llm_manager: [] \uc0\u55357 \u56580  bind_tools called on GPT-5 Responses API wrapper - falling back to Chat Completions API for tool support\
2025-11-14 08:08:47,370 [INFO] app.service.llm_manager: []    Tools to bind: 18\
2025-11-14 08:08:47,416 [INFO] app.service.agent.orchestration.assistant: [] \uc0\u9989  Created investigation-context-aware system message for email=meiling.soto.garrido@gmail.com\
2025-11-14 08:08:47,416 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u57057 \u65039  LLM Resilience Configuration:\
2025-11-14 08:08:47,416 [INFO] app.service.agent.orchestration.llm_resilience: []    Timeout: 60s\
2025-11-14 08:08:47,416 [INFO] app.service.agent.orchestration.llm_resilience: []    Max Retries: 3\
2025-11-14 08:08:47,416 [INFO] app.service.agent.orchestration.llm_resilience: []    Initial Retry Delay: 1.0s\
2025-11-14 08:08:47,416 [INFO] app.service.agent.orchestration.llm_resilience: []    Backoff Multiplier: 2.0x\
2025-11-14 08:08:47,416 [INFO] app.service.agent.orchestration.llm_resilience: []    Max Retry Delay: 30.0s\
2025-11-14 08:08:47,416 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 1/4\
[2025-11-14T08:08:53-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"\
2025-11-14 08:08:53,257 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u9989   LLM Invocation Successful: Attempt=1, Duration=5.84s, Total=5.84s\
2025-11-14 08:08:53,257 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56522   LLM Metadata: Model=gpt-5-mini-2025-08-07, InputTokens=3586, OutputTokens=322, TotalTokens=3908, Latency=5841ms\
2025-11-14 08:08:53,257 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: [] \uc0\u9989  Hybrid-aware assistant completed with LLM guidance\
2025-11-14 08:08:53,258 [INFO] app.service.agent.orchestration.hybrid.graph.builders.edge_configurator: [] \uc0\u9989  Tool calls detected: 1 tools\
2025-11-14 08:08:53,259 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  EnhancedToolNode.ainvoke called with input type: <class 'dict'>\
2025-11-14 08:08:53,259 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Input is dict with keys: ['messages', 'investigation_id', 'entity_id', 'entity_type', 'custom_user_prompt', 'current_phase', 'date_range_days', 'time_range', 'tool_count', 'snowflake_data', 'snowflake_completed', 'tools_used', 'tool_requests', 'tool_results', 'domain_findings', 'domains_completed', 'risk_score', 'risk_indicators', 'confidence_score', 'parallel_execution', 'max_tools', 'errors', 'retry_count', 'orchestrator_loops', 'tool_execution_attempts', 'phase_changes', 'routing_decisions', 'decision_audit_trail', 'start_time', 'end_time', 'total_duration_ms', 'agent_context', 'performance_metrics', 'hybrid_system_version', 'graph_selection_reason']\
2025-11-14 08:08:53,259 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  investigation_id found in input: auto-comp-fa5c5cc6cfea\
2025-11-14 08:08:53,259 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Extracted 3 messages from dict input\
2025-11-14 08:08:53,259 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Found 1 tool calls in AIMessage\
2025-11-14 08:08:53,259 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Executing tool 1/1: snowflake_query_tool (id: call_kguJDixCGQizAX9cM6qj2xKc)\
2025-11-14 08:08:53,260 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Inferred agent name from state: network_agent\
2025-11-14 08:08:53,260 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Attempting to persist tool execution: investigation_id=auto-comp-fa5c5cc6cfea, tool=snowflake_query_tool\
2025-11-14 08:08:53,261 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Getting database session for tool persistence\
2025-11-14 08:08:53,261 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Database session obtained, creating ToolExecutionService\
2025-11-14 08:08:53,261 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Persisting tool execution: investigation_id=auto-comp-fa5c5cc6cfea, agent_name=network_agent, tool_name=snowflake_query_tool, status=running\
2025-11-14 08:08:53,263 [INFO] app.service.tool_execution_service: [] Persisted tool execution 65edf354-012a-40dc-83ea-f19899c69cd4 for investigation auto-comp-fa5c5cc6cfea: network_agent/snowflake_query_tool - running\
2025-11-14 08:08:53,263 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  \u9989  Tool execution persisted successfully: 65edf354-012a-40dc-83ea-f19899c69cd4\
2025-11-14 08:08:53,263 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Mapping tool name 'snowflake_query_tool' -> 'database_query' (PostgreSQL mode)\
2025-11-14 08:08:53,264 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: [] \uc0\u55357 \u57056 \u65039  TOOL EXECUTION STARTED: snowflake_query_tool\
2025-11-14 08:08:53,264 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Execution ID: snowflake_query_tool_1763125733264\
2025-11-14 08:08:53,264 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Investigation: None\
2025-11-14 08:08:53,264 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Entity: unknown - unknown\
2025-11-14 08:08:53,264 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Attempt: 1/1\
2025-11-14 08:08:53,267 [INFO] app.utils.firebase_secrets: [] \uc0\u55357 \u56613  Attempting to retrieve secret via Firebase CLI...\
2025-11-14 08:08:53,267 [INFO] app.utils.firebase_secrets: []    Project: olorin-ai\
2025-11-14 08:08:53,267 [INFO] app.utils.firebase_secrets: []    Secret: SNOWFLAKE_PASSWORD\
2025-11-14 08:08:53,267 [INFO] app.utils.firebase_secrets: []    Command: firebase functions:secrets:access SNOWFLAKE_PASSWORD --project olorin-ai\
2025-11-14 08:08:53,267 [INFO] app.utils.firebase_secrets: []    Timeout: 30 seconds\
2025-11-14 08:08:53,267 [INFO] app.utils.firebase_secrets: []    This requires Firebase CLI and authentication...\
2025-11-14 08:08:55,661 [INFO] app.utils.firebase_secrets: [] Successfully retrieved latest version of secret 'SNOWFLAKE_PASSWORD' from Firebase\
2025-11-14 08:08:55,661 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u55357 \u56772 \u65039  Connecting to Snowflake...\
2025-11-14 08:08:55,661 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Account: olorin_fraud.snowflakecomputing.com\
2025-11-14 08:08:55,661 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    User: manual_review_agent_ro\
2025-11-14 08:08:55,661 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Database: DBT\
2025-11-14 08:08:55,661 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Schema: DBT_PROD\
2025-11-14 08:08:55,661 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Warehouse: FRAUD_ANALYSIS_WH\
2025-11-14 08:08:55,662 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:08:55,713 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:08:55,714 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:08:55-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:08:55-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
2025-11-14 08:08:55,817 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
^[[A/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:08:58,133 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:08:58,134 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u9989  Snowflake connection established successfully\
2025-11-14 08:08:58,134 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u55357 \u56589  Executing Snowflake query...\
2025-11-14 08:08:58,134 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT * FROM DBT.DBT_PROD.TXS\
WHERE EMAIL = 'meiling.soto.garrido@gmail.com'\
AND TX_DATETIME BETWEEN '2025-08-02T08:08:35.777009-05:00' AND '2025-08-16T08:08:35.777009-05:00'\
ORDER BY TX_DATETIME DES...\
2025-11-14 08:09:00,823 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:09:01,771 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 0 rows\
2025-11-14 08:09:01,771 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u9989  Snowflake query completed successfully\
2025-11-14 08:09:01,771 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Duration: 8507ms\
2025-11-14 08:09:01,771 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Rows returned: 0\
2025-11-14 08:09:01,771 [WARNING] app.service.agent.orchestration.enhanced_tool_execution_logger: [] \uc0\u55357 \u56557  TOOL RETURNED EMPTY RESULT: snowflake_query_tool\
2025-11-14 08:09:01,771 [WARNING] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Execution ID: snowflake_query_tool_1763125733264\
2025-11-14 08:09:01,771 [WARNING] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Reason: no_data_found\
2025-11-14 08:09:01,771 [WARNING] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Context: \{\
  "query": "SELECT * FROM DBT.DBT_PROD.TXS\\nWHERE EMAIL = 'meiling.soto.garrido@gmail.com'\\nAND TX_DATETIME BETWEEN '2025-08-02T08:08:35.777009-05:00' AND '2025-08-16T08:08:35.777009-05:00'\\nORDER BY TX_DATETIME DES...",\
  "database": "DBT",\
  "schema": "DBT_PROD",\
  "limit": 2000,\
  "execution_duration_ms": 8507\
\}\
2025-11-14 08:09:01,771 [WARNING] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Explanation: Query returned no matching records\
2025-11-14 08:09:01,772 [WARNING] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u55357 \u56557  Snowflake query returned empty results\
2025-11-14 08:09:01,772 [WARNING] app.service.agent.tools.snowflake_tool.snowflake_tool: []    This could indicate:\
2025-11-14 08:09:01,772 [WARNING] app.service.agent.tools.snowflake_tool.snowflake_tool: []    - No data matches the query criteria\
2025-11-14 08:09:01,772 [WARNING] app.service.agent.tools.snowflake_tool.snowflake_tool: []    - Date/time filters are too restrictive\
2025-11-14 08:09:01,772 [WARNING] app.service.agent.tools.snowflake_tool.snowflake_tool: []    - Column names or table references are incorrect\
2025-11-14 08:09:01,772 [WARNING] app.service.agent.tools.snowflake_tool.snowflake_tool: []    - Data may not be available for the specified time period\
2025-11-14 08:09:01,772 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: [] \uc0\u9989  TOOL EXECUTION COMPLETED: snowflake_query_tool\
2025-11-14 08:09:01,772 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Execution ID: snowflake_query_tool_1763125733264\
2025-11-14 08:09:01,772 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Duration: 8507ms\
2025-11-14 08:09:01,772 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Result Size: 1380 bytes\
2025-11-14 08:09:01,772 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Record Count: 13\
2025-11-14 08:09:01,772 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Data Completeness: 1.000\
2025-11-14 08:09:01,772 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Result Hash: c3181119\
2025-11-14 08:09:01,772 [WARNING] app.service.agent.orchestration.enhanced_tool_execution_logger: [] \uc0\u9888 \u65039  Slow execution: 8507ms (threshold: 5000ms)\
2025-11-14 08:09:01,935 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Disconnected from Snowflake\
2025-11-14 08:09:01,935 [WARNING] app.service.agent.orchestration.enhanced_tool_executor: [] Tool snowflake_query_tool took 8.68s (threshold: 5.0s)\
2025-11-14 08:09:01,938 [INFO] app.service.tool_execution_service: [] Updated tool execution 65edf354-012a-40dc-83ea-f19899c69cd4 status to completed\
2025-11-14 08:09:01,939 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  \u9989  Tool snowflake_query_tool executed successfully, result type: <class 'dict'>\
2025-11-14 08:09:01,939 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Tool execution summary: 1 tool calls found, 1 results generated\
2025-11-14 08:09:01,939 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Returning dict result with 1 messages\
2025-11-14 08:09:01,940 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56522  TRACKING: Tool metadata extraction\
2025-11-14 08:09:01,941 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56522  Tracked successful tool execution: snowflake_query_tool\
2025-11-14 08:09:01,941 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56522  DATABASE DATA: Extracted from snowflake_query_tool (type: dict)\
2025-11-14 08:09:01,941 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56522  PHASE UPDATE: initialization \u8594  tool_execution\
2025-11-14 08:09:01,941 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u9989  TRACKING: Updated metadata for 2 tools\
2025-11-14 08:09:01,942 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:09:01,943 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.114 (low)\
2025-11-14 08:09:01,943 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:09:01,943 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: network_agent (domain: network)\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  ROUTING TO DOMAIN AGENT: network_agent\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: network_agent\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.114 (AIConfidenceLevel.LOW)\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:09:01,944 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: network_agent\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.114 (low)\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: network_agent (domain: network)\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  ROUTING TO DOMAIN AGENT: network_agent\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: network_agent\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.114 (AIConfidenceLevel.LOW)\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:09:01,945 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: network_agent\
2025-11-14 08:09:01,946 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence network agent starting\
2025-11-14 08:09:01,946 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] [Step 5.2.1] \uc0\u55356 \u57104  Network agent analyzing investigation\
2025-11-14 08:09:01,947 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for network_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:09:01,947 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Network agent processing Snowflake data:\
2025-11-14 08:09:01,947 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data type: dict\
2025-11-14 08:09:01,947 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data keys: ['results', 'row_count', 'columns', 'database', 'schema', 'table', 'query_insights', 'query_validation', 'evidence_completeness', 'query_status', 'execution_timestamp', 'execution_duration_ms', 'schema_info']\
2025-11-14 08:09:01,947 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data['results'] count: 0\
2025-11-14 08:09:01,947 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data['row_count']: 0\
2025-11-14 08:09:01,947 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Processed results count: 0\
2025-11-14 08:09:01,947 [WARNING] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u9888 \u65039  Network agent: No results extracted from snowflake_data\
2025-11-14 08:09:01,947 [WARNING] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data type: dict\
2025-11-14 08:09:01,947 [WARNING] app.service.agent.orchestration.domain_agents.network_agent: []    Available keys: ['results', 'row_count', 'columns', 'database', 'schema', 'table', 'query_insights', 'query_validation', 'evidence_completeness', 'query_status', 'execution_timestamp', 'execution_duration_ms', 'schema_info']\
2025-11-14 08:09:01,947 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Total evidence before LLM analysis: 0 items\
2025-11-14 08:09:01,947 [WARNING] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u9888 \u65039  Network agent: No evidence collected! Snowflake data had 0 rows but evidence list is empty\
2025-11-14 08:09:01,949 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1.4] \uc0\u55357 \u56615  Tool Results Aggregation - 1 tool results available for LLM analysis\
2025-11-14 08:09:01,949 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1.4] \uc0\u55357 \u56522  Tool Result Keys: ['snowflake_query_tool']\
2025-11-14 08:09:01,949 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56800  EvidenceAnalyzer initialization: test_mode=, has_api_key=True, use_mock=False\
2025-11-14 08:09:01,949 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  Evidence analyzer using live model: gpt-5-mini\
2025-11-14 08:09:01,949 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:09:01,949 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 1\
2025-11-14 08:09:01,949 [INFO] app.service.agent.evidence_analyzer: []    Tool names: ['snowflake_query_tool']\
2025-11-14 08:09:01,949 [INFO] app.service.agent.evidence_analyzer: []    snowflake_query_tool: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TX...\
2025-11-14 08:09:01,949 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:09:01,949 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:09:01,950 [INFO] app.service.agent.evidence_analyzer: []    No transaction records found in Snowflake\
2025-11-14 08:09:01,950 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:09:01,950 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 0 raw records \u8594  formatted summary\
2025-11-14 08:09:01,950 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:09:01,950 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a network security expert specializing in IP reputation analysis, \
            geographic patterns, VPN detection, and network behavior analysis. You understand \
            network-based fraud indicators and can assess IP-related risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple tr...\
2025-11-14 08:09:01,950 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3475 chars)\
2025-11-14 08:09:01,950 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this network domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
\uc0\u9888 \u65039  LOW EVIDENCE VOLUME DETECTED: Only 0 event(s) available. You MAY assign LOW risk (\u8804 0.3) or explicitly state 'needs more evidence' with low confidence. Do NOT assign high risk scores with insufficient evidence UNLESS fraud patterns are detected.\
\
## Entity Information\
- Type: email\
- ID: meiling.soto.garrido@gmail.com\
- Domain: network\
\
## Evidence Collected\
No evidence collected\
\
## Metrics and Data Points\
No metrics available\
\
## Snowflake Context\
No transaction records found in Snowflake\
\
## Tool Execution Results\
Tool Execution Results - ALL data signals from external fraud detection tools:\
\
\
**Snowflake Query Tool**:\
  - Output: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", "query_insights": \{"contains_fraud_analysis": false, "contains_user_analysis": true, "contains_p\
  - (Total length: 1380 characters)\
\
CRITICAL: The Tool Execution Results section contains ALL data signals from external tools that were executed.\
You MUST consider these tool results as primary evidence sources when assessing fraud risk.\
Each tool result represents direct intelligence gathering from specialized fraud detection systems.\
\
DATA GAP ANALYSIS:\
If tool results show "No tool execution results available" or are missing, you MUST:\
- Explicitly list which analyses cannot be performed (IP reputation, device reputation, email reputation, etc.)\
- Explain how missing data affects your confidence level\
- Prioritize which missing data sources are most critical for assessment\
- Format as: "CRITICAL DATA GAP: [Missing data type] - Impact: [How it affects assessment]"\
\
## Analysis Requirements\
Provide a comprehensive fraud risk assessment based ONLY on ALL the evidence above (including tool results):\
\
1. **RISK SCORE**: (0.0 to 1.0) - Must be justified by evidence\
2. **CONFIDENCE**: (0.0 to 1.0) - Based on evidence quality and completeness\
3. **RISK FACTORS**: List specific factors that increase/decrease risk\
4. **REASONING**: Detailed explanation of your risk assessment (reference tool results where applicable)\
5. **RECOMMENDATIONS**: Specific actions based on your findings\
\
CRITICAL: In your RECOMMENDATIONS section, you MUST:\
- Extract and include EXACT values mentioned in the evidence (IP addresses, device fingerprints, email addresses)\
- Format recommendations as: "[PRIORITY] Action: specific_value"\
- Include specific IPs, devices, emails to check (don't use generic "check IP reputation")\
- Example: "[CRITICAL] Check IP reputation for 2404:c0:2910::99:43cc and 2404:c0:2910::8e:2237"\
- Prioritize recommendations (CRITICAL, HIGH, MEDIUM, LOW)\
\
Format your response clearly with these sections. Be precise and evidence-based.\
REMINDER: You MUST provide a numeric ...\
2025-11-14 08:09:01,950 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3048 chars)\
[2025-11-14T08:09:34-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:09:34,340 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:09:34,340 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.15\
\
CONFIDENCE: 0.20\
\
RISK FACTORS\
- Factors decreasing apparent risk:\
  - No transaction or behavioral evidence was found (reduces immediate fraud signals).\
  - No external tool alerts or flags present in the provided tool outputs.\
- Factors increasing uncertainty (thus residual risk):\
  - Complete lack of collected evidence and telemetry (cannot rule out fraud).\
  - Only an email identifier is available (meiling.soto.garrido@gmail.com) \'97 an email alone is insufficient to assess fraud but is commonly used as an account identifier by attackers.\
\
DATA GAP SUMMARY (CRITICAL DATA GAPS)\
- CRITICAL DATA GAP: Transaction history (Snowflake TXS rows) - Impact: No transactions returned (row_count = 0) \'97 cannot detect velocity bursts, identical-amount clusters, or transaction-based fraud indicators.\
- CRITICAL DATA GAP: IP addresses and connection logs - Impact: Cannot evaluate IP reputation, geolocation, IP rotation, or device-IP mismatch.\
- CRITICAL DATA GAP: Device fingerprints / browser / OS telemetry - Impact: Cannot detect device reuse, device-IP mismatch, or device-based fraud signals.\
- CRITICAL DATA GAP: Email reputation / breach/abuse history - Impact: Cannot determine if the email is tied to past fraud or credential stuffing.\
- CRITICAL DATA GAP: External threat intelligence (malicious IP/domain lists) - Impact: Cannot correlate this entity to known bad infrastructure.\
\
REASONING\
- The Snowflake query tool returned: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", ...\}. This confirms there are zero transaction records for the entity in the queried table (TXS in DBT.DBT_PROD).\
- No events or metrics were provided ("No evidence collected", "No metrics available"). Because there are zero events, none of the CRITICAL PATTERN DETECTION checks (velocity bursts, identical amounts, amount clustering, timing correlations, IP rotation, device-IP mismatch) can be performed.\
- Per the EVIDENCE VOLUME RULE, when evidence volume is low (\uc0\u8804 1 event) and no fraud patterns are detected, defaulting to a LOW risk is appropriate. I therefore assign a low numeric risk (0.15) but with low confidence due to the large data gaps.\
- There are no concrete fraud indicators present in the provided evidence. However, absence of data is not evidence of absence; therefore residual risk remains and further collection is required to raise confidence.\
\
RECOMMENDATIONS (prioritized; include exact values provided)\
- [CRITICAL] Action: Query Snowflake DBT.DBT_PROD.TXS for records tied to email "meiling.soto.garrido@gmail.com" across the full retention window and ingest any returned rows for fraud pattern analysis.\
- [CRITICAL] Action: Retrieve authentication and access logs for account/email "meiling.soto.garrido@gmail.com" and extract exact IP addresses, timestamps, and device fingerprints for each session (these values are currently missing).\
- [HIGH] Action: Perform email-reputation and breach-history checks for "meiling.soto.garrido@gmail.com" against known paste/compromise and abuse feeds (e.g., HaveIBeenPwned, internal breach lists).\
- [HIGH] Action: Once IPs are available from logs, perform IP reputation, ASN, and geolocation checks for each IP and look for IP rotation or improbable geolocation jumps (example check target: IPs returned in Step 2).\
- [MEDIUM] Action: If device fingerprint data is available, compare device fingerprints to IPs to detect device-IP mismatch or single device using multiple IPs (flag if same device_id appears with multiple disparate IPs within short time windows).\
- [MEDIUM] Action: Instrument application to log transaction-level data (amount, timestamp, device_id, IP, user agent) so CRITICAL PATTERN DETECTION (velocity bursts, identical amounts, clustering) can be performed going forward.\
- [LOW] Action: Add monitoring/alerting that triggers if 3+ transactions for the same account/email occur within 5 minutes or if identical amounts repeat in quick succession.\
\
FINAL NOTES\
- Numeric risk (0.15) is conservative and driven primarily by lack of data rather than presence of fraud signals. Confidence is low (0.20) because the assessment is limited by the CRITICAL DATA GAPS above.\
- If you can provide any of the missing elements (transaction rows from DBT.DBT_PROD.TXS for the email, recent auth logs with IPs and device fingerprints, or third-party tool outputs), I will re-run the analysis and update the risk score and recommendations immediately.\
2025-11-14 08:09:34,345 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1] \uc0\u9989  Network analysis complete - Risk: 1.00\
2025-11-14 08:09:34,349 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for network_agent: 32399ms, 2 steps\
2025-11-14 08:09:34,355 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted network domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:09:34,355 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced network agent completed\
2025-11-14 08:09:34,355 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 1/6\
2025-11-14 08:09:34,357 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:09:34,361 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:09:34,361 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:09:34,634 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:09:34,707 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:09:34,708 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.254 (low)\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: device_agent (domain: device)\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: device_agent\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.254 (AIConfidenceLevel.LOW)\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:09:34,709 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: device_agent\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.254 (low)\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:09:34,710 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: device_agent (domain: device)\
2025-11-14 08:09:34,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: device_agent\
2025-11-14 08:09:34,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.254 (AIConfidenceLevel.LOW)\
2025-11-14 08:09:34,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:09:34,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:09:34,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: device_agent\
2025-11-14 08:09:34,712 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence device agent starting\
2025-11-14 08:09:34,712 [INFO] app.service.agent.orchestration.domain_agents.device_agent: [] [Step 5.2.2] \uc0\u55357 \u56561  Device agent analyzing investigation\
2025-11-14 08:09:34,712 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for device_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:09:34,712 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2.4] \uc0\u55357 \u56615  Tool Results Aggregation - 1 tool results available for LLM analysis\
2025-11-14 08:09:34,712 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2.4] \uc0\u55357 \u56522  Tool Result Keys: ['snowflake_query_tool']\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 1\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: []    Tool names: ['snowflake_query_tool']\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: []    snowflake_query_tool: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TX...\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: []    No transaction records found in Snowflake\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:09:34,712 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 0 raw records \u8594  formatted summary\
2025-11-14 08:09:34,713 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:09:34,713 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a device fingerprinting expert specializing in device consistency \
            analysis, browser spoofing detection, and device behavior patterns. You understand \
            device-based fraud indicators and can assess device-related risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multipl...\
2025-11-14 08:09:34,713 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3478 chars)\
2025-11-14 08:09:34,713 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this device domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
\uc0\u9888 \u65039  LOW EVIDENCE VOLUME DETECTED: Only 0 event(s) available. You MAY assign LOW risk (\u8804 0.3) or explicitly state 'needs more evidence' with low confidence. Do NOT assign high risk scores with insufficient evidence UNLESS fraud patterns are detected.\
\
## Entity Information\
- Type: email\
- ID: meiling.soto.garrido@gmail.com\
- Domain: device\
\
## Evidence Collected\
No evidence collected\
\
## Metrics and Data Points\
No metrics available\
\
## Snowflake Context\
No transaction records found in Snowflake\
\
## Tool Execution Results\
Tool Execution Results - ALL data signals from external fraud detection tools:\
\
\
**Snowflake Query Tool**:\
  - Output: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", "query_insights": \{"contains_fraud_analysis": false, "contains_user_analysis": true, "contains_p\
  - (Total length: 1380 characters)\
\
CRITICAL: The Tool Execution Results section contains ALL data signals from external tools that were executed.\
You MUST consider these tool results as primary evidence sources when assessing fraud risk.\
Each tool result represents direct intelligence gathering from specialized fraud detection systems.\
\
DATA GAP ANALYSIS:\
If tool results show "No tool execution results available" or are missing, you MUST:\
- Explicitly list which analyses cannot be performed (IP reputation, device reputation, email reputation, etc.)\
- Explain how missing data affects your confidence level\
- Prioritize which missing data sources are most critical for assessment\
- Format as: "CRITICAL DATA GAP: [Missing data type] - Impact: [How it affects assessment]"\
\
## Analysis Requirements\
Provide a comprehensive fraud risk assessment based ONLY on ALL the evidence above (including tool results):\
\
1. **RISK SCORE**: (0.0 to 1.0) - Must be justified by evidence\
2. **CONFIDENCE**: (0.0 to 1.0) - Based on evidence quality and completeness\
3. **RISK FACTORS**: List specific factors that increase/decrease risk\
4. **REASONING**: Detailed explanation of your risk assessment (reference tool results where applicable)\
5. **RECOMMENDATIONS**: Specific actions based on your findings\
\
CRITICAL: In your RECOMMENDATIONS section, you MUST:\
- Extract and include EXACT values mentioned in the evidence (IP addresses, device fingerprints, email addresses)\
- Format recommendations as: "[PRIORITY] Action: specific_value"\
- Include specific IPs, devices, emails to check (don't use generic "check IP reputation")\
- Example: "[CRITICAL] Check IP reputation for 2404:c0:2910::99:43cc and 2404:c0:2910::8e:2237"\
- Prioritize recommendations (CRITICAL, HIGH, MEDIUM, LOW)\
\
Format your response clearly with these sections. Be precise and evidence-based.\
REMINDER: You MUST provide a numeric ri...\
2025-11-14 08:09:34,713 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3046 chars)\
[2025-11-14T08:10:06-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:10:06,170 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:10:06,170 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.15\
\
CONFIDENCE: 0.20\
\
RISK FACTORS\
- Decreasing risk\
  - No transaction records found in Snowflake for this entity (reduces immediate fraud evidence).\
  - No external tool signals or collected evidence indicating fraud patterns.\
- Increasing risk / uncertainty\
  - Complete absence of device, network, and transaction data (large data gaps increase uncertainty).\
  - Email identity present (meiling.soto.garrido@gmail.com) but no reputation or linkage data provided.\
\
DATA GAP ANALYSIS (required)\
- CRITICAL DATA GAP: Transaction history (Snowflake TXS table returned row_count: 0) - Impact: Cannot evaluate velocity bursts, amount clustering, or timing correlations.\
- CRITICAL DATA GAP: IP addresses and IP history - Impact: Cannot check IP rotation, geolocation anomalies, or device-IP mismatch.\
- CRITICAL DATA GAP: Device fingerprint (fingerprint, device ID, UA, OS, browser) - Impact: Cannot detect device spoofing, multi-device use, or device consistency.\
- CRITICAL DATA GAP: Payment instrument / amount data - Impact: Cannot detect identical amounts or clustering.\
- CRITICAL DATA GAP: Email reputation / linkage - Impact: Cannot determine whether email is implicated in previous fraud or linked to suspicious accounts.\
- CRITICAL DATA GAP: External fraud tool signals (reputation feeds, threat intel) - Impact: Limits ability to correlate device or IP indicators with known bad actors.\
\
REASONING (evidence-based)\
- The Snowflake Query Tool result shows: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", ...\}. This indicates no transaction events for this entity were found in the queried TXS table, so no velocity, identical-amount, timing, or IP-rotation patterns could be observed.\
- The Evidence Collected section explicitly states: "No evidence collected" and "No metrics available." Therefore there are zero events and zero telemetry to analyze.\
- Per the EVIDENCE VOLUME RULE in the brief: with evidence volume low (\uc0\u8804 1 event) and no fraud patterns detected, defaulting to a LOW risk (\u8804 0.3) or stating "needs more evidence" is allowed. Because no fraud patterns (velocity bursts, amount clustering, IP rotation, or device-IP mismatch) are present in the provided evidence, I assign a low risk score rather than a higher one.\
- Confidence is low (0.20) because the assessment is based on absence of data, not positive indicators of benign behavior. The result should be treated as tentative and contingent on acquiring the missing data types listed above.\
\
RECOMMENDATIONS (must include exact values from evidence; prioritized)\
- [CRITICAL] Action: Investigate Snowflake TXS table entries for DBT.DBT_PROD.TXS \'97 current query returned row_count: 0. Confirm whether data ingestion/ETL succeeded and re-run queries for entity meiling.soto.garrido@gmail.com.\
- [CRITICAL] Action: Check reputation and history for email meiling.soto.garrido@gmail.com (email present in evidence).\
- [HIGH] Action: Collect and log device fingerprint (device_id, user_agent, browser, OS) for future events involving meiling.soto.garrido@gmail.com.\
- [HIGH] Action: Capture and store client IPs and timestamps for any transactions tied to meiling.soto.garrido@gmail.com to allow velocity and IP-rotation analysis.\
- [MEDIUM] Action: Run IP reputation and geolocation checks once IPs are available (no IPs provided in current evidence).\
- [MEDIUM] Action: Ensure transaction amount and timestamp fields are captured to detect identical-amount clustering and velocity bursts.\
- [LOW] Action: Integrate email/device/IP into cross-checks with external fraud feeds and device-reputation services after capturing those artifacts.\
\
Final note: Because there were zero events and no fraud signals in the provided data, the numeric risk is low (0.15) but with low confidence (0.20). If any of the missing data types (transactions, IPs, device fingerprints, amounts) become available and show patterns such as velocity bursts, identical amounts, or IP rotation, the risk should be re-evaluated immediately\'97those patterns would be primary indicators and could raise the score substantially.\
2025-11-14 08:10:06,171 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2] \uc0\u9989  Device analysis complete - Risk: 1.00\
2025-11-14 08:10:06,174 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for device_agent: 31459ms, 2 steps\
2025-11-14 08:10:06,174 [INFO] app.service.agent.orchestration.domain_agents.device_agent: [] [Step 5.2.2] \uc0\u9989  Device analysis complete - Evidence collected: 1 points\
2025-11-14 08:10:06,178 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted device domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:10:06,179 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced device agent completed\
2025-11-14 08:10:06,179 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 2/6\
2025-11-14 08:10:06,180 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:10:06,183 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:10:06,183 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.279 (low)\
2025-11-14 08:10:06,183 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:10:06,183 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: location_agent (domain: location)\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: location_agent\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.279 (AIConfidenceLevel.LOW)\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:10:06,184 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: location_agent\
2025-11-14 08:10:06,184 [INFO] uvicorn.access: [] 127.0.0.1:58368 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:10:06,185 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.279 (low)\
2025-11-14 08:10:06,185 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:10:06,185 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.05\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: location_agent (domain: location)\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: location_agent\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.279 (AIConfidenceLevel.LOW)\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:10:06,186 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: location_agent\
2025-11-14 08:10:06,187 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence location agent starting\
2025-11-14 08:10:06,187 [INFO] app.service.agent.orchestration.domain_agents.location_agent: [] [Step 5.2.3] \uc0\u55357 \u56525  Location agent analyzing investigation\
2025-11-14 08:10:06,187 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for location_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:10:06,187 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3.4] \uc0\u55357 \u56615  Tool Results Aggregation - 1 tool results available for LLM analysis\
2025-11-14 08:10:06,187 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3.4] \uc0\u55357 \u56522  Tool Result Keys: ['snowflake_query_tool']\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 1\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: []    Tool names: ['snowflake_query_tool']\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: []    snowflake_query_tool: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TX...\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: []    No transaction records found in Snowflake\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 0 raw records \u8594  formatted summary\
2025-11-14 08:10:06,187 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:10:06,188 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a geographic analysis expert specializing in location patterns, \
            impossible travel detection, and geographic risk assessment. You understand \
            location-based fraud indicators and can assess geographic risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transacti...\
2025-11-14 08:10:06,188 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3469 chars)\
2025-11-14 08:10:06,188 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this location domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
\uc0\u9888 \u65039  LOW EVIDENCE VOLUME DETECTED: Only 1 event(s) available. You MAY assign LOW risk (\u8804 0.3) or explicitly state 'needs more evidence' with low confidence. Do NOT assign high risk scores with insufficient evidence UNLESS fraud patterns are detected.\
\
## Entity Information\
- Type: email\
- ID: meiling.soto.garrido@gmail.com\
- Domain: location\
\
## Evidence Collected\
- Geographic data: No location information available from any source\
\
## Metrics and Data Points\
- Unique Countries: 0\
- Unique Cities: 0\
\
## Snowflake Context\
No transaction records found in Snowflake\
\
## Tool Execution Results\
Tool Execution Results - ALL data signals from external fraud detection tools:\
\
\
**Snowflake Query Tool**:\
  - Output: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", "query_insights": \{"contains_fraud_analysis": false, "contains_user_analysis": true, "contains_p\
  - (Total length: 1380 characters)\
\
CRITICAL: The Tool Execution Results section contains ALL data signals from external tools that were executed.\
You MUST consider these tool results as primary evidence sources when assessing fraud risk.\
Each tool result represents direct intelligence gathering from specialized fraud detection systems.\
\
DATA GAP ANALYSIS:\
If tool results show "No tool execution results available" or are missing, you MUST:\
- Explicitly list which analyses cannot be performed (IP reputation, device reputation, email reputation, etc.)\
- Explain how missing data affects your confidence level\
- Prioritize which missing data sources are most critical for assessment\
- Format as: "CRITICAL DATA GAP: [Missing data type] - Impact: [How it affects assessment]"\
\
## Analysis Requirements\
Provide a comprehensive fraud risk assessment based ONLY on ALL the evidence above (including tool results):\
\
1. **RISK SCORE**: (0.0 to 1.0) - Must be justified by evidence\
2. **CONFIDENCE**: (0.0 to 1.0) - Based on evidence quality and completeness\
3. **RISK FACTORS**: List specific factors that increase/decrease risk\
4. **REASONING**: Detailed explanation of your risk assessment (reference tool results where applicable)\
5. **RECOMMENDATIONS**: Specific actions based on your findings\
\
CRITICAL: In your RECOMMENDATIONS section, you MUST:\
- Extract and include EXACT values mentioned in the evidence (IP addresses, device fingerprints, email addresses)\
- Format recommendations as: "[PRIORITY] Action: specific_value"\
- Include specific IPs, devices, emails to check (don't use generic "check IP reputation")\
- Example: "[CRITICAL] Check IP reputation for 2404:c0:2910::99:43cc and 2404:c0:2910::8e:2237"\
- Prioritize recommendations (CRITICAL, HIGH, MEDIUM, LOW)\
\
Format your response clearly with these sections....\
2025-11-14 08:10:06,188 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3117 chars)\
[2025-11-14T08:10:36-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:10:36,346 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:10:36,346 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.15\
\
CONFIDENCE: 0.20\
\
RISK FACTORS\
- Missing geographic evidence: "Geographic data: No location information available from any source" (increases uncertainty)\
- Single event only: EVIDENCE VOLUME LOW (1 event) \'97 insufficient to detect behavioral fraud patterns\
- Email identifier present: meiling.soto.garrido@gmail.com (use of a free email provider can be neutral-to-slightly-increasing risk in absence of corroborating identity signals)\
- No transactions found in primary ledger: Snowflake query returned zero rows for the target table (reduces ability to detect transactional fraud patterns)\
\
FACTORS THAT DECREASE RISK\
- No behavioral fraud patterns detected in available evidence (no velocity bursts, no amount clustering, no IP rotation, no device-IP mismatch observed)\
- No Snowflake transaction records linking this identity to suspicious activity\
\
REASONING (evidence-based)\
- The only concrete identity evidence provided is the email: meiling.soto.garrido@gmail.com. No IP addresses, device fingerprints, geolocation, transaction timestamps, or amounts were provided.\
- Snowflake Query Tool results: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", ...\} \'97 this shows the primary transaction store queried returned no matching records, so we cannot analyze transaction-level fraud signals (velocity bursts, identical amounts, clustering).\
- Because the dataset contains only one event and no behavioral indicators (and no transactional data), there is no direct evidence of fraud patterns (velocity, amount clustering, IP rotation, device-IP mismatch). Under the EVIDENCE VOLUME RULE, with \uc0\u8804 1 event and no detected fraud patterns, the appropriate posture is low risk or "needs more evidence."\
- Given the substantial missing data, assign a conservative low-risk numeric value (0.15) reflecting low detected risk but strong uncertainty. The confidence is low (0.20) because critical data needed to detect fraud patterns is absent.\
\
CRITICAL DATA GAP(S)\
- CRITICAL DATA GAP: IP addresses - Impact: Cannot perform IP reputation checks, detect IP rotation, or correlate IPs to geolocation or velocity.\
- CRITICAL DATA GAP: Device fingerprints / device IDs - Impact: Cannot detect device reuse, device-IP mismatches, or device-based anomaly signals.\
- CRITICAL DATA GAP: Transaction records (amounts, timestamps) - Impact: Cannot detect velocity bursts, amount clustering, identical-amount patterns, or fraudulent transaction sequences. Note: Snowflake query returned row_count: 0 for DBT.DBT_PROD.TXS.\
- CRITICAL DATA GAP: Geolocation (country/city) - Impact: Cannot detect impossible travel, anomalous location changes, or IP/location inconsistencies. ("Unique Countries: 0", "Unique Cities: 0")\
- CRITICAL DATA GAP: Browser/OS/user-agent logs - Impact: Cannot identify user-agent variability or spoofing.\
- CRITICAL DATA GAP: Email reputation / historical association data - Impact: Cannot assess prior fraud reports tied to the email address.\
\
RECOMMENDATIONS (prioritized; include exact values from evidence where applicable)\
- [CRITICAL] Action: Investigate Snowflake transaction store DBT.DBT_PROD.TXS for records related to meiling.soto.garrido@gmail.com. Rationale: current query returned zero rows; confirm queries/filter criteria and time range.\
- [CRITICAL] Action: Validate and collect source IP(s) and timestamp(s) for the event associated with meiling.soto.garrido@gmail.com. Specific value to collect: meiling.soto.garrido@gmail.com \'97 associate with any observed IPs.\
- [HIGH] Action: Perform email reputation and historical lookup for meiling.soto.garrido@gmail.com (check prior fraud reports, account age, known abuse). Exact value to query: meiling.soto.garrido@gmail.com.\
- [HIGH] Action: Capture device fingerprint and user-agent on next interaction for meiling.soto.garrido@gmail.com (store device_id, user_agent, and any available persistent cookie values).\
- [MEDIUM] Action: Enable/collect geolocation (country/city) from incoming connections for this email's future events. Note: current evidence shows "Geographic data: No location information available from any source", Unique Countries: 0, Unique Cities: 0.\
- [MEDIUM] Action: If/when transactions appear, monitor for these precise fraud patterns and trigger escalation:\
  - Velocity bursts: 3+ transactions within 5 minutes for meiling.soto.garrido@gmail.com\
  - Identical amounts: multiple identical amounts within minutes\
  - IP rotation: same device_id with \uc0\u8805 2 distinct IPs within a short time window\
- [LOW] Action: Add meiling.soto.garrido@gmail.com to enhanced monitoring (rule-based watchlist) pending data enrichment; do not block solely on current evidence.\
- [LOW] Action: Re-run Snowflake query with broader time windows and alternative keys (email normalized, user_id mappings) against DBT.DBT_PROD.TXS and related tables to confirm absence of transactions.\
\
Final note\
- Current data is insufficient to demonstrate behavioral fraud p\
2025-11-14 08:10:36,347 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5257 chars)\
2025-11-14 08:10:36,351 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3] \uc0\u9989  Location analysis complete - Risk: 1.00\
2025-11-14 08:10:36,358 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for location_agent: 30165ms, 2 steps\
2025-11-14 08:10:36,358 [INFO] app.service.agent.orchestration.domain_agents.location_agent: [] [Step 5.2.3] \uc0\u9989  Location analysis complete - Risk: 1.00\
2025-11-14 08:10:36,367 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted location domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:10:36,368 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced location agent completed\
2025-11-14 08:10:36,368 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 3/6\
2025-11-14 08:10:36,371 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:10:36,374 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:10:36,374 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:10:36,597 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:10:36,669 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:10:36,672 [INFO] app.service.etag_service: [investigation_id=a36ec7a9-28e8-4e55-b05b-6d01931f99d2, olorin_tid=977919af-32af-476a-a8d4-8525780cc0ec] etag_retrieved\
2025-11-14 08:10:36,673 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:10:36,673 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.305 (low)\
2025-11-14 08:10:36,673 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:10:36,673 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.06\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: logs_agent (domain: logs)\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: logs_agent\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.305 (AIConfidenceLevel.LOW)\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:10:36,674 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: logs_agent\
2025-11-14 08:10:36,675 [INFO] uvicorn.access: [] 127.0.0.1:58368 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:10:36,675 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.305 (low)\
2025-11-14 08:10:36,675 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:10:36,675 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.07\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: logs_agent (domain: logs)\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: logs_agent\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.305 (AIConfidenceLevel.LOW)\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:10:36,676 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: logs_agent\
2025-11-14 08:10:36,677 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence logs agent starting\
2025-11-14 08:10:36,677 [INFO] app.service.agent.orchestration.domain_agents.logs_agent: [] [Step 5.2.4] \uc0\u55357 \u56541  Logs agent analyzing investigation\
2025-11-14 08:10:36,678 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for logs_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:10:36,678 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4.4] \uc0\u55357 \u56615  Tool Results Aggregation - 1 tool results available for LLM analysis\
2025-11-14 08:10:36,678 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4.4] \uc0\u55357 \u56522  Tool Result Keys: ['snowflake_query_tool']\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 1\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    Tool names: ['snowflake_query_tool']\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    snowflake_query_tool: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TX...\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    No transaction records found in Snowflake\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 0 raw records \u8594  formatted summary\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a log analysis expert specializing in behavioral pattern analysis, \
            system logs interpretation, and activity pattern detection. You understand \
            behavioral fraud indicators and can assess activity-based risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transac...\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3467 chars)\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this logs domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
\uc0\u9888 \u65039  LOW EVIDENCE VOLUME DETECTED: Only 0 event(s) available. You MAY assign LOW risk (\u8804 0.3) or explicitly state 'needs more evidence' with low confidence. Do NOT assign high risk scores with insufficient evidence UNLESS fraud patterns are detected.\
\
## Entity Information\
- Type: email\
- ID: meiling.soto.garrido@gmail.com\
- Domain: logs\
\
## Evidence Collected\
No evidence collected\
\
## Metrics and Data Points\
No metrics available\
\
## Snowflake Context\
No transaction records found in Snowflake\
\
## Tool Execution Results\
Tool Execution Results - ALL data signals from external fraud detection tools:\
\
\
**Snowflake Query Tool**:\
  - Output: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", "query_insights": \{"contains_fraud_analysis": false, "contains_user_analysis": true, "contains_p\
  - (Total length: 1380 characters)\
\
CRITICAL: The Tool Execution Results section contains ALL data signals from external tools that were executed.\
You MUST consider these tool results as primary evidence sources when assessing fraud risk.\
Each tool result represents direct intelligence gathering from specialized fraud detection systems.\
\
DATA GAP ANALYSIS:\
If tool results show "No tool execution results available" or are missing, you MUST:\
- Explicitly list which analyses cannot be performed (IP reputation, device reputation, email reputation, etc.)\
- Explain how missing data affects your confidence level\
- Prioritize which missing data sources are most critical for assessment\
- Format as: "CRITICAL DATA GAP: [Missing data type] - Impact: [How it affects assessment]"\
\
## Analysis Requirements\
Provide a comprehensive fraud risk assessment based ONLY on ALL the evidence above (including tool results):\
\
1. **RISK SCORE**: (0.0 to 1.0) - Must be justified by evidence\
2. **CONFIDENCE**: (0.0 to 1.0) - Based on evidence quality and completeness\
3. **RISK FACTORS**: List specific factors that increase/decrease risk\
4. **REASONING**: Detailed explanation of your risk assessment (reference tool results where applicable)\
5. **RECOMMENDATIONS**: Specific actions based on your findings\
\
CRITICAL: In your RECOMMENDATIONS section, you MUST:\
- Extract and include EXACT values mentioned in the evidence (IP addresses, device fingerprints, email addresses)\
- Format recommendations as: "[PRIORITY] Action: specific_value"\
- Include specific IPs, devices, emails to check (don't use generic "check IP reputation")\
- Example: "[CRITICAL] Check IP reputation for 2404:c0:2910::99:43cc and 2404:c0:2910::8e:2237"\
- Prioritize recommendations (CRITICAL, HIGH, MEDIUM, LOW)\
\
Format your response clearly with these sections. Be precise and evidence-based.\
REMINDER: You MUST provide a numeric risk s...\
2025-11-14 08:10:36,678 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3042 chars)\
^[[A^[[B[2025-11-14T08:11:05-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:11:05,108 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:11:05,108 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.15\
\
CONFIDENCE: 0.20\
\
KEY RISK FACTORS\
- Low evidence volume: 0 events, no transaction history found for the entity.\
- Single identifier present: email = meiling.soto.garrido@gmail.com (no additional telemetry to corroborate activity).\
- No detected behavioral anomalies (no velocity bursts, no amount clustering, no IP/device signals) because corresponding data is absent.\
\
REASONING\
- The Snowflake query tool returned no transaction records. Exact tool output fragment: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", ...\}. That indicates there are no TXS rows available in DBT.DBT_PROD.TXS for this entity at query time.\
- Evidence volume is zero (explicitly stated: "Only 0 event(s) available" and "No evidence collected"). Per the EVIDENCE VOLUME RULE, when evidence volume is \uc0\u8804 1 and no fraud patterns are detected, a low risk is appropriate or the analyst should indicate "needs more evidence." No behavioral fraud indicators (velocity bursts, identical amounts, IP rotation, device-IP mismatch) can be detected because there are no events or telemetry.\
- Because the primary external tool (Snowflake) produced no results and no other tool signals are present, there is insufficient data to justify any medium or high fraud risk. Therefore the assessment is conservative: low risk (0.15) but with low confidence (0.20) due to missing data.\
- No model-derived scores were used or relied upon in forming this numeric risk.\
\
CRITICAL DATA GAP(S)\
- CRITICAL DATA GAP: Transaction history (Snowflake TXS rows for this email) - Impact: Cannot identify transaction-based fraud patterns (velocity, amount clustering, geolocation).\
- CRITICAL DATA GAP: IP addresses and connection logs - Impact: Cannot detect IP rotation, geolocation anomalies, or IP reputation issues.\
- CRITICAL DATA GAP: Device fingerprint / user-agent data - Impact: Cannot detect device-IP mismatch or device reuse patterns.\
- CRITICAL DATA GAP: Payment instrument details (card/token) - Impact: Cannot detect amount clustering or stolen instrument reuse.\
- CRITICAL DATA GAP: Email/account creation and login events - Impact: Cannot detect account takeover signals or new-account fraud patterns.\
- CRITICAL DATA GAP: Email reputation / threat intelligence results - Impact: Cannot assess whether the email has been flagged for abuse.\
- CRITICAL DATA GAP: Any external fraud-tool outputs (IP reputation, device reputation, geo risk) - Impact: Limits ability to escalate risk despite potential unseen indicators.\
\
RECOMMENDATIONS\
(Each recommendation references exact values that are present in the evidence where applicable.)\
\
- [CRITICAL] Action: Query DBT.DBT_PROD.TXS for any records related to "meiling.soto.garrido@gmail.com" (e.g., WHERE buyer_email = 'meiling.soto.garrido@gmail.com' OR user_email = 'meiling.soto.garrido@gmail.com') and return timestamp, amount, IP, device_fingerprint, user_agent, and payment_instrument. Rationale: current Snowflake output shows row_count = 0; re-query with broader time window and fields to ensure no missed rows.\
- [CRITICAL] Action: If query returns rows, extract and provide exact IP addresses, timestamps, amounts, and device_fingerprint values for pattern analysis (to detect velocity bursts, identical amounts, IP rotation). Rationale: behavioral patterns drive fraud risk.\
- [HIGH] Action: Run email reputation and abuse checks for meiling.soto.garrido@gmail.com (spam lists, known-breach lists, and threat feeds). Rationale: only the email is available as an identifier in the evidence.\
- [HIGH] Action: Collect connection logs (source IPs and timestamps) and device fingerprints for all authentication/transaction events tied to meiling.soto.garrido@gmail.com. Rationale: needed to detect IP rotation and device-IP mismatches.\
- [MEDIUM] Action: Query payment instrument logs for transactions linked to meiling.soto.garrido@gmail.com in DBT.DBT_PROD.TXS (payment_instrument_id, last4, BIN) and return amounts and timestamps. Rationale: to detect amount clustering or templated/batch patterns.\
- [MEDIUM] Action: If any IP addresses are discovered, perform reputation lookups and include exact IPs in follow-up investigations (format: [CRITICAL] Check IP reputation for <IP_ADDRESS>). Rationale: IPs were not provided in current evidence; include them once available.\
- [LOW] Action: If no transactions exist for this email in DBT.DBT_PROD.TXS, verify account creation and login history across identity stores for meiling.soto.garrido@gmail.com to confirm whether the email is associated with any active account. Rationale: determine whether lack of transactions is expected or indicates data sync issues.\
\
FINAL NOTES\
- Current assessment is constrained by complete absence of event data. The numeric risk (0.15) reflects a conservative, low-risk stance driven solely by lack of evidence rather than any benign signals. Confidence is low (0.20). If any of the requested queries return data indicating velo\
2025-11-14 08:11:05,108 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5143 chars)\
2025-11-14 08:11:05,110 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4] \uc0\u9989  Logs analysis complete - Risk: 1.00\
2025-11-14 08:11:05,113 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for logs_agent: 28432ms, 2 steps\
2025-11-14 08:11:05,113 [INFO] app.service.agent.orchestration.domain_agents.logs_agent: [] [Step 5.2.4] \uc0\u9989  Logs analysis complete - Risk: 1.00\
2025-11-14 08:11:05,119 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted logs domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:11:05,119 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced logs agent completed\
2025-11-14 08:11:05,119 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 4/6\
2025-11-14 08:11:05,121 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:11:05,123 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.330 (low)\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.07\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: authentication_agent (domain: authentication)\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: authentication_agent\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.330 (AIConfidenceLevel.LOW)\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:11:05,124 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: authentication_agent\
2025-11-14 08:11:05,125 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.330 (low)\
2025-11-14 08:11:05,125 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:11:05,125 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.08\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: authentication_agent (domain: authentication)\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: authentication_agent\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.330 (AIConfidenceLevel.LOW)\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:11:05,126 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: authentication_agent\
2025-11-14 08:11:05,127 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence authentication agent starting\
2025-11-14 08:11:05,127 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: [] [Step 5.2.5] \uc0\u55357 \u56592  Authentication agent analyzing investigation\
2025-11-14 08:11:05,127 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for authentication_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:11:05,127 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5.4] \uc0\u55357 \u56615  Tool Results Aggregation - 1 tool results available for LLM analysis\
2025-11-14 08:11:05,127 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5.4] \uc0\u55357 \u56522  Tool Result Keys: ['snowflake_query_tool']\
2025-11-14 08:11:05,127 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:11:05,127 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 1\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    Tool names: ['snowflake_query_tool']\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    snowflake_query_tool: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TX...\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    No transaction records found in Snowflake\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 0 raw records \u8594  formatted summary\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are an authentication security expert specializing in login \
            pattern analysis, credential security, and authentication anomaly detection. You \
            understand authentication-based fraud indicators and security risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transact...\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3476 chars)\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this authentication domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
\uc0\u9888 \u65039  LOW EVIDENCE VOLUME DETECTED: Only 0 event(s) available. You MAY assign LOW risk (\u8804 0.3) or explicitly state 'needs more evidence' with low confidence. Do NOT assign high risk scores with insufficient evidence UNLESS fraud patterns are detected.\
\
## Entity Information\
- Type: email\
- ID: meiling.soto.garrido@gmail.com\
- Domain: authentication\
\
## Evidence Collected\
No evidence collected\
\
## Metrics and Data Points\
No metrics available\
\
## Snowflake Context\
No transaction records found in Snowflake\
\
## Tool Execution Results\
Tool Execution Results - ALL data signals from external fraud detection tools:\
\
\
**Snowflake Query Tool**:\
  - Output: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", "query_insights": \{"contains_fraud_analysis": false, "contains_user_analysis": true, "contains_p\
  - (Total length: 1380 characters)\
\
CRITICAL: The Tool Execution Results section contains ALL data signals from external tools that were executed.\
You MUST consider these tool results as primary evidence sources when assessing fraud risk.\
Each tool result represents direct intelligence gathering from specialized fraud detection systems.\
\
DATA GAP ANALYSIS:\
If tool results show "No tool execution results available" or are missing, you MUST:\
- Explicitly list which analyses cannot be performed (IP reputation, device reputation, email reputation, etc.)\
- Explain how missing data affects your confidence level\
- Prioritize which missing data sources are most critical for assessment\
- Format as: "CRITICAL DATA GAP: [Missing data type] - Impact: [How it affects assessment]"\
\
## Analysis Requirements\
Provide a comprehensive fraud risk assessment based ONLY on ALL the evidence above (including tool results):\
\
1. **RISK SCORE**: (0.0 to 1.0) - Must be justified by evidence\
2. **CONFIDENCE**: (0.0 to 1.0) - Based on evidence quality and completeness\
3. **RISK FACTORS**: List specific factors that increase/decrease risk\
4. **REASONING**: Detailed explanation of your risk assessment (reference tool results where applicable)\
5. **RECOMMENDATIONS**: Specific actions based on your findings\
\
CRITICAL: In your RECOMMENDATIONS section, you MUST:\
- Extract and include EXACT values mentioned in the evidence (IP addresses, device fingerprints, email addresses)\
- Format recommendations as: "[PRIORITY] Action: specific_value"\
- Include specific IPs, devices, emails to check (don't use generic "check IP reputation")\
- Example: "[CRITICAL] Check IP reputation for 2404:c0:2910::99:43cc and 2404:c0:2910::8e:2237"\
- Prioritize recommendations (CRITICAL, HIGH, MEDIUM, LOW)\
\
Format your response clearly with these sections. Be precise and evidence-based.\
REMINDER: You MUST prov...\
2025-11-14 08:11:05,128 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3062 chars)\
[2025-11-14T08:11:37-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:11:37,473 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:11:37,473 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.15\
\
CONFIDENCE: 0.20\
\
KEY RISK FACTORS\
- Low evidence volume: "No evidence collected" and "No metrics available" (explicitly provided).\
- Snowflake search returned no transactions: Snowflake Query Tool result: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", ...\}\
- Only identified entity is the email address: meiling.soto.garrido@gmail.com\
- Missing critical telemetry (IP addresses, device fingerprints, geolocation, auth logs, MFA state, password reset history) \'97 inability to detect behavioral anomalies or fraud patterns.\
\
REASONING\
- There are zero events and zero transaction records for this entity in Snowflake (row_count: 0, results: []). No behavioral patterns (velocity bursts, identical amounts, IP rotation, device-IP mismatch) can be detected because no transactional/authentication events were provided.\
- Per the EVIDENCE VOLUME RULE, when evidence volume is low (\uc0\u8804 1 event) and no fraud patterns are detected, a LOW risk score (\u8804 0.3) is appropriate. I selected 0.15 to reflect a conservative low-risk posture while acknowledging uncertainty.\
- Confidence is low (0.20) because essential telemetry is missing. Without IPs, device IDs, auth timestamps, geolocation, or any transaction data, we cannot detect primary fraud indicators (velocity bursts, amount clustering, IP rotation, device-IP mismatch). Therefore the assessment is necessarily limited and should be re-evaluated when additional data is available.\
- Tool Execution Results are treated as primary evidence: the Snowflake query returned no rows for DBT.DBT_PROD.TXS, so there is no Snowflake-based fraud signal to escalate. No external tool signals were provided.\
\
CRITICAL DATA GAP: IP addresses - Impact: Cannot assess IP reputation, IP rotation, geolocation, or device-IP mismatch. This significantly lowers confidence and prevents detection of IP-based fraud patterns.\
CRITICAL DATA GAP: Device fingerprints / device IDs - Impact: Cannot detect device reuse, device spoofing, or device-IP mismatch patterns.\
CRITICAL DATA GAP: Authentication event logs (timestamps, success/failure) - Impact: Cannot detect velocity bursts, rapid auth attempts, or timing correlations.\
CRITICAL DATA GAP: Transaction history / amounts - Impact: Cannot detect identical-amount clustering or templated transaction patterns.\
CRITICAL DATA GAP: MFA/2FA status and history - Impact: Cannot factor account protection level into risk.\
CRITICAL DATA GAP: Email reputation / historical abuse indicators - Impact: Cannot evaluate whether the email has prior abuse/fraud signals.\
CRITICAL DATA GAP: Password reset and account creation metadata - Impact: Cannot assess recent account takeover activity or suspicious account set-up patterns.\
CRITICAL DATA GAP: Browser/OS telemetry and geolocation - Impact: Cannot detect inconsistent device/browser patterns or impossible travel.\
\
RECOMMENDATIONS (prioritized; include exact values present in evidence)\
- [CRITICAL] Action: Investigate email meiling.soto.garrido@gmail.com \'97 pull full authentication and account activity history (creation timestamp, last login, failed logins, password reset events, MFA changes).\
- [CRITICAL] Action: Query Snowflake DBT.DBT_PROD.TXS for records related to meiling.soto.garrido@gmail.com \'97 exact target: database=DBT, schema=DBT_PROD, table=TXS (current query returned row_count: 0; verify query scope and filters).\
- [HIGH] Action: Collect and review auth logs for meiling.soto.garrido@gmail.com (source IPs, timestamps, device IDs, user agents) \'97 note: no IPs/devices were provided in evidence; these must be captured.\
- [HIGH] Action: If any IPs are found for this email, perform reputation and geolocation checks for those exact IPs (example: include the specific IPs returned from logs \'97 none provided in current evidence).\
- [MEDIUM] Action: Run email reputation and abuse lookups for meiling.soto.garrido@gmail.com (spam lists, paste sites, known-breach lists).\
- [MEDIUM] Action: Verify MFA enrollment and recent MFA challenges for meiling.soto.garrido@gmail.com; require MFA or step-up authentication if absent or suspicious activity is found.\
- [LOW] Action: If device fingerprints exist, compare device IDs across sessions for device-IP consistency to detect device-IP mismatch or IP rotation patterns.\
- [LOW] Action: Re-run targeted Snowflake queries with broadened time windows and alternative filters (e.g., other tables related to auth events) to ensure no records were missed in DBT.DBT_PROD.TXS.\
\
NOTES / NEXT STEPS\
- Because the dataset contains zero events, do not escalate or block based solely on current evidence. Mark this entity as \'93needs more evidence\'94 and collect the missing telemetry listed above before raising risk score or taking enforcement actions.\
- If any of the critical gaps return positive signals (e.g., velocity bursts, identical amounts, IP rotation, device-IP mismatch), re-assess immediately and escalate risk according to detected pattern severity\
2025-11-14 08:11:37,473 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5465 chars)\
2025-11-14 08:11:37,475 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5] \uc0\u9989  Authentication analysis complete - Risk: 1.00\
2025-11-14 08:11:37,478 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for authentication_agent: 32348ms, 2 steps\
2025-11-14 08:11:37,478 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: [] [Step 5.2.5] \uc0\u9989  Authentication analysis complete - Risk: 1.00\
2025-11-14 08:11:37,482 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted authentication domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:11:37,482 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced authentication agent completed\
2025-11-14 08:11:37,482 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 5/6\
2025-11-14 08:11:37,484 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:11:37,487 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:11:37,487 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:11:37,687 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:11:37,755 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:11:37,757 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:11:37,757 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.355 (low)\
2025-11-14 08:11:37,757 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:11:37,757 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:11:37,757 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:11:37,757 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:11:37,757 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:11:37,757 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:11:37,758 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.08\
2025-11-14 08:11:37,758 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:11:37,758 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: merchant_agent (domain: merchant)\
2025-11-14 08:11:37,758 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: merchant_agent\
2025-11-14 08:11:37,758 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.355 (AIConfidenceLevel.LOW)\
2025-11-14 08:11:37,758 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:11:37,758 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:11:37,758 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: merchant_agent\
2025-11-14 08:11:37,758 [INFO] uvicorn.access: [] 127.0.0.1:58902 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.355 (low)\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.09\
2025-11-14 08:11:37,759 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:11:37,759 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 6 loops: 0.000\
2025-11-14 08:11:37,760 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: merchant_agent (domain: merchant)\
2025-11-14 08:11:37,760 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: merchant_agent\
2025-11-14 08:11:37,760 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.355 (AIConfidenceLevel.LOW)\
2025-11-14 08:11:37,760 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:11:37,760 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:11:37,760 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: merchant_agent\
2025-11-14 08:11:37,761 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence merchant agent starting\
2025-11-14 08:11:37,761 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u55356 \u57322  Merchant agent analyzing investigation\
2025-11-14 08:11:37,761 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for merchant_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:11:37,761 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] \uc0\u55357 \u56522  Merchant agent processing Snowflake data:\
2025-11-14 08:11:37,761 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data type: dict\
2025-11-14 08:11:37,761 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data keys: ['results', 'row_count', 'columns', 'database', 'schema', 'table', 'query_insights', 'query_validation', 'evidence_completeness', 'query_status', 'execution_timestamp', 'execution_duration_ms', 'schema_info']\
2025-11-14 08:11:37,761 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data['results'] count: 0\
2025-11-14 08:11:37,761 [WARNING] app.service.agent.orchestration.domain_agents.merchant_agent: [] \uc0\u9888 \u65039  Merchant agent: No results extracted from snowflake_data\
2025-11-14 08:11:37,761 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7.4] \uc0\u55357 \u56615  Tool Results Aggregation - 1 tool results available for LLM analysis\
2025-11-14 08:11:37,761 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7.4] \uc0\u55357 \u56522  Tool Result Keys: ['snowflake_query_tool']\
2025-11-14 08:11:37,761 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:11:37,761 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 1\
2025-11-14 08:11:37,761 [INFO] app.service.agent.evidence_analyzer: []    Tool names: ['snowflake_query_tool']\
2025-11-14 08:11:37,761 [INFO] app.service.agent.evidence_analyzer: []    snowflake_query_tool: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TX...\
2025-11-14 08:11:37,761 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:11:37,761 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:11:37,761 [INFO] app.service.agent.evidence_analyzer: []    No transaction records found in Snowflake\
2025-11-14 08:11:37,761 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:11:37,762 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 0 raw records \u8594  formatted summary\
2025-11-14 08:11:37,762 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:11:37,762 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a merchant analysis expert.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transactions in short time) = HIGH fraud signal\
- Amount clustering (identical amounts in rapid succession) = HIGH fraud signal  \
- IP rotation (same device, multiple IPs) = MEDIUM-HIGH fraud signal\
- Device-IP m...\
2025-11-14 08:11:37,762 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3266 chars)\
2025-11-14 08:11:37,762 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this merchant domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
\uc0\u9888 \u65039  LOW EVIDENCE VOLUME DETECTED: Only 0 event(s) available. You MAY assign LOW risk (\u8804 0.3) or explicitly state 'needs more evidence' with low confidence. Do NOT assign high risk scores with insufficient evidence UNLESS fraud patterns are detected.\
\
## Entity Information\
- Type: email\
- ID: meiling.soto.garrido@gmail.com\
- Domain: merchant\
\
## Evidence Collected\
No evidence collected\
\
## Metrics and Data Points\
No metrics available\
\
## Snowflake Context\
No transaction records found in Snowflake\
\
## Tool Execution Results\
Tool Execution Results - ALL data signals from external fraud detection tools:\
\
\
**Snowflake Query Tool**:\
  - Output: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS", "query_insights": \{"contains_fraud_analysis": false, "contains_user_analysis": true, "contains_p\
  - (Total length: 1380 characters)\
\
CRITICAL: The Tool Execution Results section contains ALL data signals from external tools that were executed.\
You MUST consider these tool results as primary evidence sources when assessing fraud risk.\
Each tool result represents direct intelligence gathering from specialized fraud detection systems.\
\
DATA GAP ANALYSIS:\
If tool results show "No tool execution results available" or are missing, you MUST:\
- Explicitly list which analyses cannot be performed (IP reputation, device reputation, email reputation, etc.)\
- Explain how missing data affects your confidence level\
- Prioritize which missing data sources are most critical for assessment\
- Format as: "CRITICAL DATA GAP: [Missing data type] - Impact: [How it affects assessment]"\
\
## Analysis Requirements\
Provide a comprehensive fraud risk assessment based ONLY on ALL the evidence above (including tool results):\
\
1. **RISK SCORE**: (0.0 to 1.0) - Must be justified by evidence\
2. **CONFIDENCE**: (0.0 to 1.0) - Based on evidence quality and completeness\
3. **RISK FACTORS**: List specific factors that increase/decrease risk\
4. **REASONING**: Detailed explanation of your risk assessment (reference tool results where applicable)\
5. **RECOMMENDATIONS**: Specific actions based on your findings\
\
CRITICAL: In your RECOMMENDATIONS section, you MUST:\
- Extract and include EXACT values mentioned in the evidence (IP addresses, device fingerprints, email addresses)\
- Format recommendations as: "[PRIORITY] Action: specific_value"\
- Include specific IPs, devices, emails to check (don't use generic "check IP reputation")\
- Example: "[CRITICAL] Check IP reputation for 2404:c0:2910::99:43cc and 2404:c0:2910::8e:2237"\
- Prioritize recommendations (CRITICAL, HIGH, MEDIUM, LOW)\
\
Format your response clearly with these sections. Be precise and evidence-based.\
REMINDER: You MUST provide a numeri...\
2025-11-14 08:11:37,762 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3050 chars)\
[2025-11-14T08:12:04-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:12:04,507 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:12:04,507 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE (0.0\'961.0)\
0.15\
\
CONFIDENCE (0.0\'961.0)\
0.18\
\
KEY RISK FACTORS\
- Incomplete / absent transaction data: No transactions found in Snowflake (row_count = 0) \'97 primary driver of low confidence.\
- Use of a free email address: entity is meiling.soto.garrido@gmail.com (free provider can be a mild risk signal vs. a verified corporate domain).\
- No behavioral/fraud patterns observed in available evidence (no velocity, no identical amounts, no IP/device data).\
\
DETAILED REASONING\
- Evidence baseline: The tool outputs and Snowflake query both show no results. Snowflake Query Tool output: \{"results": [], "row_count": 0, "columns": [], "database": "DBT", "schema": "DBT_PROD", "table": "TXS"\}. The Tool Execution Results section explicitly states ALL external tool signals were used and returned no data.\
- Because there are 0 events and no transaction records, there are no detectable behavioral anomalies (velocity bursts, identical amounts, amount clustering, IP rotation, device-IP mismatch). The CRITICAL EXCEPTION and CRITICAL PATTERN DETECTION rules require observed patterns to escalate risk; none are present.\
- Given the evidence-volume rule (0 events), the appropriate posture is low risk or "needs more evidence." I assign a numeric LOW risk (0.15) because there are no direct fraud signals in the provided data, but the absence of data prevents higher confidence.\
- Confidence is low (0.18) because critical inputs for a robust fraud assessment are missing (transactions, IPs, device fingerprints, timing, amounts, geolocation, historical behavior).\
- No MODEL_SCORE or other model-derived scores were used or cited in the justification.\
\
CRITICAL DATA GAP ANALYSIS (explicit)\
- CRITICAL DATA GAP: Transaction history / Snowflake TXS records - Impact: Cannot evaluate velocity bursts, amount clustering, or transaction-level fraud indicators.\
- CRITICAL DATA GAP: IP addresses and connection logs - Impact: Cannot evaluate IP reputation, IP rotation, geolocation anomalies, or device-IP mismatch.\
- CRITICAL DATA GAP: Device fingerprints (device IDs, UA strings) - Impact: Cannot detect device reuse, device rotation, or device-IP contradictions.\
- CRITICAL DATA GAP: Transaction amounts / timestamps - Impact: Cannot detect identical-amount patterns or bursts.\
- CRITICAL DATA GAP: Email reputation and account metadata (age, recovery info) - Impact: Limits ability to assess fraudulent account likelihood tied to the email meiling.soto.garrido@gmail.com.\
- CRITICAL DATA GAP: Chargeback/dispute history and merchant dispute records - Impact: Cannot assess historical risk and patterns of abuse.\
- CRITICAL DATA GAP: Browser/OS and cookie/session data - Impact: Cannot determine session-level inconsistencies or fingerprinting signals.\
\
RECOMMENDATIONS (prioritized; include exact values from evidence)\
- [CRITICAL] Action: Query Snowflake DBT.DBT_PROD.TXS for any historical or archived transactions related to email meiling.soto.garrido@gmail.com (current query returned row_count = 0). Rationale: verify whether transactions exist under other keys/columns.\
- [HIGH] Action: Check email reputation for meiling.soto.garrido@gmail.com (blocklist/abuse feeds, account age, recent password resets). Rationale: free email address found in evidence; need reputation context.\
- [HIGH] Action: Search logs for any IP addresses, device IDs, or session IDs tied to meiling.soto.garrido@gmail.com in merchant systems (web server logs, payment gateway logs, auth logs). Rationale: these values are missing from evidence but are required to detect velocity/IP rotation/geo-anomalies.\
- [MEDIUM] Action: Collect and review device fingerprinting data and user-agent strings for sessions associated with this email (if available). Rationale: detect device rotation or device-IP mismatch.\
- [MEDIUM] Action: Pull chargeback and dispute history for accounts associated with meiling.soto.garrido@gmail.com across payment processors and merchant systems. Rationale: historical disputes increase fraud probability.\
- [LOW] Action: If email domain ownership checks are relevant, perform WHOIS / registration checks on the domain portion (gmail.com is public) and correlate with any merchant-provided account metadata.\
- [LOW] Action: If any transactions are located, extract exact timing and amounts and run pattern detection for:\
    - Velocity bursts (e.g., 3+ txns within 5 minutes)\
    - Identical amounts in rapid succession\
    - IP rotation (same device, multiple IPs)\
  (I cannot run these patterns now because no transaction/timing/IP/amount data were provided.)\
\
FINAL ASSESSMENT SUMMARY\
- Result: Low assessed fraud risk (0.15) based solely on the absence of any transactional or behavioral indicators in the provided evidence.\
- Caveat: Very low confidence (0.18) due to many critical data gaps. This assessment should be revisited immediately if any transaction, IP, device, or reputation data become available. If any of the CRITICAL PATTERN DETECTION signals (velocity bursts, identical a\
2025-11-14 08:12:04,507 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5098 chars)\
2025-11-14 08:12:04,509 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7] \uc0\u9989  Merchant analysis complete - Risk: 1.00\
2025-11-14 08:12:04,512 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for merchant_agent: 26748ms, 2 steps\
2025-11-14 08:12:04,512 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u9989  Merchant analysis complete - Evidence collected: 1 points\
2025-11-14 08:12:04,518 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:12:04,566 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:12:04-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:12:04-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
2025-11-14 08:12:04,617 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:12:04,620 [INFO] app.service.etag_service: [olorin_tid=8d5f07f9-554a-4616-b737-fd6f7f68d036, investigation_id=478e5f56-a978-40ab-a72a-9fb4b24cd328] etag_retrieved\
2025-11-14 08:12:04,621 [INFO] uvicorn.access: [] 127.0.0.1:58902 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:12:05,023 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:12:05,023 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: [] \uc0\u9989  Merchant validation service initialized\
2025-11-14 08:12:05,023 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: [] \uc0\u55357 \u56589  Running merchant validation for investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:12:05,023 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: []    Entity: email=meiling.soto.garrido@gmail.com\
2025-11-14 08:12:05,023 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: []    Historical date: 2025-05-18\
2025-11-14 08:12:05,023 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
            TX_ID_KEY,\
            TX_DATETIME,\
            MERCHANT_NAME,\
            PAID_AMOUNT_VALUE_IN_CURRENCY,\
            MODEL_SCORE,\
            IS_FRAUD_TX\
        FROM DBT.DBT_PROD...\
2025-11-14 08:12:05,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 0 rows\
2025-11-14 08:12:05,708 [WARNING] app.service.agent.orchestration.domain_agents.merchant_validation: [] \uc0\u9888 \u65039  No historical data found for validation\
2025-11-14 08:12:05,708 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u9989  Merchant validation completed\
2025-11-14 08:12:05,714 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted merchant domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:12:05,714 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced merchant agent completed\
2025-11-14 08:12:05,714 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 6/6\
2025-11-14 08:12:05,715 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.369 (low)\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.09\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:12:05,716 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 6 loops: 0.000\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.369 (AIConfidenceLevel.LOW)\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:12:05,716 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:12:05,717 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.369 (low)\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:12:05,718 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 7 loops: 0.000\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.369 (AIConfidenceLevel.LOW)\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:12:05,718 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:12:05,720 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:12:05,720 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:12:05,721 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:12:05,721 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:12:05,721 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:12:59-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:12:59,652 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:12:59,652 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:12:59,652 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:12:59,656 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 53932ms, 2 steps\
2025-11-14 08:12:59,656 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 13 synthesis points\
2025-11-14 08:12:59,661 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:12:59,661 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:12:59,661 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:12:59,663 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:12:59,665 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:12:59,665 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:12:59,877 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:12:59,947 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:12:59,949 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:12:59,949 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 7 loops: 0.000\
2025-11-14 08:12:59,950 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:12:59,950 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:12:59,950 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:12:59,950 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:12:59,950 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:12:59,950 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:12:59,950 [INFO] uvicorn.access: [] 127.0.0.1:58902 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:12:59,951 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 8 loops: 0.000\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:12:59,951 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:12:59,952 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:12:59,952 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:12:59,952 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:12:59,953 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:12:59,953 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:12:59,953 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:12:59,953 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:12:59,953 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:13:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:13:48,717 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:13:48,717 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:13:48,717 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:13:48,719 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 48764ms, 2 steps\
2025-11-14 08:13:48,719 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:13:48,725 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:13:48,725 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:13:48,725 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:13:48,727 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:13:48,730 [INFO] app.service.etag_service: [investigation_id=c9023e09-23f0-4c21-a7d3-5b1b2e5875a7, olorin_tid=d2e74785-5d93-4853-aaac-0f2f07abe6cb] etag_retrieved\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:13:48,732 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 8 loops: 0.000\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:13:48,732 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:13:48,733 [INFO] uvicorn.access: [] 127.0.0.1:58902 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:13:48,734 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:13:48,734 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:13:48,734 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.12\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:13:48,735 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 9 loops: 0.000\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:13:48,735 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:13:48,736 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:13:48,737 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:13:48,737 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:13:48,737 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:13:48,737 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:14:22-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:14:22,252 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:14:22,252 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:14:22,252 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:14:22,255 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 33515ms, 2 steps\
2025-11-14 08:14:22,255 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:14:22,261 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:14:22,261 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:14:22,261 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:14:22,263 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:14:22,266 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:14:22,266 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:14:22,472 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:14:22,542 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.12\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:14:22,544 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 9 loops: 0.000\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:14:22,544 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:14:22,545 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:14:22,545 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:14:22,545 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:14:22,545 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:14:22,545 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.12\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:14:22,546 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 10 loops: 0.000\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:14:22,546 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:14:22,547 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:14:22,547 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:14:22,548 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:14:22,548 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:14:22,548 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:15:01-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:15:01,457 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:15:01,457 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:15:01,457 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:15:01,460 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 38909ms, 2 steps\
2025-11-14 08:15:01,460 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:15:01,466 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:15:01,466 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:15:01,466 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:15:01,469 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:15:01,472 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.12\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:15:01,473 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 10 loops: 0.000\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:15:01,473 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:15:01,474 [INFO] uvicorn.access: [] 127.0.0.1:59753 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:15:01,475 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 11 loops: 0.000\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:15:01,475 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:15:01,476 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:15:01,477 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:15:01,477 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:15:01,477 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:15:01,477 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:15:44-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:15:44,600 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:15:44,604 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:15:44,605 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:15:44,624 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 43135ms, 2 steps\
2025-11-14 08:15:44,624 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:15:44,639 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:15:44,640 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:15:44,640 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:15:44,644 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:15:44,656 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:15:44,656 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:15:44,915 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:15:44,987 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:15:44,992 [INFO] app.service.etag_service: [investigation_id=33b0a0b7-3123-4ea6-8c40-f676f4fcbb60, olorin_tid=16a20de8-4021-4c6b-9a7c-9e0c4987ca45] etag_retrieved\
2025-11-14 08:15:44,994 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:15:44,995 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:15:44,995 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 11 loops: 0.000\
2025-11-14 08:15:44,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:15:44,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:15:44,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:15:44,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:15:44,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:15:44,996 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:15:44,997 [INFO] uvicorn.access: [] 127.0.0.1:59753 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:15:44,998 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 12 loops: 0.000\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:15:44,998 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:15:44,999 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:15:44,999 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:15:44,999 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:15:44,999 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:15:45,000 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:15:45,000 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:15:45,001 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:15:45,001 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:15:45,001 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:16:12-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:16:12,695 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:16:12,695 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:16:12,695 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:16:12,698 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 27695ms, 2 steps\
2025-11-14 08:16:12,698 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:16:12,703 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:16:12,704 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:16:12,704 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:16:12,706 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:16:12,708 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:16:12,709 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 12 loops: 0.000\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:16:12,709 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:16:12,710 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:16:12,710 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:16:12,711 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 13 loops: 0.000\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:16:12,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:16:12,712 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:16:12,713 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:16:12,713 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:16:12,713 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:16:12,713 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:16:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:16:48,222 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:16:48,222 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:16:48,222 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:16:48,224 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 35509ms, 2 steps\
2025-11-14 08:16:48,224 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:16:48,230 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:16:48,230 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:16:48,230 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:16:48,232 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:16:48,235 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:16:48,235 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:16:48,436 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:16:48,502 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:16:48,504 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:16:48,504 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:16:48,504 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:16:48,504 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:16:48,504 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:16:48,505 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 13 loops: 0.000\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:16:48,505 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:16:48,505 [INFO] uvicorn.access: [] 127.0.0.1:60310 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.15\
2025-11-14 08:16:48,506 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:16:48,506 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 14 loops: 0.000\
2025-11-14 08:16:48,507 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:16:48,507 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:16:48,507 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:16:48,507 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:16:48,507 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:16:48,507 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:16:48,508 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:16:48,508 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:16:48,508 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:16:48,508 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:16:48,508 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:17:18-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:17:18,791 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:17:18,791 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:17:18,791 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:17:18,794 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 30283ms, 2 steps\
2025-11-14 08:17:18,794 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:17:18,799 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:17:18,799 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:17:18,799 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:17:18,802 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:17:18,805 [INFO] app.service.etag_service: [olorin_tid=10729a55-284f-4931-8a39-e28fb834f5c7, investigation_id=9c8f077f-9ad0-4492-a493-5646d35b8b56] etag_retrieved\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.15\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:17:18,807 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 14 loops: 0.000\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:17:18,807 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:17:18,808 [INFO] uvicorn.access: [] 127.0.0.1:60310 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.15\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:17:18,809 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 15 loops: 0.000\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:17:18,809 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:17:18,810 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:17:18,811 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:17:18,811 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:17:18,811 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:17:18,811 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:17:52-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:17:52,949 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:17:52,949 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:17:52,949 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:17:52,951 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 34138ms, 2 steps\
2025-11-14 08:17:52,952 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:17:52,956 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:17:52,957 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:17:52,957 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:17:52,959 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:17:52,961 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:17:52,961 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:17:53,189 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:17:53,259 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.15\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:17:53,262 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 15 loops: 0.000\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:17:53,262 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:17:53,263 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:17:53,263 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:17:53,263 [INFO] uvicorn.access: [] 127.0.0.1:60310 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.16\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:17:53,264 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 16 loops: 0.000\
2025-11-14 08:17:53,264 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:17:53,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:17:53,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:17:53,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:17:53,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:17:53,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:17:53,266 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:17:53,266 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:17:53,266 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:17:53,266 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:17:53,266 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:18:32-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:18:32,297 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:18:32,297 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:18:32,297 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:18:32,299 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 39031ms, 2 steps\
2025-11-14 08:18:32,299 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:18:32,304 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:18:32,305 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:18:32,305 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:18:32,307 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:18:32,309 [INFO] app.service.etag_service: [olorin_tid=416865ae-7a71-4d5e-ad81-905efa3fad45, investigation_id=c9504bd2-4c45-4e31-a499-c0523d68e124] etag_retrieved\
2025-11-14 08:18:32,310 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.16\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:18:32,311 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 16 loops: 0.000\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:18:32,311 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:18:32,312 [INFO] uvicorn.access: [] 127.0.0.1:60310 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.16\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:18:32,313 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 17 loops: 0.000\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:18:32,313 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:18:32,314 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:18:32,315 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:18:32,315 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:18:32,315 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:18:32,315 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:19:11-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:19:11,423 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:19:11,423 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:19:11,423 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:19:11,426 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 39108ms, 2 steps\
2025-11-14 08:19:11,426 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:19:11,431 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:19:11,432 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:19:11,432 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:19:11,433 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-fa5c5cc6cfea: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:19:11,434 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9201 \u65039  Investigation auto-comp-fa5c5cc6cfea did not complete within 600 seconds\
2025-11-14 08:19:11,434 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  Failed to create historical investigation, falling back to transaction-based comparison...\
2025-11-14 08:19:11,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
                MIN(TX_DATETIME) as earliest_date,\
                MAX(TX_DATETIME) as latest_date,\
                COUNT(*) as tx_count\
            FROM DBT.DBT_PROD.TXS\
            WHERE TX_...\
2025-11-14 08:19:41,301 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:19:41,301 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:19:41,301 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Using default windows (no transaction date range found)\
2025-11-14 08:19:41,302 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-05-04T00:00:00-05:00' AND TX_DATETIME < '2025-05-18T00:00:00-05:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido@gmail.com'...\
2025-11-14 08:19:43,611 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:19:43,612 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:19:43,612 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-10-31T00:00:00-05:00' AND TX_DATETIME < '2025-11-14T00:00:00-05:00' AND EMAIL_NORMALIZED = 'meiling.soto.garrido@gmail.com'...\
2025-11-14 08:19:44,596 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:19:44,597 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:19:44,598 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email:meiling.soto.garrido@gmail.com in comparison windows. Window A: 0 transactions, Window B: 0 transactions. Skipping comparison - entity may not have sufficient historical data.\
2025-11-14 08:19:44,605 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:19:44,606 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:19:44,810 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:19:44,880 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.16\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:19:44,882 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 17 loops: 0.000\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:19:44,882 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:19:44,883 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:19:44,883 [INFO] uvicorn.access: [] 127.0.0.1:60310 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.18\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:19:44,884 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 18 loops: 0.000\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:19:44,884 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:19:44,886 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:19:44,886 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:19:44,886 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:19:44,886 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:19:44,886 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:20:22-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:20:22,103 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:20:22,104 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:20:22,104 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:20:22,108 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 37218ms, 2 steps\
2025-11-14 08:20:22,108 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:20:22,119 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:20:22,120 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:20:22,120 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:20:22,120 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 08:20:22,120 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Auto-Comparison 2/3\
2025-11-14 08:20:22,120 [INFO] app.service.investigation.auto_comparison: []    Entity: moeller2media@gmail.com\
2025-11-14 08:20:22,120 [INFO] app.service.investigation.auto_comparison: []    Entity Type: email\
2025-11-14 08:20:22,120 [INFO] app.service.investigation.auto_comparison: []    Risk Score: 0.393\
2025-11-14 08:20:22,120 [INFO] app.service.investigation.auto_comparison: []    Transactions: 20\
2025-11-14 08:20:22,120 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 08:20:22,121 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Running auto-comparison for entity: email=moeller2media@gmail.com\
2025-11-14 08:20:22,121 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Looking for historical investigations between 2025-05-18 and 2025-08-16\
2025-11-14 08:20:22,508 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  Investigation auto-comp-114a527271a9 is not completed (status: IN-PROGRESS), skipping...\
2025-11-14 08:20:22,509 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No historical investigation found - creating new investigation...\
2025-11-14 08:20:22,510 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-02T08:20:22.121090-05:00' AND TX_DATETIME < '2025-08-16T08:20:22.121090-05:00' AND EMAIL_NORMALIZED = 'moeller2media@gmail....\
2025-11-14 08:20:23,361 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:20:23,362 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:20:23,362 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-16T08:20:22.121090-05:00' AND TX_DATETIME < '2025-11-14T08:20:22.121090-05:00' AND EMAIL_NORMALIZED = 'moeller2media@gmail....\
2025-11-14 08:20:26,748 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:20:26,748 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:20:26,748 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found in desired historical window (2025-08-02 to 2025-08-16)\
2025-11-14 08:20:26,748 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Finding actual transaction date range for email=moeller2media@gmail.com...\
2025-11-14 08:20:26,749 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
                MIN(TX_DATETIME) as earliest_date,\
                MAX(TX_DATETIME) as latest_date,\
                COUNT(*) as tx_count\
            FROM DBT.DBT_PROD.TXS\
            WHERE TX_...\
2025-11-14 08:20:32,206 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:20:32,207 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:20:32,207 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56517  Found transaction date range for email=moeller2media@gmail.com: 2025-10-28 to 2025-11-13 (26 transactions)\
2025-11-14 08:20:32,207 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56517  Using actual transaction date range:\
2025-11-14 08:20:32,207 [INFO] app.service.investigation.auto_comparison: []    Historical window: 2025-10-28 to 2025-11-11\
2025-11-14 08:20:32,207 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating historical investigation:\
2025-11-14 08:20:32,207 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-10-28 to 2025-11-11\
2025-11-14 08:20:32,207 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating investigation auto-comp-3d0f6225dbb6 for email=moeller2media@gmail.com\
2025-11-14 08:20:32,207 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-10-28 to 2025-11-11\
2025-11-14 08:20:32,216 [INFO] app.service.investigation_trigger_service: [] Extracted structured investigation request for auto-comp-3d0f6225dbb6: entity_id=moeller2media@gmail.com, entity_type=email\
2025-11-14 08:20:32,216 [INFO] app.service.investigation_trigger_service: [] Initialized progress_json for investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,218 [INFO] app.service.investigation_trigger_service: [] State update verification for auto-comp-3d0f6225dbb6: lifecycle_stage=IN_PROGRESS, status=IN_PROGRESS, version=2, progress_json_initialized=True\
2025-11-14 08:20:32,219 [INFO] app.service.investigation_trigger_service: [] Updated investigation auto-comp-3d0f6225dbb6 state to IN_PROGRESS (version 1 -> 2)\
2025-11-14 08:20:32,220 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Triggering investigation execution for auto-comp-3d0f6225dbb6...\
2025-11-14 08:20:32,220 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Investigation auto-comp-3d0f6225dbb6 created and execution triggered, waiting for completion...\
2025-11-14 08:20:32,222 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9881 \u65039  BACKGROUND TASK STARTED: execute_structured_investigation for auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,222 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960 \u55357 \u56960 \u55357 \u56960  STARTING BACKGROUND INVESTIGATION: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,222 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-3d0f6225dbb6 already in IN_PROGRESS status\
2025-11-14 08:20:32,222 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960  STARTING REAL AUTONOMOUS INVESTIGATION: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,222 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verified entity information: email=moeller2media@gmail.com...\
2025-11-14 08:20:32,223 [INFO] app.service.agent.recursion_guard: [] Created execution context for investigation auto-comp-3d0f6225dbb6, thread auto-comp-3d0f6225dbb6-None\
2025-11-14 08:20:32,223 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u57057 \u65039  Created RecursionGuard context for investigation auto-comp-3d0f6225dbb6 with thread_id auto-comp-3d0f6225dbb6-None\
2025-11-14 08:20:32,223 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verification complete - execution can proceed for auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,223 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-3d0f6225dbb6 already in IN_PROGRESS status\
2025-11-14 08:20:32,226 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-3d0f6225dbb6: \{'status': 'in_progress', 'current_phase': 'agent_initialization'\}\
2025-11-14 08:20:32,227 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_initialization\
2025-11-14 08:20:32,227 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 0% | Phases: 0 completed\
2025-11-14 08:20:32,227 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_initialization\
2025-11-14 08:20:32,227 [WARNING] app.service.agent.journey_tracker: [] No active journey for investigation: auto-comp-3d0f6225dbb6. Creating emergency journey for node tracking.\
2025-11-14 08:20:32,227 [INFO] app.service.agent.journey_tracker: [] Started journey tracking for investigation: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,230 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-3d0f6225dbb6: \{'current_phase': 'agent_initialization', 'progress_percentage': 5.0, 'status': 'in_progress'\}\
2025-11-14 08:20:32,230 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55357 \u56615  Creating REAL LangGraph agent system for auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,231 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 08:20:32,231 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 08:20:32,270 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:20:32,270 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:20:32,272 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:20:32,274 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:20:32,274 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:20:32,274 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:20:32,274 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:20:32,274 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:20:32,278 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:20:32,278 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:20:32,281 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:20:32,286 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 08:20:32,286 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  context_preparation\
2025-11-14 08:20:32,286 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 25% | Phases: 1 completed\
2025-11-14 08:20:32,286 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: context_preparation\
2025-11-14 08:20:32,289 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-3d0f6225dbb6: \{'current_phase': 'context_preparation', 'progress_percentage': 15.0\}\
2025-11-14 08:20:32,289 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55358 \u56800  Creating REAL agent context for auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,289 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56589  EXECUTING REAL AGENT INVESTIGATION: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,289 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_execution\
2025-11-14 08:20:32,289 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 50% | Phases: 2 completed\
2025-11-14 08:20:32,289 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_execution\
2025-11-14 08:20:32,291 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-3d0f6225dbb6: \{'current_phase': 'agent_execution', 'progress_percentage': 25.0\}\
2025-11-14 08:20:32,291 [INFO] app.router.controllers.investigation_agent_tracking: [] \uc0\u55357 \u56523  ATTEMPTING TO LOG LLM INTERACTION FOR: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,291 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  LLM Call: MultiAgentOrchestrator \u8594  gpt-4o\
2025-11-14 08:20:32,291 [INFO] app.service.logging.autonomous_investigation_logger: []            Tools: langgraph_parallel_execution | Tokens: 124.80000000000001\
2025-11-14 08:20:32,291 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Initiating real structured investigation with Device, Location, Network, Logs, and Risk Analysis age...\
2025-11-14 08:20:32,291 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  Decision: DeviceAnalysisAgent \u8594  device_analysis_start\
2025-11-14 08:20:32,292 [INFO] app.service.logging.autonomous_investigation_logger: []            Confidence: 95.00 | Outcome: N/A\
2025-11-14 08:20:32,292 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Analyzing device fingerprint inconsistencies and spoofing indicators\
2025-11-14 08:20:32,292 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56598  INVOKING REAL AGENTS: Device, Location, Network, Logs, Risk Analysis\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager: Getting investigation graph\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Investigation: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u55357 \u56599  Service adapter: Getting investigation graph\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Investigation: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Entity type: email\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: [] \uc0\u55356 \u57263  Selecting investigation graph with typed results\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Investigation: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Entity type: email\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Fallback counter: 0\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    \uc0\u55358 \u56800  Hybrid intelligence graph selected\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_builders: [] \uc0\u55357 \u56615  Hybrid graph streaming: enabled\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u55357 \u56580  LEGACY: build_hybrid_investigation_graph called\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u10145 \u65039  Delegating to modular graph builder\
2025-11-14 08:20:32,292 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55357 \u56522  Parameters: enhanced_tools=True, streaming=True, interrupts=False, investigation_id=auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,293 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Building hybrid intelligence graph\
2025-11-14 08:20:32,293 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:20:32,293 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Enhanced tools: True\
2025-11-14 08:20:32,293 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Streaming enabled: True\
2025-11-14 08:20:32,293 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Creating hybrid intelligence graph foundation\
2025-11-14 08:20:32,293 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:20:32,296 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], tool_names: None\
2025-11-14 08:20:32,296 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:20:32,296 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:20:32,296 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], specific: None)\
2025-11-14 08:20:32,296 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:20:32,296 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56550  Loaded 18 tools for hybrid investigation\
2025-11-14 08:20:32,296 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u9989  [Hybrid] Using EnhancedToolNode with 18 tools and persistence enabled\
2025-11-14 08:20:32,297 [INFO] app.service.agent.orchestration.hybrid.graph.builders.node_factory: [] \uc0\u55356 \u57303 \u65039  Node factory completed: 16 nodes created\
2025-11-14 08:20:32,297 [INFO] app.service.agent.orchestration.hybrid.graph.builders.memory_provider: [] \uc0\u55357 \u57057 \u65039  Using in-memory storage for hybrid graph (Redis checkpoint unavailable)\
2025-11-14 08:20:32,317 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u9989  Hybrid intelligence graph compiled successfully\
2025-11-14 08:20:32,317 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Nodes: 19\
2025-11-14 08:20:32,317 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:20:32,317 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u9989  LEGACY: Graph building delegated successfully\
2025-11-14 08:20:32,317 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57263  100% backward compatibility maintained\
2025-11-14 08:20:32,317 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57303 \u65039  Using modular architecture with 14 components\
2025-11-14 08:20:32,317 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u9989  Investigation graph ready: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,318 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u9989  Investigation graph ready: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,318 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56800  Using Hybrid Intelligence graph for investigation: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,318 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56960  EXECUTING CLEAN GRAPH ORCHESTRATION (replacing old agent service)\
2025-11-14 08:20:32,326 [INFO] app.service.etag_service: [olorin_tid=801a042f-3601-4085-86ac-989a63471f23, investigation_id=d869a282-2a97-4dc4-893a-bee0fcbf340e] etag_retrieved\
2025-11-14 08:20:32,328 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.18\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:20:32,329 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 18 loops: 0.000\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:20:32,329 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:20:32,331 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56615  Enhanced Tool Execution Logger initialized for investigation: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,331 [INFO] app.service.agent.orchestration.investigation_coordinator: [] \uc0\u55357 \u56613  START_INVESTIGATION FUNCTION CALLED \u55357 \u56613 \
2025-11-14 08:20:32,331 [INFO] app.service.agent.orchestration.investigation_coordinator: [] [start_investigation] initiating fraud investigation flow\
2025-11-14 08:20:32,331 [INFO] app.service.agent.orchestration.investigation_coordinator: [] [start_investigation] Using hybrid state structure - extracting from state\
2025-11-14 08:20:32,331 [INFO] app.service.agent.orchestration.investigation_coordinator: [] \uc0\u55357 \u56589  Hybrid state parameters: entity_id=moeller2media@gmail.com, entity_type=email, investigation_id=auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,331 [INFO] app.service.agent.orchestration.investigation_coordinator: [] Set investigation context for auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,331 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u9989  Hybrid investigation started: auto-comp-3d0f6225dbb6\
2025-11-14 08:20:32,332 [INFO] uvicorn.access: [] 127.0.0.1:60310 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.21\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:20:32,333 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 19 loops: 0.000\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:20:32,333 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:20:32,334 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Starting data retrieval\
2025-11-14 08:20:32,334 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Entity=moeller2media@gmail.com (type: email)\
2025-11-14 08:20:32,334 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: SnowflakeProvider provider initialized\
2025-11-14 08:20:32,334 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Executing query for email=moeller2media@gmail.com (column: EMAIL)\
2025-11-14 08:20:32,335 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT\
                        TX_ID_KEY,\
                        EMAIL,\
                        IP,\
                        PAID_AMOUNT_VALUE_IN_CURRENCY,\
                        PAID_AMOUNT_CURRENCY...\
2025-11-14 08:20:32,434 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 26 rows\
2025-11-14 08:20:32,434 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 26 rows returned\
2025-11-14 08:20:32,434 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u9989  DATABASE FETCH: Retrieved 26 transactions (query limit: 2000, matched: 26 for email=moeller2media@gmail.com)\
2025-11-14 08:20:32,434 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Tracked as tool usage (total tools: 1)\
2025-11-14 08:20:32,436 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:20:32,437 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:20:32,437 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:20:32,437 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:20:32,437 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:21:15-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:21:15,524 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:21:15,524 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:21:15,524 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:21:15,527 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 43088ms, 2 steps\
2025-11-14 08:21:15,527 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:21:15,533 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:21:15,533 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:21:15,533 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:21:15,535 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:21:15,535 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:21:15,743 [INFO] app.service.rag.investigation_indexer: [] Found 156 investigations with status='COMPLETED'\
2025-11-14 08:21:15,814 [INFO] app.service.rag.investigation_indexer: [] Indexed 0 new/updated investigations out of 156 checked\
2025-11-14 08:21:15,815 [CRITICAL] app.service.agent.orchestration.enhanced_routing: [] \uc0\u55357 \u56613  DEBUGGING: raw_data_or_investigation_routing CALLED\
2025-11-14 08:21:15,815 [CRITICAL] app.service.agent.orchestration.enhanced_routing: [] \uc0\u55357 \u56613  DEBUGGING: Investigation ID: auto-comp-3d0f6225dbb6\
2025-11-14 08:21:15,815 [INFO] app.service.agent.orchestration.enhanced_routing: [] Determining investigation routing: raw data vs standard flow\
2025-11-14 08:21:15,815 [INFO] app.service.agent.orchestration.enhanced_routing: [] Database transaction data detected (26 rows from snowflake) - routing to standard fraud investigation (CSV data not found in messages)\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.21\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:21:15,817 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 19 loops: 0.000\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:21:15,817 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:21:15,818 [INFO] uvicorn.access: [] 127.0.0.1:60310 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:21:15,819 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: [] \uc0\u55358 \u56800  Hybrid-aware assistant preparing LLM context with AI recommendations\
2025-11-14 08:21:15,819 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: []    \uc0\u55358 \u56598  Running LLM with AI guidance context\
2025-11-14 08:21:15,842 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:21:15,842 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:21:15,842 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:21:15,842 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:21:15,842 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:21:15,842 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:21:15,842 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:21:15,842 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:21:15,842 [INFO] app.service.llm_manager: [] \uc0\u55357 \u56580  bind_tools called on GPT-5 Responses API wrapper - falling back to Chat Completions API for tool support\
2025-11-14 08:21:15,842 [INFO] app.service.llm_manager: []    Tools to bind: 18\
2025-11-14 08:21:15,873 [INFO] app.service.agent.orchestration.assistant: [] \uc0\u9989  Created investigation-context-aware system message for email=moeller2media@gmail.com\
2025-11-14 08:21:15,873 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u57057 \u65039  LLM Resilience Configuration:\
2025-11-14 08:21:15,873 [INFO] app.service.agent.orchestration.llm_resilience: []    Timeout: 60s\
2025-11-14 08:21:15,873 [INFO] app.service.agent.orchestration.llm_resilience: []    Max Retries: 3\
2025-11-14 08:21:15,873 [INFO] app.service.agent.orchestration.llm_resilience: []    Initial Retry Delay: 1.0s\
2025-11-14 08:21:15,873 [INFO] app.service.agent.orchestration.llm_resilience: []    Backoff Multiplier: 2.0x\
2025-11-14 08:21:15,873 [INFO] app.service.agent.orchestration.llm_resilience: []    Max Retry Delay: 30.0s\
2025-11-14 08:21:15,873 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 1/4\
2025-11-14 08:21:15,878 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.23\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 2\
2025-11-14 08:21:15,879 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  HIGH: Orchestrator loop limit approaching: 20/25\
2025-11-14 08:21:15,879 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 20 loops: 0.000\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:21:15,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:21:15,880 [INFO] app.service.etag_service: [olorin_tid=682ad965-30dd-4c62-8b75-3cd12cdae342, investigation_id=e57b858b-3d54-49e3-a1c5-b8ba27892c8e] etag_retrieved\
2025-11-14 08:21:15,881 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:21:15,882 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:21:15,882 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:21:15,882 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:21:15,882 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:22:03-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:22:03,929 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:22:03,929 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:22:03,929 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 1.00\
2025-11-14 08:22:03,932 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 48048ms, 2 steps\
2025-11-14 08:22:03,932 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:22:03,939 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-fa5c5cc6cfea (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:22:03,939 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:22:03,939 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:22:03,941 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:22:03,942 [INFO] uvicorn.access: [] 127.0.0.1:60310 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.23\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 2\
2025-11-14 08:22:03,944 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  HIGH: Orchestrator loop limit approaching: 20/25\
2025-11-14 08:22:03,944 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 20 loops: 0.000\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:22:03,944 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:22:03,945 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.382 (low)\
2025-11-14 08:22:03,945 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:22:03,945 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:22:03,946 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u55357 \u57000  Immediate termination required: 2 critical concerns\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: emergency\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: False\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: True\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 1.00\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 3\
2025-11-14 08:22:03,946 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  CRITICAL: Orchestrator loop limit approaching: 21/12\
2025-11-14 08:22:03,946 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  CRITICAL: High resource pressure: 1.00\
2025-11-14 08:22:03,946 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 21 loops: 0.000\
2025-11-14 08:22:03,946 [WARNING] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55357 \u57000  Emergency termination required\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: summary\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.382 (AIConfidenceLevel.LOW)\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: True\
2025-11-14 08:22:03,946 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: summary\
2025-11-14 08:22:03,946 [WARNING] app.service.agent.orchestration.hybrid.intelligent_router: []    \uc0\u9888 \u65039  Safety override: emergency_termination\
2025-11-14 08:22:03,947 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u55357 \u56523  Hybrid Intelligence summary generation starting\
2025-11-14 08:22:03,947 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Confidence consolidated: 0.000 (MINIMAL)\
2025-11-14 08:22:03,950 [INFO] app.service.agent.orchestration.risk.evidence_gating: [] \uc0\u55357 \u57057 \u65039  Evidence gating: Risk capped at 0.400 due to capped_for_low_evidence\
2025-11-14 08:22:03,950 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Evidence gating applied: strength=0.360\
2025-11-14 08:22:03,950 [INFO] app.service.agent.orchestration.risk.policy: [] \uc0\u55357 \u56594  LLM narrative isolation: Updated 7 domains - ['network', 'device', 'location', 'logs', 'authentication', 'merchant', 'risk']\
2025-11-14 08:22:03,950 [INFO] app.service.agent.orchestration.risk.policy: []    Engine math will now exclude LLM claimed_risk from all calculations\
2025-11-14 08:22:03,952 [INFO] app.service.agent.orchestration.risk.finalize: [] Cross-domain deduplication: removed 1 duplicate paragraphs\
2025-11-14 08:22:03,952 [INFO] app.service.agent.orchestration.risk.finalize: [] Evidence strength computed: 0.550 (diversity: 0.10, corroboration: 0.30, volume: 0.05, quality: 0.10) [internal: True, external: 0, domains: 7]\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.risk.finalize: [] \uc0\u55357 \u56589  compute_final_risk: domain_findings type=<class 'dict'>, keys=['network', 'device', 'location', 'logs', 'authentication', 'merchant', 'risk']\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.risk.finalize: []    logs: risk_score=1.0\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.risk.finalize: []    network: risk_score=1.0\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.risk.finalize: []    device: risk_score=1.0\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.risk.finalize: []    location: risk_score=1.0\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.risk.finalize: []    authentication: risk_score=1.0\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u9989  EVIDENCE GATING: PASS (scores=5, signals=6)\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: numeric_domains=['logs', 'network', 'device', 'location', 'authentication']\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: scores=[1.0, 1.0, 1.0, 1.0, 1.0]\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: pre_gate=1.000, final=1.000, gate=PASS\
2025-11-14 08:22:03,954 [INFO] app.service.agent.orchestration.risk.policy: [] \uc0\u55357 \u56580  RECONCILED: is_public for meiling.soto.garrido@gmail.com: None \u8594  True\
2025-11-14 08:22:03,955 [ERROR] app.service.agent.orchestration.domain.linter: [] \uc0\u55357 \u57000  LINTING FAILURES DETECTED (1 issues):\
2025-11-14 08:22:03,955 [ERROR] app.service.agent.orchestration.domain.linter: []   1. state.risk_score (0.4) != final_risk (1.0)\
2025-11-14 08:22:03,955 [WARNING] app.service.agent.orchestration.risk.finalize: [] \uc0\u55357 \u57000  LINTING VIOLATIONS DETECTED: 1 issues before publishing risk\
2025-11-14 08:22:03,955 [WARNING] app.service.agent.orchestration.risk.finalize: []    LINT ERROR 1: state.risk_score (0.4) != final_risk (1.0)\
2025-11-14 08:22:03,955 [ERROR] app.service.agent.orchestration.domain.linter: [] \uc0\u55357 \u57000  LINTING FAILURES DETECTED (1 issues):\
2025-11-14 08:22:03,955 [ERROR] app.service.agent.orchestration.domain.linter: []   1. state.risk_score (0.4) != final_risk (1.0)\
2025-11-14 08:22:03,955 [WARNING] app.service.agent.orchestration.domain.linter: [] \uc0\u9888 \u65039   Investigation linting warnings: 1 issues\
2025-11-14 08:22:03,955 [WARNING] app.service.agent.orchestration.domain.linter: []   WARNING: state.risk_score (0.4) != final_risk (1.0)\
2025-11-14 08:22:03,955 [INFO] app.service.agent.orchestration.risk.finalize: [] \uc0\u55356 \u57263  Action plan generated: 4 recommendations for risk 1.000\
2025-11-14 08:22:03,955 [WARNING] app.service.agent.orchestration.risk.finalize: [] end_time missing - computing defensively to prevent crash\
2025-11-14 08:22:03,955 [WARNING] app.service.agent.orchestration.risk.finalize: [] \uc0\u9888 \u65039  FALLBACK: No valid timing data, using current time as end_time = 2025-11-14T13:22:03.955715+00:00\
2025-11-14 08:22:03,955 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Risk score finalized: 1.00\
2025-11-14 08:22:03,955 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Performance metrics finalized\
2025-11-14 08:22:03,955 [INFO] app.service.agent.orchestration.hybrid.canonical_outcome: [] \uc0\u9989  Canonical outcome built: completed for auto-comp-fa5c5cc6cfea\
2025-11-14 08:22:03,956 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Enhanced summary completed\
2025-11-14 08:22:03,956 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Duration: 0ms\
2025-11-14 08:22:03,956 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Final confidence: 0.000\
2025-11-14 08:22:03,956 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Canonical outcome: completed\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Hybrid Intelligence Graph investigation completion\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u55357 \u56522  Final Investigation Statistics:\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Investigation ID: auto-comp-fa5c5cc6cfea\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Total duration: 0ms\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Orchestrator loops: 21\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Domains completed: 7/6\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Tools used: 2\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Safety overrides: 0\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Final confidence: 0.000\
2025-11-14 08:22:03,958 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Investigation efficiency: 0.759\
2025-11-14 08:22:03,960 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56523  REAL AGENT SERVICE RESULT: # Hybrid Intelligence Investigation Summary\
\
## Investigation Details\
- **Investigation ID**: auto-comp-fa5c5cc6cfea\
- **Entity**: email - meiling.soto.garrido@gmail.com\
- **Duration**: 0ms (0.0 secon...\
2025-11-14 08:22:03,960 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  LLM Call: MultiAgentOrchestrator \u8594  gpt-4o\
2025-11-14 08:22:03,960 [INFO] app.service.logging.autonomous_investigation_logger: []            Tools: langgraph_parallel_execution, recursion_guard | Tokens: 343.8\
2025-11-14 08:22:03,960 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Completed real structured investigation execution in 797026ms with RecursionGuard protection.\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  Decision: DeviceAnalysisAgent \u8594  device_analysis_complete\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Confidence: 95.00 | Outcome: N/A\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Device analysis completed successfully with comprehensive findings\
2025-11-14 08:22:03,961 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u9989  REAL AGENT EXECUTION COMPLETED in 797026ms\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: DeviceAnalysisAgent (analysis_agent)\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 159405ms \uc0\u8594  LocationAnalysisAgent\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['device_analysis_completed']\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: LocationAnalysisAgent (analysis_agent)\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 159405ms \uc0\u8594  NetworkAnalysisAgent\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['location_analysis_completed']\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: NetworkAnalysisAgent (analysis_agent)\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 159405ms \uc0\u8594  LogsAnalysisAgent\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['network_analysis_completed']\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: LogsAnalysisAgent (analysis_agent)\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 159405ms \uc0\u8594  RiskAssessmentAgent\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['logs_analysis_completed']\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: RiskAssessmentAgent (synthesis_agent)\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 159405ms \uc0\u8594  END\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['all_analyses_completed', 'risk_assessment_completed']\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  results_processing\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 75% | Phases: 3 completed\
2025-11-14 08:22:03,961 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: results_processing\
2025-11-14 08:22:03,965 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-fa5c5cc6cfea: \{'current_phase': 'results_processing', 'progress_percentage': 85.0\}\
2025-11-14 08:22:03,965 [INFO] app.router.controllers.investigation_completion: [] \uc0\u55357 \u56523  REAL AGENT RESULT CONTENT: # Hybrid Intelligence Investigation Summary\
\
## Investigation Details\
- **Investigation ID**: auto-comp-fa5c5cc6cfea\
- **Entity**: email - meiling.soto.garrido@gmail.com\
- **Duration**: 0ms (0.0 seconds)\
- **Investigation Strategy**: unknown\
\
## AI Intelligence Analysis\
- **Final Confidence**: 0.000 (unknown)\
- **Orchestrator Loops**: 21\
- **Strategy Effectiveness**: Low\
- **Investigation Efficiency**: 0.000\
\
## Investigation Coverage\
- **Domains Analyzed**: 7/6\
- **Tools Utilized**: 1\
- **Data ...\
2025-11-14 08:22:03,965 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  results_processing\
2025-11-14 08:22:03,965 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 75% | Phases: 3 completed\
2025-11-14 08:22:03,965 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: results_processing\
2025-11-14 08:22:03,969 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-fa5c5cc6cfea: \{'current_phase': 'results_processing', 'progress_percentage': 85.0\}\
2025-11-14 08:22:03,969 [INFO] app.router.controllers.investigation_completion: [] \uc0\u55357 \u56523  REAL AGENT RESULT CONTENT: # Hybrid Intelligence Investigation Summary\
\
## Investigation Details\
- **Investigation ID**: auto-comp-fa5c5cc6cfea\
- **Entity**: email - meiling.soto.garrido@gmail.com\
- **Duration**: 0ms (0.0 seconds)\
- **Investigation Strategy**: unknown\
\
## AI Intelligence Analysis\
- **Final Confidence**: 0.000 (unknown)\
- **Orchestrator Loops**: 21\
- **Strategy Effectiveness**: Low\
- **Investigation Efficiency**: 0.000\
\
## Investigation Coverage\
- **Domains Analyzed**: 7/6\
- **Tools Utilized**: 1\
- **Data ...\
2025-11-14 08:22:03,970 [INFO] app.service.agent.journey_tracker: [] Completed journey tracking for investigation: auto-comp-fa5c5cc6cfea (225ms, 6 nodes)\
2025-11-14 08:22:03,974 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-fa5c5cc6cfea: \{'current_phase': 'completion', 'progress_percentage': 100.0, 'status': 'completed'\}\
2025-11-14 08:22:03,974 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: completed \u8594  completion\
2025-11-14 08:22:03,974 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 80% | Phases: 4 completed\
2025-11-14 08:22:03,974 [INFO] app.service.logging.autonomous_investigation_logger: []            Current Risk: 0.000\
2025-11-14 08:22:03,978 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-fa5c5cc6cfea: \{'status': 'completed', 'completion_time': '2025-11-14T13:22:03.974908+00:00', 'findings_summary': \{'risk_score': 0, 'findings': [\{'investigation_outcome': 'REAL structured investigation completed', 'total_agents_used': 5, 'investigation_duration_ms': 0, 'real_agent_execution': True\}], 'summary': '# Hybrid Intelligence Investigation Summary\\n\\n## Investigation Details\\n- **Investigation ID**: auto-comp-fa5c5cc6cfea\\n- **Entity**: email - meiling.soto.garrido@gmail.com\\n- **Duration**: 0ms (0.0 seconds)\\n- **Investigation Strategy**: unknown\\n\\n## AI Intelligence Analysis\\n- **Final Confidence**: 0.000 (unknown)\\n- **Orchestrator Loops**: 21\\n- **Strategy Effectiveness**: Low\\n- **Investigation Efficiency**: 0.000\\n\\n## Investigation Coverage\\n- **Domains Analyzed**: 7/6\\n- **Tools Utilized**: 1\\n- **Data Sources**: Snowflake, Additional Tools\\n\\n## Risk Assessment\\n- **Risk Score**: 1.000\\n- **Risk Indicators**: 6\\n- **Fraud Likelihood**: High\\n\\n## Safety and Compliance\\n- **Safety Overrides**: 0\\n- **Investigation Completed**: With Issues\\n- **Resource Utilization**: Efficient\\n\\n## Identified Risk Indicators\\n\\n- LLM Identified: - Factors decreasing apparent risk:\\n  - No transaction or behavioral evidence was found (reduces imm......', 'completed_at': '2025-11-14T13:22:03.974917+00:00'\}\}\
2025-11-14 08:22:03,978 [INFO] app.router.controllers.investigation_completion: [] Completed structured investigation: auto-comp-fa5c5cc6cfea\
2025-11-14 08:22:03,978 [INFO] app.service.agent.recursion_guard: [] Removed context for investigation auto-comp-fa5c5cc6cfea, final stats: \{'investigation_id': 'auto-comp-fa5c5cc6cfea', 'thread_id': 'auto-comp-fa5c5cc6cfea-None', 'duration_seconds': 797.0889458656311, 'current_depth': 0, 'max_depth_reached': 0, 'total_tool_calls': 0, 'unique_tools_used': 0, 'node_path': [], 'tool_sequence': []\}\
2025-11-14 08:22:03,978 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u57057 \u65039  Cleaned up RecursionGuard context for investigation auto-comp-fa5c5cc6cfea\
2025-11-14 08:22:03,978 [INFO] app.router.controllers.investigation_executor: [] Completed structured investigation: auto-comp-fa5c5cc6cfea\
2025-11-14 08:22:08,944 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=False, count=0\
[2025-11-14T08:22:09-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"\
2025-11-14 08:22:09,687 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u9989   LLM Invocation Successful: Attempt=1, Duration=53.81s, Total=53.81s\
2025-11-14 08:22:09,688 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56522   LLM Metadata: Model=gpt-5-mini-2025-08-07, InputTokens=3576, OutputTokens=255, TotalTokens=3831, Latency=53815ms\
2025-11-14 08:22:09,688 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: [] \uc0\u9989  Hybrid-aware assistant completed with LLM guidance\
2025-11-14 08:22:09,688 [INFO] app.service.agent.orchestration.hybrid.graph.builders.edge_configurator: [] \uc0\u9989  Tool calls detected: 1 tools\
2025-11-14 08:22:09,689 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  EnhancedToolNode.ainvoke called with input type: <class 'dict'>\
2025-11-14 08:22:09,689 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Input is dict with keys: ['messages', 'investigation_id', 'entity_id', 'entity_type', 'custom_user_prompt', 'current_phase', 'date_range_days', 'time_range', 'tool_count', 'snowflake_data', 'snowflake_completed', 'tools_used', 'tool_requests', 'tool_results', 'domain_findings', 'domains_completed', 'risk_score', 'risk_indicators', 'confidence_score', 'parallel_execution', 'max_tools', 'errors', 'retry_count', 'orchestrator_loops', 'tool_execution_attempts', 'phase_changes', 'routing_decisions', 'decision_audit_trail', 'start_time', 'end_time', 'total_duration_ms', 'agent_context', 'performance_metrics', 'hybrid_system_version', 'graph_selection_reason']\
2025-11-14 08:22:09,689 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  investigation_id found in input: auto-comp-3d0f6225dbb6\
2025-11-14 08:22:09,689 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Extracted 3 messages from dict input\
2025-11-14 08:22:09,690 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Found 1 tool calls in AIMessage\
2025-11-14 08:22:09,690 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Executing tool 1/1: snowflake_query_tool (id: call_ED97NGyPKSJ0IO52lgGHvPMO)\
2025-11-14 08:22:09,690 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Inferred agent name from state: network_agent\
2025-11-14 08:22:09,690 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Attempting to persist tool execution: investigation_id=auto-comp-3d0f6225dbb6, tool=snowflake_query_tool\
2025-11-14 08:22:09,690 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Getting database session for tool persistence\
2025-11-14 08:22:09,690 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Database session obtained, creating ToolExecutionService\
2025-11-14 08:22:09,690 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Persisting tool execution: investigation_id=auto-comp-3d0f6225dbb6, agent_name=network_agent, tool_name=snowflake_query_tool, status=running\
2025-11-14 08:22:09,691 [INFO] app.service.tool_execution_service: [] Persisted tool execution 5106f12f-d1fd-4edf-9298-0125b6b2767a for investigation auto-comp-3d0f6225dbb6: network_agent/snowflake_query_tool - running\
2025-11-14 08:22:09,691 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  \u9989  Tool execution persisted successfully: 5106f12f-d1fd-4edf-9298-0125b6b2767a\
2025-11-14 08:22:09,691 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Mapping tool name 'snowflake_query_tool' -> 'database_query' (PostgreSQL mode)\
2025-11-14 08:22:09,692 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: [] \uc0\u55357 \u57056 \u65039  TOOL EXECUTION STARTED: snowflake_query_tool\
2025-11-14 08:22:09,692 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Execution ID: snowflake_query_tool_1763126529692\
2025-11-14 08:22:09,692 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Investigation: None\
2025-11-14 08:22:09,692 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Entity: unknown - unknown\
2025-11-14 08:22:09,692 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Attempt: 1/1\
2025-11-14 08:22:09,694 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u55357 \u56772 \u65039  Connecting to Snowflake...\
2025-11-14 08:22:09,694 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Account: olorin_fraud.snowflakecomputing.com\
2025-11-14 08:22:09,694 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    User: manual_review_agent_ro\
2025-11-14 08:22:09,694 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Database: DBT\
2025-11-14 08:22:09,694 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Schema: DBT_PROD\
2025-11-14 08:22:09,694 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Warehouse: FRAUD_ANALYSIS_WH\
2025-11-14 08:22:09,695 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:22:09,741 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:22:09,742 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:22:09-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:22:09-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:22:12,328 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:22:12,328 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u9989  Snowflake connection established successfully\
2025-11-14 08:22:12,328 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u55357 \u56589  Executing Snowflake query...\
2025-11-14 08:22:12,328 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT * FROM DBT.DBT_PROD.TXS\
WHERE EMAIL = 'moeller2media@gmail.com'\
AND TX_DATETIME BETWEEN '2025-10-28T14:44:57.768000-04:00' AND '2025-11-11T14:44:57.768000-04:00'\
ORDER BY TX_DATETIME DESC\
LIMIT...\
2025-11-14 08:22:13,948 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:22:15,819 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:22:15,819 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:22:16,034 [INFO] app.service.rag.investigation_indexer: [] Found 157 investigations with status='COMPLETED'\
2025-11-14 08:22:16,047 [INFO] app.service.rag.vector_rag_service: [] Ingesting document 24083d28-098f-4a95-b53c-ed6e82b4b35d: 20 chunks to create\
[2025-11-14T08:22:16-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
[2025-11-14T08:22:16-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
[2025-11-14T08:22:16-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
[2025-11-14T08:22:17-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:22:17,857 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 23 rows\
2025-11-14 08:22:17,858 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: [] \uc0\u9989  Snowflake query completed successfully\
2025-11-14 08:22:17,858 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Duration: 8165ms\
2025-11-14 08:22:17,858 [INFO] app.service.agent.tools.snowflake_tool.snowflake_tool: []    Rows returned: 23\
2025-11-14 08:22:17,876 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: [] \uc0\u9989  TOOL EXECUTION COMPLETED: snowflake_query_tool\
2025-11-14 08:22:17,876 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Execution ID: snowflake_query_tool_1763126529692\
2025-11-14 08:22:17,876 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Duration: 8173ms\
2025-11-14 08:22:17,876 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Result Size: 1244592 bytes\
2025-11-14 08:22:17,876 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Record Count: 13\
2025-11-14 08:22:17,876 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Data Completeness: 1.000\
2025-11-14 08:22:17,876 [INFO] app.service.agent.orchestration.enhanced_tool_execution_logger: []    Result Hash: 484b45c3\
2025-11-14 08:22:17,876 [WARNING] app.service.agent.orchestration.enhanced_tool_execution_logger: [] \uc0\u9888 \u65039  Slow execution: 8173ms (threshold: 5000ms)\
[2025-11-14T08:22:18-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:22:18,034 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Disconnected from Snowflake\
2025-11-14 08:22:18,035 [WARNING] app.service.agent.orchestration.enhanced_tool_executor: [] Tool snowflake_query_tool took 8.35s (threshold: 5.0s)\
2025-11-14 08:22:18,068 [INFO] app.service.tool_execution_service: [] Updated tool execution 5106f12f-d1fd-4edf-9298-0125b6b2767a status to completed\
2025-11-14 08:22:18,068 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  \u9989  Tool snowflake_query_tool executed successfully, result type: <class 'dict'>\
2025-11-14 08:22:18,073 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Tool execution summary: 1 tool calls found, 1 results generated\
2025-11-14 08:22:18,073 [INFO] app.service.agent.orchestration.enhanced_tool_executor: [] \uc0\u55357 \u56615  Returning dict result with 1 messages\
2025-11-14 08:22:18,074 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56522  TRACKING: Tool metadata extraction\
2025-11-14 08:22:18,084 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56522  DATABASE DATA: Extracted from snowflake_query_tool (type: dict)\
2025-11-14 08:22:18,085 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56522  PHASE UPDATE: initialization \u8594  tool_execution\
2025-11-14 08:22:18,085 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u9989  TRACKING: Updated metadata for 1 tools\
2025-11-14 08:22:18,086 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.114 (low)\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: network_agent (domain: network)\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  ROUTING TO DOMAIN AGENT: network_agent\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: network_agent\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.114 (AIConfidenceLevel.LOW)\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:22:18,096 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: network_agent\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.114 (low)\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: network_agent (domain: network)\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  ROUTING TO DOMAIN AGENT: network_agent\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: network_agent\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.114 (AIConfidenceLevel.LOW)\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:22:18,107 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: network_agent\
2025-11-14 08:22:18,108 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence network agent starting\
2025-11-14 08:22:18,111 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] [Step 5.2.1] \uc0\u55356 \u57104  Network agent analyzing investigation\
2025-11-14 08:22:18,111 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for network_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:22:18,111 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Network agent processing Snowflake data:\
2025-11-14 08:22:18,111 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data type: dict\
2025-11-14 08:22:18,111 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data keys: ['results', 'row_count', 'columns', 'database', 'schema', 'table', 'query_insights', 'query_validation', 'evidence_completeness', 'query_status', 'execution_timestamp', 'execution_duration_ms', 'schema_info']\
2025-11-14 08:22:18,111 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data['results'] count: 23\
2025-11-14 08:22:18,111 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data['row_count']: 23\
2025-11-14 08:22:18,111 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Processed results count: 23\
2025-11-14 08:22:18,111 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Sample record structure (first record):\
2025-11-14 08:22:18,112 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Record keys: ['TABLE_RECORD_CREATED_AT', 'TABLE_RECORD_UPDATED_AT', 'EVENT_TYPE', 'ORIGINAL_TX_ID', 'STORE_ID', 'CLIENT_REQUEST_ID', 'APP_ID', 'TX_ID_KEY', 'SURROGATE_APP_TX_ID', 'NSURE_UNIQUE_TX_ID', 'UNIQUE_USER_ID', 'TX_DATETIME', 'TX_RECEIVED_DATETIME', 'TX_UPLOADED_TO_SNOWFLAKE', 'TX_TIMESTAMP_MS', 'IS_SENT_FOR_NSURE_REVIEW', 'AUTHORIZATION_STAGE', 'EMAIL', 'EMAIL_NORMALIZED', 'FIRST_NAME']\
2025-11-14 08:22:18,112 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Sample values: \{'TABLE_RECORD_CREATED_AT': '2025-11-11 08:15:50.507371', 'TABLE_RECORD_UPDATED_AT': '2025-11-11 08:15:50.507371', 'EVENT_TYPE': 'tx', 'ORIGINAL_TX_ID': '21814244-c75f-4a62-b7d3-1c8eb9454bed', 'STORE_ID': None\}\
2025-11-14 08:22:18,112 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Evidence collected from Snowflake data: 3 items\
2025-11-14 08:22:18,112 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Evidence 1: Geographic analysis: 1 unique country/countries found: ['ID']...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Evidence 2: Single country activity: ID...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Evidence 3: IP analysis: 3 unique IP address(es) found in transaction data...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Total evidence before LLM analysis: 3 items\
2025-11-14 08:22:18,112 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:22:18,112 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:22:18,112 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 23\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.397\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $2,444,022.00 across 23 transactions\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 23):\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:45:01.457000\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,764.00\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:44:28.044000\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,772.00\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:22:18,112 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:25:12.013000\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:23:33.732000\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:22:02.765000\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,785.00\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 23 raw records \u8594  formatted summary\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a network security expert specializing in IP reputation analysis, \
            geographic patterns, VPN detection, and network behavior analysis. You understand \
            network-based fraud indicators and can assess IP-related risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple tr...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3475 chars)\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this network domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: moeller2media@gmail.com\
- Domain: network\
\
## Evidence Collected\
- Geographic analysis: 1 unique country/countries found: ['ID']\
- Single country activity: ID\
- IP analysis: 3 unique IP address(es) found in transaction data\
\
## Metrics and Data Points\
- Unique Countries: 1\
- Unique Ip Count: 3\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 23\
- Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
- Average Model Score: 0.397\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $2,444,022.00 across 23 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 23):\
  Transaction 1:\
    - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
    - DateTime: 2025-11-11T07:45:01.457000\
    - Amount: $112,764.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
    - DateTime: 2025-11-11T07:44:28.044000\
    - Amount: $112,772.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
    - DateTime: 2025-11-11T07:25:12.013000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
    - DateTime: 2025-11-11T07:23:33.732000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
    - DateTime: 2025-11-11T07:22:02.765000\
    - Amount: $112,785.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTERNS DETECTED (PRIMARY INDICATORS):\
- VELOCITY BURST: 3 transactions in 5 minutes\
- AMOUNT CLUSTERING: $112,718.00 appears 2 times\
- DEVICE-IP MISM...\
2025-11-14 08:22:18,113 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5170 chars)\
[2025-11-14T08:23:05-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:23:05,415 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:23:05,415 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE (0.0-1.0)\
0.78\
\
CONFIDENCE (0.0-1.0)\
0.62\
\
RISK FACTORS (specific)\
- Velocity burst: 3 transactions in ~3 minutes on 2025-11-11 between 07:22:02.765 and 07:25:12.013 (transactions listed below).\
- Identical/clustered amounts: repeated high-value amounts in rapid succession (examples: $112,778.00 appears twice at 07:23:33.732 and 07:25:12.013; $112,785.00 at 07:22:02.765; $112,772.00 at 07:44:28.044; $112,764.00 at 07:45:01.457). Evidence also states $112,718.00 appears 2 times.\
- Device\'96IP mismatch / IP rotation: Evidence states Device 15aa5c03-c3c8-4baf-8df1-69156a... was seen on 2 different IPs (device-level IP rotation).\
- Multiple unique IPs: 3 unique IP addresses were observed across transactions (single country: ID), indicating some IP churn despite a single-country footprint.\
- High-dollar, repeated transaction volume: $2,444,022.00 across 23 transactions \'97 many transactions are ~ $112.7k each, suggesting templated/batch-like behavior.\
- All activity localized to one country (ID) \'97 concentration may indicate scripted/payment-batch abuse or regional fraud ring.\
\
FACTORS THAT DECREASE RISK (context)\
- No transactions are marked as confirmed fraud in the provided data.\
- No individual transaction was flagged as "High Risk" (>0.7) in the Snowflake summary (but per instructions, model scores are not used to justify risk).\
\
DETAILED REASONING (evidence-based)\
1) Velocity bursts (HIGH signal): The data contains an explicit VELOCITY BURST finding and supports it in the sample transactions:\
   - Transaction (ID truncated) 1 \'97 DateTime 2025-11-11T07:45:01.457000 \'97 Amount $112,764.00 \'97 IP 103.175.214.243 \'97 Device 4f20b111-f2c4-4991-ac6d-c08bf8...\
   - Transaction 2 \'97 DateTime 2025-11-11T07:44:28.044000 \'97 Amount $112,772.00 \'97 IP 103.175.214.243 \'97 Device 4f20b111-f2c4-4991-ac6d-c08bf8...\
   - Transaction 3 \'97 DateTime 2025-11-11T07:25:12.013000 \'97 Amount $112,778.00 \'97 IP 103.175.214.243 \'97 Device 4f20b111-f2c4-4991-ac6d-c08bf8...\
   - Transaction 4 \'97 DateTime 2025-11-11T07:23:33.732000 \'97 Amount $112,778.00 \'97 IP 103.175.214.243 \'97 Device 4f20b111-f2c4-4991-ac6d-c08bf8...\
   - Transaction 5 \'97 DateTime 2025-11-11T07:22:02.765000 \'97 Amount $112,785.00 \'97 IP 103.175.214.243 \'97 Device 4f20b111-f2c4-4991-ac6d-c08bf8...\
   From 07:22:02.765 \uc0\u8594  07:25:12.013 there are 3 transactions within \u8776 3m10s (transactions 3\'965), with two identical amounts ($112,778.00) within ~1m40s. Another pair occurred at 07:44:28.044 and 07:45:01.457 (33s apart). Multiple rapid high-value transactions present a classic fraud pattern (credential stuffing, automated checkout, or card testing at scale).\
\
2) Amount clustering / identical amounts (HIGH signal): Multiple transactions cluster in a narrow amount band ($112,7xx) and identical amounts ($112,778.00 appears at least twice in the sample). The FRAUD PATTERNS entry also notes $112,718.00 appears twice. Identical or tightly clustered large amounts are indicative of templated/batch processing or automated abuse.\
\
3) Device\'96IP mismatch / IP rotation (MED-HIGH signal): The FRAUD PATTERNS call out Device 15aa5c03-c3c8-4baf-8df1-69156a... being used with 2 different IPs \'97 an indicator of device-to-IP inconsistency, which (when combined with velocity and amount clustering) suggests either:\
   - device fingerprint spoofing, or\
   - the same operator using multiple IPs to avoid rate limits, or\
   - lateral movement/account takeover.\
   Note: Device 4f20b111-f2c4-4991-ac6d-c08bf8... appears repeatedly with IP 103.175.214.243 in the sample, showing at least one steady mapping, but the presence of device-IP mismatch elsewhere is concerning.\
\
4) Context and volume (MED): 23 records totaling $2,444,022.00 \'97 high aggregate volume concentrated into many similar-sized transactions \'97 raises operational risk (chargeback exposure, money-mule patterns).\
\
5) Missing external intelligence (confidence modifier): There are no tool execution results available (see CRITICAL DATA GAP below). Lack of IP reputation, device reputation, ASN, reverse DNS, VPN/proxy detection, and card BIN checks reduces our ability to definitively classify these as fraud vs. legitimate batch payments. Because behavioral anomalies (velocity, identical amounts, IP rotation) are present and are primary fraud indicators per policy, they dominate the risk assessment despite missing external signals.\
\
RISK SCORE JUSTIFICATION (why 0.78)\
- The assessment prioritizes behavioral anomalies: velocity bursts and amount clustering are HIGH fraud indicators; device-IP mismatch/IP rotation increases risk further. These combined produce a high likelihood of abusive/automated behavior. I set the score below "near-certain fraud" to account for the lack of confirmatory external intelligence and the absence of confirmed fraud flags \'97 hence 0.78 (high risk, but not maximum).\
\
CRITICAL DATA GAP (missing tool results and impact)\
The Tool Execution Results section is empty. Per instructions, I must list missing analyses and impacts:\
- CRITICAL DATA GAP: IP reputatio\
2025-11-14 08:23:05,415 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 9047 chars)\
2025-11-14 08:23:05,418 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1] \uc0\u9989  Network analysis complete - Risk: 1.00\
2025-11-14 08:23:05,421 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for network_agent: 47307ms, 2 steps\
2025-11-14 08:23:05,440 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted network domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:23:05,440 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced network agent completed\
2025-11-14 08:23:05,440 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 1/6\
[2025-11-14T08:23:05-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:23:05,452 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:23:05,463 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.254 (low)\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: device_agent (domain: device)\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: device_agent\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.254 (AIConfidenceLevel.LOW)\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:23:05,473 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: device_agent\
2025-11-14 08:23:05,474 [INFO] uvicorn.access: [] 127.0.0.1:61941 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.254 (low)\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: device_agent (domain: device)\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: device_agent\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.254 (AIConfidenceLevel.LOW)\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:23:05,484 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: device_agent\
2025-11-14 08:23:05,486 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence device agent starting\
2025-11-14 08:23:05,487 [INFO] app.service.agent.orchestration.domain_agents.device_agent: [] [Step 5.2.2] \uc0\u55357 \u56561  Device agent analyzing investigation\
2025-11-14 08:23:05,487 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for device_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:23:05,488 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:23:05,488 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:23:05,488 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 23\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.397\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $2,444,022.00 across 23 transactions\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 23):\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:45:01.457000\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,764.00\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:44:28.044000\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,772.00\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:25:12.013000\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:23:33.732000\
2025-11-14 08:23:05,488 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:22:02.765000\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,785.00\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 23 raw records \u8594  formatted summary\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a device fingerprinting expert specializing in device consistency \
            analysis, browser spoofing detection, and device behavior patterns. You understand \
            device-based fraud indicators and can assess device-related risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multipl...\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3478 chars)\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this device domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: moeller2media@gmail.com\
- Domain: device\
\
## Evidence Collected\
- Unique devices: 2 across 23 transactions\
- User agent variations: 2\
- Device diversity: 2 browsers, 2 operating systems\
- Analysis based on: PARSED_USER_AGENT, USER_AGENT\
\
## Metrics and Data Points\
- Snowflake Records: 23\
- Unique Device Count: 2\
- Total Transactions: 23\
- Unique User Agents: 2\
- Unique Browsers: 2\
- Unique Os: 2\
- Unique Device Models: None\
- Unique Os Versions: None\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 23\
- Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
- Average Model Score: 0.397\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $2,444,022.00 across 23 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 23):\
  Transaction 1:\
    - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
    - DateTime: 2025-11-11T07:45:01.457000\
    - Amount: $112,764.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
    - DateTime: 2025-11-11T07:44:28.044000\
    - Amount: $112,772.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
    - DateTime: 2025-11-11T07:25:12.013000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
    - DateTime: 2025-11-11T07:23:33.732000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
    - DateTime: 2025-11-11T07:22:02.765000\
    - Amount: $112,785.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
#...\
2025-11-14 08:23:05,489 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5329 chars)\
[2025-11-14T08:23:45-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:23:45,564 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:23:45,564 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.85\
\
CONFIDENCE: 0.65\
\
RISK FACTORS (increasing risk)\
- Velocity burst: 3 transactions within ~3 minutes (high fraud signal).\
- Amount clustering / repeated high-value amounts across short windows (high fraud signal).\
- Device\uc0\u8209 IP mismatch: at least one device (15aa5c03-c3c8-4baf-8df1-69156a...) observed using multiple IPs (medium\u8209 high signal).\
- High dollar volume concentrated in similar transaction amounts: $2,444,022.00 across 23 transactions with many ~ $112k amounts (supports templated/batch activity).\
- Few unique devices (2) across 23 transactions with limited user agent variation (2) \'97 indicates repeat use of same device(s) for many high-value transactions (suspicious when combined with clustering/velocity).\
- Multiple transactions tied to single IP 103.175.214.243 in tight time windows (supports coordinated bursts).\
\
RISK FACTORS (decreasing/mitigating)\
- No confirmed fraud flags in provided records (0 confirmed fraud).\
- No transactions flagged as high-risk by the provided engine (0 transactions >0.7 in provided context) \'97 but per instructions this does not override behavioral patterns.\
\
DETAILED REASONING (evidence-based)\
- Velocity burst: The dataset explicitly reports "VELOCITY BURST: 3 transactions in 5 minutes." Sample records show a clear burst between 2025-11-11T07:22:02.765000 and 2025-11-11T07:25:12.013000:\
  - 2025-11-11T07:22:02.765000 \'97 $112,785.00 (Transaction ID starts 1a3b13c8...)\
  - 2025-11-11T07:23:33.732000 \'97 $112,778.00 (Transaction ID starts cf952756...)\
  - 2025-11-11T07:25:12.013000 \'97 $112,778.00 (Transaction ID starts 47ca2b38...)\
  These three high-value transactions occur within ~3 minutes from the same device (4f20b111-f2c4-4991-ac6d-c08bf8...) and the same IP (103.175.214.243), which matches the velocity-burst pattern (high fraud indicator).\
- Amount clustering / identical amounts: The FRAUD PATTERNS DETECTED lists "AMOUNT CLUSTERING: $112,718.00 appears 2 times." In the sample transactions provided we also observe identical or tightly clustered amounts repeating (e.g., two instances of $112,778.00 in the burst above; other nearby amounts include $112,772.00 and $112,764.00 at 07:44\'9607:45). Repeated near-identical high-dollar amounts in short windows is a common indicator of templated/batch fraud or automated processing.\
- Device-IP mismatch: The report flags "DEVICE-IP MISMATCH: Device 15aa5c03-c3c8-4baf-8df1-69156a... used 2 different IPs." Device-IP rotation / mismatch is a medium-high fraud signal \'97 it can indicate VPN/proxy use or device spoofing. Note: sample transactions show device 4f20b111-f2c4-4991-ac6d-c08bf8... consistently using IP 103.175.214.243, but the existence of a second device (15aa5c03...) using multiple IPs creates a cross-domain contradiction (same email/device set but inconsistent IP use).\
- Concentration of value: $2,444,022.00 across 23 transactions (~many ~ $112k each) increases potential fraud impact; velocity/amount clustering here raises stakes \'97 even a small false-negative rate is costly.\
- Data quality/context: Snowflake records span 2025-10-28 to 2025-11-11 and show 23 records. The explicit FRAUD PATTERNS DETECTED are primary indicators per instructions; these drive the elevated risk despite no confirmed fraud flags in the records.\
\
CRITICAL DATA GAP(S) \'97 missing tool outputs and impact\
- CRITICAL DATA GAP: IP reputation / geolocation - Impact: Cannot assess whether 103.175.214.243 (and the other IP(s) linked to device 15aa5c03...) are known malicious/proxy/VPN endpoints or are from unexpected geographies; this limits ability to confirm fraud vs legitimate remote office/VPN usage.\
- CRITICAL DATA GAP: Device reputation / fingerprinting telemetry - Impact: Cannot validate whether device fingerprints (4f20b111-f2c4-4991-ac6d-c08bf8..., 15aa5c03-c3c8-4baf-8df1-69156a...) are associated with prior fraud or churn across accounts; reduces confidence in device-spoof detection.\
- CRITICAL DATA GAP: Email reputation / historical account behavior for moeller2media@gmail.com - Impact: Cannot determine prior chargebacks, disputes, or fraud history tied to this email.\
- CRITICAL DATA GAP: Payment method BIN / cardholder geolocation / issuer checks - Impact: Unable to confirm cardholder country vs IP geolocation or BIN risk; reduces ability to detect cross-border mismatches.\
- CRITICAL DATA GAP: Chargeback / dispute history and KYC identity verification - Impact: Cannot determine historical outcomes for these transactions or identity legitimacy.\
- CRITICAL DATA GAP: Full IP list for device 15aa5c03-c3c8-4baf-8df1-69156a... - Impact: The mismatch is flagged but the second IP address is not provided; impairs ability to quantify rotation severity.\
\
Because "Tool Execution Results" are empty, all the above external checks could not be performed; this lowers final confidence (hence Confidence = 0.65) even though behavioral signals are strong.\
\
RECOMMENDATIONS (prioritized, actionable, include exact values from evidence)\
- [CRITICAL] Action: Qu\
2025-11-14 08:23:45,564 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 7721 chars)\
2025-11-14 08:23:45,566 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2] \uc0\u9989  Device analysis complete - Risk: 1.00\
2025-11-14 08:23:45,569 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for device_agent: 40079ms, 2 steps\
2025-11-14 08:23:45,569 [INFO] app.service.agent.orchestration.domain_agents.device_agent: [] [Step 5.2.2] \uc0\u9989  Device analysis complete - Evidence collected: 5 points\
2025-11-14 08:23:45,588 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted device domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:23:45,589 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced device agent completed\
2025-11-14 08:23:45,589 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 2/6\
[2025-11-14T08:23:45-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:23:45,601 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:23:45,611 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector 54055c52-d5eb-4878-a261-f332f78b3176\
2025-11-14 08:23:45,651 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:45,651 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:45,652 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT STORE_ID\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:45.613098+00:00'\
                  AND TX_DATETIME <= '2025-11-14T08:23:45.613098+...\
2025-11-14 08:23:46,488 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 56 rows\
2025-11-14 08:23:46,488 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 56 rows returned\
2025-11-14 08:23:46,488 [INFO] app.service.anomaly.cohort_fetcher: [] Found 56 unique cohorts for detector 54055c52-d5eb-4878-a261-f332f78b3176\
2025-11-14 08:23:46,488 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:46,488 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:46,488 [INFO] app.service.anomaly.detector_factory: [] Registered detector type: stl_mad -> STLMADDetector\
2025-11-14 08:23:46,488 [INFO] app.service.anomaly.detector_factory: [] Registered detector type: cusum -> CUSUMDetector\
2025-11-14 08:23:46,488 [INFO] app.service.anomaly.detector_factory: [] Registered detector type: isoforest -> IsoForestDetector\
2025-11-14 08:23:46,488 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:46,489 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:46,489 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:46,489 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:46,489 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:46,552 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:46,552 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Verifying 4 indexes for public.transactions_enriched...\
2025-11-14 08:23:46,565 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] \uc0\u9989  All 4 indexes verified\
2025-11-14 08:23:46,565 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL indexes verified: 4 total\
2025-11-14 08:23:46,595 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:46,606 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:46,618 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:46,629 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:46,641 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:46,648 [INFO] app.service.anomaly.cohort_processor: [] Skipped 56 cohort/metric combinations due to insufficient data (out of 56 total). Processed 56 cohorts, created 0 anomalies.\
2025-11-14 08:23:46,654 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:46,654 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:46,656 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 56 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:46,656 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run a692dcd5-1e2e-48c5-936d-39ca02ddac09 for detector 54055c52-d5eb-4878-a261-f332f78b3176\
2025-11-14 08:23:46,656 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector 7f63da2f-8964-40a9-829a-7862a0de999d\
2025-11-14 08:23:46,659 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:46,659 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:46,659 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:46,659 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT DEVICE_TYPE, IP_COUNTRY_CODE\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:46.657415+00:00'\
                  AND TX_DATETIME <= '2025-11...\
2025-11-14 08:23:46,659 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:46,707 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:46-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:46-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:49,022 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:49,644 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 323 rows\
2025-11-14 08:23:49,644 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 323 rows returned\
2025-11-14 08:23:49,646 [INFO] app.service.anomaly.cohort_fetcher: [] Found 323 unique cohorts for detector 7f63da2f-8964-40a9-829a-7862a0de999d\
2025-11-14 08:23:49,646 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:49,646 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:49,646 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:49,647 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:49,647 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:49,647 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:49,647 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:49,706 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:49,738 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,760 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,781 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,803 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,824 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,846 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,882 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,920 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,954 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:49,992 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.00%, size=1/1000\
2025-11-14 08:23:49,992 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,029 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,068 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,109 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,172 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,212 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,249 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,286 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,321 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,360 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,401 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.50%, size=1/1000\
2025-11-14 08:23:50,401 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,442 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,477 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,531 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,565 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,601 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,641 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,678 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,716 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,757 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,793 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.67%, size=1/1000\
2025-11-14 08:23:50,794 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,834 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,872 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:50,883 [INFO] app.service.anomaly.cohort_processor: [] Skipped 323 cohort/metric combinations due to insufficient data (out of 323 total). Processed 323 cohorts, created 0 anomalies.\
2025-11-14 08:23:50,904 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:50,904 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:50,906 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 323 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:50,906 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run e0bb3a59-3a40-4a1b-9fca-bbd1f19733ab for detector 7f63da2f-8964-40a9-829a-7862a0de999d\
2025-11-14 08:23:50,907 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector 5160399f-96dc-41e8-9a97-49e5db67e005\
2025-11-14 08:23:50,908 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:50,908 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:50,909 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:50,909 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT STORE_ID\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:50.907474+00:00'\
                  AND TX_DATETIME <= '2025-11-14T08:23:50.907474+...\
2025-11-14 08:23:50,909 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:50,955 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:50-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:50-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:51,260 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:51,477 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 56 rows\
2025-11-14 08:23:51,478 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 56 rows returned\
2025-11-14 08:23:51,478 [INFO] app.service.anomaly.cohort_fetcher: [] Found 56 unique cohorts for detector 5160399f-96dc-41e8-9a97-49e5db67e005\
2025-11-14 08:23:51,478 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:51,478 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:51,478 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:51,478 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:51,478 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:51,478 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:51,478 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:51,532 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:51,553 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:51,563 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:51,574 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:51,585 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:51,596 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:51,603 [INFO] app.service.anomaly.cohort_processor: [] Skipped 56 cohort/metric combinations due to insufficient data (out of 56 total). Processed 56 cohorts, created 0 anomalies.\
2025-11-14 08:23:51,607 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:51,607 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:51,608 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 56 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:51,608 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run fdd4c602-f913-4b28-b987-0689404dd8bc for detector 5160399f-96dc-41e8-9a97-49e5db67e005\
2025-11-14 08:23:51,608 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector f760a47d-26b6-4b18-bcb3-cc5798fc3ee4\
2025-11-14 08:23:51,610 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:51,610 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:51,610 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:51,610 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT STORE_ID\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:51.609219+00:00'\
                  AND TX_DATETIME <= '2025-11-14T08:23:51.609219+...\
2025-11-14 08:23:51,610 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:51,655 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:51,655 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:51,655 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:51,655 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:51,655 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:51,655 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:51,655 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:51,656 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:51,656 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:51,656 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:51,656 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:51,656 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:51,656 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:51-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:51-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:52,040 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:52,272 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 56 rows\
2025-11-14 08:23:52,272 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 56 rows returned\
2025-11-14 08:23:52,272 [INFO] app.service.anomaly.cohort_fetcher: [] Found 56 unique cohorts for detector f760a47d-26b6-4b18-bcb3-cc5798fc3ee4\
2025-11-14 08:23:52,272 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:52,272 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:52,272 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:52,272 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:52,272 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:52,272 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:52,272 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:52,327 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:52,347 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:52,358 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:52,369 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:52,380 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:52,392 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:52,399 [INFO] app.service.anomaly.cohort_processor: [] Skipped 56 cohort/metric combinations due to insufficient data (out of 56 total). Processed 56 cohorts, created 0 anomalies.\
2025-11-14 08:23:52,404 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:52,404 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:52,406 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 56 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:52,406 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run b6cfeb87-ac1e-4d8e-aac2-329295bfcd6c for detector f760a47d-26b6-4b18-bcb3-cc5798fc3ee4\
2025-11-14 08:23:52,406 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector f1157983-a9eb-4ddd-b820-91ee3ffdee7c\
2025-11-14 08:23:52,408 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:52,408 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:52,408 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:52,408 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT IP_COUNTRY_CODE\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:52.407200+00:00'\
                  AND TX_DATETIME <= '2025-11-14T08:23:52....\
2025-11-14 08:23:52,409 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:52,455 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:52,455 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:52,455 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:52,455 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:52,455 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:52,456 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:52,456 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:52,456 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:52,456 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:52,456 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:52,456 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:52,456 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:52,456 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:52-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:52-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:52,867 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:53,216 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 130 rows\
2025-11-14 08:23:53,217 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 130 rows returned\
2025-11-14 08:23:53,217 [INFO] app.service.anomaly.cohort_fetcher: [] Found 130 unique cohorts for detector f1157983-a9eb-4ddd-b820-91ee3ffdee7c\
2025-11-14 08:23:53,217 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:53,217 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:53,217 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:53,217 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:53,217 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:53,217 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:53,217 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:53,275 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:53,303 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,321 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,338 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,355 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,372 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,389 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,406 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,424 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,441 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,459 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.00%, size=1/1000\
2025-11-14 08:23:53,459 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,478 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,511 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,539 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:53,539 [INFO] app.service.anomaly.cohort_processor: [] Skipped 130 cohort/metric combinations due to insufficient data (out of 130 total). Processed 130 cohorts, created 0 anomalies.\
2025-11-14 08:23:53,547 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:53,547 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:53,550 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 130 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:53,550 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run 823074ac-032d-4fac-bc24-99a9919982cb for detector f1157983-a9eb-4ddd-b820-91ee3ffdee7c\
2025-11-14 08:23:53,550 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector c58ac77b-3fab-4bef-9577-66b4a2962c2e\
2025-11-14 08:23:53,551 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:53,551 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:53,551 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:53,552 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT IP_COUNTRY_CODE\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:53.550895+00:00'\
                  AND TX_DATETIME <= '2025-11-14T08:23:53....\
2025-11-14 08:23:53,552 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:53,598 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:53-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:53-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:53,881 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:54,447 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 130 rows\
2025-11-14 08:23:54,447 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 130 rows returned\
2025-11-14 08:23:54,447 [INFO] app.service.anomaly.cohort_fetcher: [] Found 130 unique cohorts for detector c58ac77b-3fab-4bef-9577-66b4a2962c2e\
2025-11-14 08:23:54,447 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:54,447 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:54,447 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:54,448 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:54,448 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:54,448 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:54,448 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:54,515 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:54,556 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,583 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,616 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,673 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,700 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,724 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,743 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,767 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,803 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,838 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.00%, size=1/1000\
2025-11-14 08:23:54,839 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,860 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,880 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,910 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:54,911 [INFO] app.service.anomaly.cohort_processor: [] Skipped 130 cohort/metric combinations due to insufficient data (out of 130 total). Processed 130 cohorts, created 0 anomalies.\
2025-11-14 08:23:54,919 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:54,919 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:54,921 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 130 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:54,921 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run e9b3d853-d1a6-47b2-b422-643d3efa5f5e for detector c58ac77b-3fab-4bef-9577-66b4a2962c2e\
2025-11-14 08:23:54,921 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector 1d4e898f-8890-43cb-b823-627058e1a0cc\
2025-11-14 08:23:54,923 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:54,923 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:54,923 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:54,923 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT IP_COUNTRY_CODE\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:54.922035+00:00'\
                  AND TX_DATETIME <= '2025-11-14T08:23:54....\
2025-11-14 08:23:54,923 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:54,970 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:54-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:54-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:55,309 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:55,592 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 130 rows\
2025-11-14 08:23:55,592 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 130 rows returned\
2025-11-14 08:23:55,592 [INFO] app.service.anomaly.cohort_fetcher: [] Found 130 unique cohorts for detector 1d4e898f-8890-43cb-b823-627058e1a0cc\
2025-11-14 08:23:55,592 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:55,592 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:55,592 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:55,592 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:55,592 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:55,592 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:55,592 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:55,649 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:55,676 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,696 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,717 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,736 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,754 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,772 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,791 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,810 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,827 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,846 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.00%, size=1/1000\
2025-11-14 08:23:55,846 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,867 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,899 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,929 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:55,929 [INFO] app.service.anomaly.cohort_processor: [] Skipped 130 cohort/metric combinations due to insufficient data (out of 130 total). Processed 130 cohorts, created 0 anomalies.\
2025-11-14 08:23:55,937 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:55,937 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:55,939 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 130 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:55,939 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run 5054fbab-37da-48d2-ba08-7e7c508d97f3 for detector 1d4e898f-8890-43cb-b823-627058e1a0cc\
2025-11-14 08:23:55,939 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector f4728e68-9779-4dfc-a682-335ba394de8a\
2025-11-14 08:23:55,941 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:55,941 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:55,941 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:55,942 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT IP_COUNTRY_CODE\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:55.940221+00:00'\
                  AND TX_DATETIME <= '2025-11-14T08:23:55....\
2025-11-14 08:23:55,942 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:55,989 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:55-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:55-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:56,327 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:56,640 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 130 rows\
2025-11-14 08:23:56,640 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 130 rows returned\
2025-11-14 08:23:56,640 [INFO] app.service.anomaly.cohort_fetcher: [] Found 130 unique cohorts for detector f4728e68-9779-4dfc-a682-335ba394de8a\
2025-11-14 08:23:56,640 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:56,640 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:56,640 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:56,640 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:56,640 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:56,640 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:56,640 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:56,696 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:56,724 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,743 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,761 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,778 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,796 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,814 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,831 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,850 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,867 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,919 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.00%, size=1/1000\
2025-11-14 08:23:56,919 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,951 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:56,985 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:57,019 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:57,019 [INFO] app.service.anomaly.cohort_processor: [] Skipped 130 cohort/metric combinations due to insufficient data (out of 130 total). Processed 130 cohorts, created 0 anomalies.\
2025-11-14 08:23:57,028 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:57,028 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:57,029 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 130 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:57,029 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run b7fad3c2-6056-4f5f-8f0a-4b443c71fb5d for detector f4728e68-9779-4dfc-a682-335ba394de8a\
2025-11-14 08:23:57,030 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector ba221f3e-3c1d-444b-baac-4d28a40405de\
2025-11-14 08:23:57,031 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:57,031 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:57,031 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:57,031 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT IP_COUNTRY_CODE, STORE_ID\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:57.030514+00:00'\
                  AND TX_DATETIME <= '2025-11-14...\
2025-11-14 08:23:57,031 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:57,079 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:57-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:57-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:57,397 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:57,736 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 194 rows\
2025-11-14 08:23:57,736 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 194 rows returned\
2025-11-14 08:23:57,736 [INFO] app.service.anomaly.cohort_fetcher: [] Found 194 unique cohorts for detector ba221f3e-3c1d-444b-baac-4d28a40405de\
2025-11-14 08:23:57,736 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:57,736 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:57,737 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:57,737 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:57,737 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:57,737 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:57,737 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:57,802 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:57,849 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:57,883 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:57,919 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:57,953 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:57,987 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=98.00%, size=2/1000\
2025-11-14 08:23:57,988 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,021 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,056 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,110 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,178 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,240 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.00%, size=2/1000\
2025-11-14 08:23:58,241 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,300 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,348 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,431 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,492 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,542 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.33%, size=2/1000\
2025-11-14 08:23:58,542 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,575 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,633 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,696 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,765 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:58,792 [INFO] app.service.anomaly.cohort_processor: [] Skipped 388 cohort/metric combinations due to insufficient data (out of 388 total). Processed 194 cohorts, created 0 anomalies.\
2025-11-14 08:23:58,799 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:23:58,799 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:23:58,800 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 194 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:23:58,800 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run 4a592e49-7751-4346-af69-ac5439515566 for detector ba221f3e-3c1d-444b-baac-4d28a40405de\
2025-11-14 08:23:58,800 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector 53d25eb6-6ce7-48ef-af41-57f067ced008\
2025-11-14 08:23:58,802 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:23:58,802 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:23:58,802 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:23:58,803 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT IP_COUNTRY_CODE, STORE_ID\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:23:58.801254+00:00'\
                  AND TX_DATETIME <= '2025-11-14...\
2025-11-14 08:23:58,803 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:23:58,850 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:23:58-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:23:58-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:23:59,169 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:23:59,417 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 194 rows\
2025-11-14 08:23:59,418 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 194 rows returned\
2025-11-14 08:23:59,418 [INFO] app.service.anomaly.cohort_fetcher: [] Found 194 unique cohorts for detector 53d25eb6-6ce7-48ef-af41-57f067ced008\
2025-11-14 08:23:59,418 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:23:59,418 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:23:59,418 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:23:59,418 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:23:59,418 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:23:59,418 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:23:59,418 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:23:59,470 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:23:59,518 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:59,552 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:59,588 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:59,623 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:59,675 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=98.00%, size=2/1000\
2025-11-14 08:23:59,675 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:59,742 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:59,801 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:59,866 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:23:59,941 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,003 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.00%, size=2/1000\
2025-11-14 08:24:00,003 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,069 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,131 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,199 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,265 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,332 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.33%, size=2/1000\
2025-11-14 08:24:00,332 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,416 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,561 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,643 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,734 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:00,761 [INFO] app.service.anomaly.cohort_processor: [] Skipped 388 cohort/metric combinations due to insufficient data (out of 388 total). Processed 194 cohorts, created 0 anomalies.\
2025-11-14 08:24:00,770 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:24:00,770 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:24:00,773 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 194 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:24:00,773 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run 76a2d5ce-06e8-4ed0-a34f-9e50e881e55a for detector 53d25eb6-6ce7-48ef-af41-57f067ced008\
2025-11-14 08:24:00,773 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector 92abbc7c-9e32-4daf-b97c-d9f627879dbd\
2025-11-14 08:24:00,774 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:24:00,774 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:24:00,774 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:24:00,774 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT IP_COUNTRY_CODE, STORE_ID\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:24:00.773633+00:00'\
                  AND TX_DATETIME <= '2025-11-14...\
2025-11-14 08:24:00,775 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:24:00,821 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:24:00-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:24:00-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:24:01,125 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:24:01,365 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 194 rows\
2025-11-14 08:24:01,366 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 194 rows returned\
2025-11-14 08:24:01,366 [INFO] app.service.anomaly.cohort_fetcher: [] Found 194 unique cohorts for detector 92abbc7c-9e32-4daf-b97c-d9f627879dbd\
2025-11-14 08:24:01,366 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:24:01,366 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:24:01,366 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:24:01,366 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:24:01,366 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:24:01,366 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:24:01,366 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:24:01,444 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:24:01,510 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:01,547 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:01,595 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:01,651 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:01,714 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=98.00%, size=2/1000\
2025-11-14 08:24:01,714 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:01,773 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:01,837 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:01,898 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:01,958 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,013 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.00%, size=2/1000\
2025-11-14 08:24:02,014 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,075 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,139 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,224 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,281 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,343 [INFO] app.service.agent.tools.database_tool.postgres_client: [] Query cache stats: hit_rate=99.33%, size=2/1000\
2025-11-14 08:24:02,343 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,404 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,465 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,530 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,588 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:02,611 [INFO] app.service.anomaly.cohort_processor: [] Skipped 388 cohort/metric combinations due to insufficient data (out of 388 total). Processed 194 cohorts, created 0 anomalies.\
2025-11-14 08:24:02,622 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:24:02,622 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:24:02,624 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 194 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:24:02,624 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run 1c3776ff-690c-487e-925c-5998012914cb for detector 92abbc7c-9e32-4daf-b97c-d9f627879dbd\
2025-11-14 08:24:02,624 [INFO] app.service.anomaly.scheduler_jobs: [] Starting scheduled detection run for detector b3bec743-0958-4793-b037-4c9b062783cd\
2025-11-14 08:24:02,626 [INFO] app.service.anomaly.detection_run_logger: [] Detection run started\
2025-11-14 08:24:02,626 [INFO] app.service.anomaly.cohort_fetcher: [] Using database provider: snowflake (USE_SNOWFLAKE=True, DATABASE_PROVIDER=snowflake)\
2025-11-14 08:24:02,626 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:24:02,626 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT DISTINCT STORE_ID\
                FROM DBT.DBT_PROD.TXS\
                WHERE TX_DATETIME >= '2025-11-14T07:24:02.624820+00:00'\
                  AND TX_DATETIME <= '2025-11-14T08:24:02.624820+...\
2025-11-14 08:24:02,626 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:24:02,673 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:24:02-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:24:02-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:434: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_options(value)\
2025-11-14 08:24:02,965 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:24:03,163 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 56 rows\
2025-11-14 08:24:03,163 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 56 rows returned\
2025-11-14 08:24:03,164 [INFO] app.service.anomaly.cohort_fetcher: [] Found 56 unique cohorts for detector b3bec743-0958-4793-b037-4c9b062783cd\
2025-11-14 08:24:03,164 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:24:03,164 [INFO] app.service.anomaly.detection_run_logger: [] Cohorts retrieved for detection run\
2025-11-14 08:24:03,164 [INFO] app.service.anomaly.detection_job: [] Processing cohorts with PostgreSQL (analytics always uses PostgreSQL)\
2025-11-14 08:24:03,164 [INFO] app.service.agent.tools.database_tool.query_translator: [] QueryTranslator initialized with 5 translation rules\
2025-11-14 08:24:03,165 [INFO] app.service.agent.tools.database_tool.query_cache: [] QueryCache initialized with max_size=1000\
2025-11-14 08:24:03,165 [INFO] app.service.agent.tools.database_tool.postgres_indexes: [] Initialized PostgreSQLIndexManager for public.transactions_enriched\
2025-11-14 08:24:03,165 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: postgresql\
2025-11-14 08:24:03,252 [INFO] app.service.agent.tools.database_tool.postgres_client: [] \uc0\u9989  PostgreSQL pool created: olorin_db@localhost:5432 (size=10)\
2025-11-14 08:24:03,300 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:03,319 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:03,334 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:03,349 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:03,362 [INFO] app.service.anomaly.detection_run_logger: [] Detection run progress\
2025-11-14 08:24:03,369 [INFO] app.service.anomaly.cohort_processor: [] Skipped 56 cohort/metric combinations due to insufficient data (out of 56 total). Processed 56 cohorts, created 0 anomalies.\
2025-11-14 08:24:03,376 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed\
2025-11-14 08:24:03,376 [INFO] app.service.agent.tools.database_tool.postgres_client: [] PostgreSQL connection pool closed successfully\
2025-11-14 08:24:03,379 [INFO] app.service.anomaly.detection_run_logger: [] Detection run completed with no anomalies found. Processed 56 cohorts but no anomalies detected. This may indicate normal behavior or that thresholds need adjustment.\
2025-11-14 08:24:03,379 [INFO] app.service.anomaly.scheduler_jobs: [] Completed scheduled detection run cdc02394-6580-4dfb-9eb8-571a1768a472 for detector b3bec743-0958-4793-b037-4c9b062783cd\
2025-11-14 08:24:03,380 [INFO] app.service.etag_service: [olorin_tid=dc38fb8f-46c4-4887-9ad6-6c5bbd232d53, investigation_id=a357f380-cb3c-490a-adbf-b9d8e0504759] etag_retrieved\
2025-11-14 08:24:03,392 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:24:03,402 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:24:03,412 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.279 (low)\
2025-11-14 08:24:03,412 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:24:03,412 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: location_agent (domain: location)\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: location_agent\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.279 (AIConfidenceLevel.LOW)\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:24:03,413 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: location_agent\
2025-11-14 08:24:03,414 [INFO] uvicorn.access: [] 127.0.0.1:62089 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:24:03,426 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.279 (low)\
2025-11-14 08:24:03,426 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:24:03,426 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.04\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: location_agent (domain: location)\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: location_agent\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.279 (AIConfidenceLevel.LOW)\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:24:03,427 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: location_agent\
2025-11-14 08:24:03,429 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence location agent starting\
2025-11-14 08:24:03,434 [INFO] app.service.agent.orchestration.domain_agents.location_agent: [] [Step 5.2.3] \uc0\u55357 \u56525  Location agent analyzing investigation\
2025-11-14 08:24:03,434 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for location_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:24:03,435 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:24:03,435 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:24:03,435 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 23\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.397\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $2,444,022.00 across 23 transactions\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 23):\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:45:01.457000\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,764.00\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:44:28.044000\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,772.00\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:03,435 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:25:12.013000\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:23:33.732000\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:22:02.765000\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,785.00\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 23 raw records \u8594  formatted summary\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a geographic analysis expert specializing in location patterns, \
            impossible travel detection, and geographic risk assessment. You understand \
            location-based fraud indicators and can assess geographic risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transacti...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3469 chars)\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this location domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: moeller2media@gmail.com\
- Domain: location\
\
## Evidence Collected\
- Geographic spread: 0 cities across 1 countries\
\
## Metrics and Data Points\
- Snowflake Records: 23\
- Unique Countries: 1\
- Location Changes: 1\
- Impossible Travel Count: 0\
- Max Speed Required Mph: 0\
- High Risk Countries Count: 0\
- Unique Cities: 0\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 23\
- Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
- Average Model Score: 0.397\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $2,444,022.00 across 23 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 23):\
  Transaction 1:\
    - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
    - DateTime: 2025-11-11T07:45:01.457000\
    - Amount: $112,764.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
    - DateTime: 2025-11-11T07:44:28.044000\
    - Amount: $112,772.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
    - DateTime: 2025-11-11T07:25:12.013000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
    - DateTime: 2025-11-11T07:23:33.732000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
    - DateTime: 2025-11-11T07:22:02.765000\
    - Amount: $112,785.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTERNS DETECTED (PRIMARY INDICATORS):\
- VELOCITY BURST: 3 transactions in 5 minutes\
- AMOUNT CLUSTERING: $112,718.00 appears ...\
2025-11-14 08:24:03,436 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5194 chars)\
[2025-11-14T08:24:40-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:24:40,935 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:24:40,935 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.82\
\
CONFIDENCE: 0.68\
\
KEY RISK FACTORS (increase / decrease)\
- Increase: Velocity burst \'97 3 transactions in 5 minutes (FLAGGED)\
- Increase: Amount clustering / identical amounts \'97 $112,718.00 appears 2 times (FLAGGED)\
- Increase: Device-IP mismatch \'97 device 15aa5c03-c3c8-4baf-8df1-69156a... used 2 different IPs (FLAGGED)\
- Increase: Very large dollar volume concentrated across few transactions \'97 Total Volume $2,444,022.00 across 23 transactions (avg \uc0\u8776  $106k/txn)\
- Increase / neutral: Single country / limited geo spread \'97 Unique Countries: 1, Unique Cities: 0 (reduces travel-based risk but not behavioral fraud signals)\
- Decrease: Impossible Travel Count = 0 and Max Speed Required Mph = 0 (no impossible travel detected)\
\
DETAILED REASONING\
- Primary pattern evidence (per FRAUD PATTERNS DETECTED) shows multiple high-severity behavioral anomalies that are independently strong fraud indicators:\
  - Velocity burst: The dataset contains a velocity burst (3 transactions in 5 minutes). Two of the timestamps provided that fall inside this tight cluster are 2025-11-11T07:44:28.044000 and 2025-11-11T07:45:01.457000 (both large-dollar transactions: $112,772.00 and $112,764.00 respectively). The third transaction in that 5\uc0\u8209 minute window is flagged in the dataset (exact timestamp not shown in sample slice), producing the 3-in-5-minutes signal. Velocity bursts are a HIGH fraud signal (rapid, automated or scripted attempts).\
  - Amount clustering / identical amounts: The evidence flags $112,718.00 appearing twice and many transactions in the sample group around $112.7k (sample tx amounts: $112,764.00; $112,772.00; $112,778.00; $112,785.00). Repeated, similarly sized large payouts in short order is a HIGH fraud signal (templated payouts / batch abuse).\
  - Device-IP mismatch: Device ID 15aa5c03-c3c8-4baf-8df1-69156a... is reported as used from 2 different IPs (device-IP mismatch flagged). This is a MEDIUM-HIGH signal suggesting either IP rotation or potential proxy/VPN/device spoofing.\
- The dollar-weighted risk amplifies severity: total volume of $2,444,022.00 across 23 transactions (many ~ $112k each) increases business impact if fraudulent and therefore increases operational risk tolerance for intervention.\
- Geo/velocity checks alone would be less concerning (Unique Countries = 1, Impossible Travel = 0), but per the CRITICAL EXCEPTION the behavioral anomalies (velocity burst; amount clustering; device-IP mismatch) are primary and override low evidence-volume/geographic quietness.\
- There are no confirmed fraud flags or high-risk transactions >0.7 in the Snowflake context; however, model outputs are for reference only and not used to justify this score. The score is raised based on the combination of multiple primary behavioral indicators and high dollar exposure.\
- Confidence is reduced from maximum because external reputation data and deeper telemetry are missing (see CRITICAL DATA GAP list). Still, internal behavioral signals are strong enough to justify a high-risk score.\
\
CRITICAL DATA GAP(S)\
- CRITICAL DATA GAP: IP reputation data (e.g., malicious IP lists, ASN, geolocation accuracy) - Impact: cannot determine whether 103.175.214.243 or other IPs are known malicious/proxy/VPN or benign \'97 reduces confidence in concluding rotation vs. legitimate multi-homed connectivity.\
- CRITICAL DATA GAP: Device reputation / fingerprinting history - Impact: cannot assess whether device fingerprints (4f20b111-f2c4-4991-ac6d-c08bf8..., 15aa5c03-c3c8-4baf-8df1-69156a...) are associated with prior fraud or known good users.\
- CRITICAL DATA GAP: Email reputation and prior account history for moeller2media@gmail.com - Impact: cannot determine if email is newly created, linked to prior fraud, or has prior good history.\
- CRITICAL DATA GAP: Payment/card BIN and issuer verification, chargeback history - Impact: cannot evaluate card-level risk (stolen BINs, multiple cards tied to same device/email).\
- CRITICAL DATA GAP: IP <-> device timing correlation logs / full timestamps for all flagged transactions - Impact: prevents reconstructing exact timing correlations for IP rotation and the velocity burst composition.\
- CRITICAL DATA GAP: External tool results (no tool execution results available) \'97 specifically missing: IP reputation, device reputation, email reputation, card/processor risk flags, geolocation accuracy checks. This reduces overall confidence (hence confidence = 0.68).\
\
RECOMMENDATIONS (prioritized; include exact values from evidence)\
- [CRITICAL] Action: Hold / require manual review for all unsettled payouts and pending transactions for email moeller2media@gmail.com and all transactions involving device 4f20b111-f2c4-4991-ac6d-c08bf8... and device 15aa5c03-c3c8-4baf-8df1-69156a...\
- [CRITICAL] Action: Block or require step-up verification for transactions from IP 103.175.214.243 until IP reputation and geolocation are validated.\
- [CRITICAL] Action: Investigate the velocity burst: review the three transactions iden\
2025-11-14 08:24:40,935 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 7053 chars)\
2025-11-14 08:24:40,938 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3] \uc0\u9989  Location analysis complete - Risk: 1.00\
2025-11-14 08:24:40,940 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for location_agent: 37503ms, 2 steps\
2025-11-14 08:24:40,940 [INFO] app.service.agent.orchestration.domain_agents.location_agent: [] [Step 5.2.3] \uc0\u9989  Location analysis complete - Risk: 1.00\
2025-11-14 08:24:40,960 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted location domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:24:40,961 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced location agent completed\
2025-11-14 08:24:40,961 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 3/6\
[2025-11-14T08:24:40-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:24:40,976 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:24:40,993 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.305 (low)\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.05\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:24:41,012 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: logs_agent (domain: logs)\
2025-11-14 08:24:41,013 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: logs_agent\
2025-11-14 08:24:41,013 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.305 (AIConfidenceLevel.LOW)\
2025-11-14 08:24:41,013 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:24:41,013 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:24:41,013 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: logs_agent\
2025-11-14 08:24:41,013 [INFO] uvicorn.access: [] 127.0.0.1:62089 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:24:41,027 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.305 (low)\
2025-11-14 08:24:41,027 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:24:41,027 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:24:41,027 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:24:41,027 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.05\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: logs_agent (domain: logs)\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: logs_agent\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.305 (AIConfidenceLevel.LOW)\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:24:41,028 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: logs_agent\
2025-11-14 08:24:41,030 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence logs agent starting\
2025-11-14 08:24:41,035 [INFO] app.service.agent.orchestration.domain_agents.logs_agent: [] [Step 5.2.4] \uc0\u55357 \u56541  Logs agent analyzing investigation\
2025-11-14 08:24:41,035 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for logs_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:24:41,035 [INFO] app.service.agent.orchestration.domain.field_whitelist: [] \uc0\u55357 \u57057 \u65039  WHITELIST FILTER (logs): Blocked 203 non-domain fields: ['TABLE_RECORD_CREATED_AT', 'TABLE_RECORD_UPDATED_AT', 'EVENT_TYPE', 'ORIGINAL_TX_ID', 'CLIENT_REQUEST_ID']\
2025-11-14 08:24:41,035 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:24:41,035 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:24:41,036 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 23\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.397\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $2,444,022.00 across 23 transactions\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 23):\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:45:01.457000\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,764.00\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:44:28.044000\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,772.00\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:25:12.013000\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:23:33.732000\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:24:41,036 [INFO] app.service.agent.evidence_analyzer: []        - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:22:02.765000\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,785.00\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 23 raw records \u8594  formatted summary\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a log analysis expert specializing in behavioral pattern analysis, \
            system logs interpretation, and activity pattern detection. You understand \
            behavioral fraud indicators and can assess activity-based risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transac...\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3467 chars)\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this logs domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: moeller2media@gmail.com\
- Domain: logs\
\
## Evidence Collected\
- Transaction failures: 0 out of 23 transactions\
- Transaction frequency: 23 transactions analyzed\
- SUSPICIOUS: 23 transactions may indicate automated behavior\
\
## Metrics and Data Points\
- Failed Transaction Count: 0\
- Total Transaction Count: 23\
- Failure Rate: 0.0\
- Transaction Count: 23\
- Error Count: 0\
- Unique Error Codes: 0\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 23\
- Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
- Average Model Score: 0.397\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $2,444,022.00 across 23 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 23):\
  Transaction 1:\
    - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
    - DateTime: 2025-11-11T07:45:01.457000\
    - Amount: $112,764.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
    - DateTime: 2025-11-11T07:44:28.044000\
    - Amount: $112,772.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
    - DateTime: 2025-11-11T07:25:12.013000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
    - DateTime: 2025-11-11T07:23:33.732000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
    - DateTime: 2025-11-11T07:22:02.765000\
    - Amount: $112,785.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTERNS DETECTED (PRIMARY INDICATORS):\
- VELOCITY BU...\
2025-11-14 08:24:41,037 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5268 chars)\
[2025-11-14T08:25:13-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:25:13,338 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:25:13,338 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.85\
\
CONFIDENCE: 0.70\
\
RISK FACTORS (increasing risk)\
- Velocity bursts: 3 transactions within ~3 minutes on 2025-11-11 (07:22:02.765000, 07:23:33.732000, 07:25:12.013000) \'97 HIGH fraud signal.\
- Repeated identical amounts / amount clustering: $112,778.00 appears at least 2 times within ~2 minutes (07:23:33.732000 and 07:25:12.013000). Evidence also reports $112,718.00 appearing 2 times. Many transactions cluster around $112,7xx \'97 templated/batch pattern.\
- Suspicious automation flag: All 23 transactions flagged as "SUSPICIOUS: 23 transactions may indicate automated behavior."\
- Device-IP contradiction (Device-IP mismatch): Device 15aa5c03-c3c8-4baf-8df1-69156a... used 2 different IPs per FRAUD PATTERNS DETECTED \'97 MEDIUM-HIGH indicator of fraud.\
- High per-transaction dollar amounts and concentrated total volume: $2,444,022.00 across 23 transactions (average \uc0\u8776  $106k each) increases potential financial impact.\
- Multiple short bursts on same day: Another tight pair at 2025-11-11T07:44:28.044000 ($112,772.00) and 2025-11-11T07:45:01.457000 ($112,764.00) \'97 additional velocity signal.\
\
RISK FACTORS (decreasing/moderating risk)\
- Zero failed transactions / 0.0 failure rate (0 failures out of 23) \'97 may indicate successful automation rather than error-driven fraud attempts (this moderates immediate detection certainty but does not reduce risk of fraud).\
- No confirmed fraud in dataset (Confirmed Fraud: 0) \'97 no ground-truth confirmation yet.\
\
DETAILED REASONING\
- Primary fraud-pattern rules require that behavioral anomalies drive the assessment. The evidence explicitly reports VELOCITY BURST: "3 transactions in 5 minutes" and AMOUNT CLUSTERING (repeat amounts) plus DEVICE-IP MISMATCH \'97 together these are strong, independent fraud signals per the system rules.\
- Concrete transaction-level evidence supports these flags:\
  - 2025-11-11T07:22:02.765000 \'97 $112,785.00 \'97 Device: 4f20b111-f2c4-4991-ac6d-c08bf8... \'97 IP: 103.175.214.243\
  - 2025-11-11T07:23:33.732000 \'97 $112,778.00 \'97 Device: 4f20b111-f2c4-4991-ac6d-c08bf8... \'97 IP: 103.175.214.243\
  - 2025-11-11T07:25:12.013000 \'97 $112,778.00 \'97 Device: 4f20b111-f2c4-4991-ac6d-c08bf8... \'97 IP: 103.175.214.243\
  - Additional pair: 2025-11-11T07:44:28.044000 ($112,772.00) and 2025-11-11T07:45:01.457000 ($112,764.00) \'97 two transactions within ~33 seconds.\
- The combination of high-dollar repeated or near-identical amounts in short windows and consistent device fingerprints/IP usage strongly indicates scripted or automated processing of payments (templated/batch payments). This pattern matches known fraud behaviors (rapid replay of high-value transactions with minimal errors to evade detection).\
- Device-IP mismatch (Device 15aa5c03-c3c8-4baf-8df1-69156a... used 2 different IPs) is a medium-high signal: when the same device fingerprint appears from different IP addresses in short succession it can indicate use of proxies/VPNs or device spoofing.\
- Although there are zero failed transactions (which might indicate legitimate success), fraud actors often design flows to avoid failures; success does not imply benign activity.\
- No external tool results (Tool Execution Results: none) \'97 we cannot corroborate IP reputation, device reputation, geolocation anomalies, or payment BIN/fraud feeds. That gap lowers absolute confidence but does not negate the strong behavioral signals present.\
\
CRITICAL DATA GAPS\
- CRITICAL DATA GAP: IP reputation data (missing) - Impact: cannot confirm if 103.175.214.243 or other IPs are known VPN/proxy/abuse addresses; reduces confidence in taking automated block actions.\
- CRITICAL DATA GAP: Device reputation / fingerprint enrichment (missing) - Impact: cannot see historical device associations or previous fraud linked to fingerprints 4f20b111-f2c4-4991-ac6d-c08bf8... or 15aa5c03-c3c8-4baf-8df1-69156a...\
- CRITICAL DATA GAP: Email reputation (missing) - Impact: cannot verify whether moeller2media@gmail.com has prior abuse reports or suspicious patterns.\
- CRITICAL DATA GAP: Payment instrument / BIN issuer checks and chargeback history (missing) - Impact: cannot validate whether card(s) involved are high-risk or previously charged back.\
- CRITICAL DATA GAP: Geolocation, ISP, and ASN data (missing) - Impact: cannot assess improbable geography or rapid geo-hopping.\
- CRITICAL DATA GAP: Full IP list and timestamps per device (missing) - Impact: cannot enumerate all IP rotation windows beyond the noted cases.\
These gaps reduce confidence; the most critical missing are IP reputation, device reputation, and payment-instrument/BIN checks.\
\
SPECIFIC RECOMMENDATIONS (must include exact values from the evidence, prioritized)\
\
[CRITICAL] Action: Hold/pending all unsettled transactions for email moeller2media@gmail.com and require manual review of all 23 transactions (Total Volume: $2,444,022.00).\
[CRITICAL] Action: Block or place a temporary hold on activity from IP 103.175.214.243 until reputation/ASN/geolocation checks complete.\
[CRITICAL] Action: Quarantine a\
2025-11-14 08:25:13,338 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 7692 chars)\
2025-11-14 08:25:13,341 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4] \uc0\u9989  Logs analysis complete - Risk: 1.00\
2025-11-14 08:25:13,344 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for logs_agent: 32306ms, 2 steps\
2025-11-14 08:25:13,344 [INFO] app.service.agent.orchestration.domain_agents.logs_agent: [] [Step 5.2.4] \uc0\u9989  Logs analysis complete - Risk: 1.00\
2025-11-14 08:25:13,364 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted logs domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:25:13,365 [INFO] app.service.etag_service: [investigation_id=5ec0a40e-4a19-4869-b286-606c0b04edb6, olorin_tid=88588831-2bd3-44fd-b761-decd6f866bd7] etag_retrieved\
2025-11-14 08:25:13,366 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced logs agent completed\
2025-11-14 08:25:13,366 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 4/6\
[2025-11-14T08:25:13-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:25:13,381 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:25:13,391 [INFO] uvicorn.access: [] 127.0.0.1:62089 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:25:13,392 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:25:13,407 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.342 (low)\
2025-11-14 08:25:13,407 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:25:13,407 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.06\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: authentication_agent (domain: authentication)\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: authentication_agent\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.342 (AIConfidenceLevel.LOW)\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:25:13,408 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: authentication_agent\
2025-11-14 08:25:13,418 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.342 (low)\
2025-11-14 08:25:13,418 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:25:13,418 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.06\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: authentication_agent (domain: authentication)\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: authentication_agent\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.342 (AIConfidenceLevel.LOW)\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:25:13,419 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: authentication_agent\
2025-11-14 08:25:13,420 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence authentication agent starting\
2025-11-14 08:25:13,423 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: [] [Step 5.2.5] \uc0\u55357 \u56592  Authentication agent analyzing investigation\
2025-11-14 08:25:13,423 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for authentication_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:25:13,423 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: [] \uc0\u55357 \u56522  Authentication agent - Sample record structure (first record):\
2025-11-14 08:25:13,423 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: []    Record keys: ['TABLE_RECORD_CREATED_AT', 'TABLE_RECORD_UPDATED_AT', 'EVENT_TYPE', 'ORIGINAL_TX_ID', 'STORE_ID', 'CLIENT_REQUEST_ID', 'APP_ID', 'TX_ID_KEY', 'SURROGATE_APP_TX_ID', 'NSURE_UNIQUE_TX_ID', 'UNIQUE_USER_ID', 'TX_DATETIME', 'TX_RECEIVED_DATETIME', 'TX_UPLOADED_TO_SNOWFLAKE', 'TX_TIMESTAMP_MS', 'IS_SENT_FOR_NSURE_REVIEW', 'AUTHORIZATION_STAGE', 'EMAIL', 'EMAIL_NORMALIZED', 'FIRST_NAME']\
2025-11-14 08:25:13,423 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: []    Sample values: \{'TABLE_RECORD_CREATED_AT': '2025-11-11 08:15:50.507371', 'TABLE_RECORD_UPDATED_AT': '2025-11-11 08:15:50.507371', 'EVENT_TYPE': 'tx', 'ORIGINAL_TX_ID': '21814244-c75f-4a62-b7d3-1c8eb9454bed', 'STORE_ID': None\}\
2025-11-14 08:25:13,423 [WARNING] app.service.agent.orchestration.domain_agents.authentication_agent: [] \uc0\u9888 \u65039  Authentication agent: No evidence collected from analysis functions, adding basic transaction count\
2025-11-14 08:25:13,423 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:25:13,423 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:25:13,423 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:25:13,423 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:25:13,423 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:25:13,423 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:25:13,423 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 23\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.397\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $2,444,022.00 across 23 transactions\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 23):\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:45:01.457000\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,764.00\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:44:28.044000\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,772.00\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:25:12.013000\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:23:33.732000\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:22:02.765000\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,785.00\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 23 raw records \u8594  formatted summary\
2025-11-14 08:25:13,424 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:25:13,425 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are an authentication security expert specializing in login \
            pattern analysis, credential security, and authentication anomaly detection. You \
            understand authentication-based fraud indicators and security risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transact...\
2025-11-14 08:25:13,425 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3476 chars)\
2025-11-14 08:25:13,425 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this authentication domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: moeller2media@gmail.com\
- Domain: authentication\
\
## Evidence Collected\
- Transaction data analyzed: 23 records processed\
- Authentication analysis completed on transaction dataset\
\
## Metrics and Data Points\
- Snowflake Records: 23\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 23\
- Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
- Average Model Score: 0.397\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $2,444,022.00 across 23 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 23):\
  Transaction 1:\
    - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
    - DateTime: 2025-11-11T07:45:01.457000\
    - Amount: $112,764.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
    - DateTime: 2025-11-11T07:44:28.044000\
    - Amount: $112,772.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
    - DateTime: 2025-11-11T07:25:12.013000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
    - DateTime: 2025-11-11T07:23:33.732000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
    - DateTime: 2025-11-11T07:22:02.765000\
    - Amount: $112,785.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTERNS DETECTED (PRIMARY INDICATORS):\
- VELOCITY BURST: 3 transactions in 5 minutes\
- AMOUNT CLUSTERING: $112,718.00 appears 2 times\
- DEVICE-IP MISMATCH: Device 15aa5c03-c3c8-4baf-8df1-69156a... used 2 d...\
2025-11-14 08:25:13,425 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5115 chars)\
[2025-11-14T08:26:10-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:26:10,997 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:26:10,997 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.82\
\
CONFIDENCE: 0.65\
\
RISK FACTORS (increase / decrease):\
- Increase: Velocity burst \'97 3 transactions within ~3 minutes on 2025-11-11 (strong fraud signal).\
- Increase: Amount clustering / identical amounts \'97 $112,778.00 appears at least twice; dataset also flagged $112,718.00 appearing 2 times.\
- Increase: Device\'96IP mismatch \'97 device 15aa5c03-c3c8-4baf-8df1-69156a... observed on 2 different IPs (medium-high signal).\
- Increase: High monetary exposure \'97 Total Volume $2,444,022.00 across only 23 transactions (large per-transaction amounts, >$100k each on samples).\
- Decrease: No confirmed fraud flagged in records and no transactions currently labeled High Risk (>0.7) by the provided model scores \'97 reduces certainty but does not override behavioral signals.\
\
DETAILED REASONING\
(Behavioral patterns are primary \'97 I base the score on those patterns and the financial exposure; MODEL_SCORE values are noted but not used to set the score.)\
\
1) Velocity burst (HIGH signal, primary)\
- Evidence: Three transactions occurred within a 3 minute, 9 second window on 2025-11-11:\
  - Transaction 5: 2025-11-11T07:22:02.765000 \'97 Amount $112,785.00 \'97 IP 103.175.214.243 \'97 Device 4f20b111-f2c4-4991-ac6d-c08bf8...\
  - Transaction 4: 2025-11-11T07:23:33.732000 \'97 Amount $112,778.00 \'97 IP 103.175.214.243 \'97 Device 4f20b111-f2c4-4991-ac6d-c08bf8...\
  - Transaction 3: 2025-11-11T07:25:12.013000 \'97 Amount $112,778.00 \'97 IP 103.175.214.243 \'97 Device 4f20b111-f2c4-4991-ac6d-c08bf8...\
- Interpretation: 3+ high-value transactions within ~3 minutes using the same device/IP is a classic velocity burst and indicates scripted or automated activity or rapid batch use of a credential/payment instrument.\
\
2) Amount clustering / identical amounts (HIGH signal)\
- Evidence: Identical amounts observed:\
  - $112,778.00 appears at least twice (Transaction 3 and 4 above, within ~1.6 minutes).\
  - Dataset also flagged $112,718.00 appearing 2 times (specific timestamps for those occurrences were part of the detected pattern).\
- Interpretation: Repeated near-identical large amounts in short succession is consistent with templated/fraudulent batch transactions or automated misuse of stored payment data.\
\
3) Device\'96IP mismatch / IP rotation (MEDIUM\'96HIGH signal)\
- Evidence: FRAUD PATTERNS DETECTED reports: Device 15aa5c03-c3c8-4baf-8df1-69156a... used with 2 different IPs (explicitly detected).\
- Interpretation: Same device fingerprint appearing from multiple IPs suggests either use of VPN/proxy/IP hopping or device fingerprint collision; both are suspicious in the context of the velocity/amount clustering above.\
\
4) Financial exposure and context\
- Total dataset volume: $2,444,022.00 across 23 transactions \'97 large aggregate exposure increases potential impact of fraud.\
- No transactions are labeled high risk by the provided model (>0.7 = 0) and no confirmed frauds were in the dataset. However, the behavioral anomalies listed are primary fraud indicators per instructions and therefore drive a high risk assessment despite model labels.\
\
5) Missing corroborating signals\
- Some important external signals (IP reputation, device and email reputation, geolocation verification, payment instrument history, chargeback history) are not available in "Tool Execution Results" \'97 this reduces confidence and prevents definitive attribution.\
\
Why 0.82\
- The presence of HIGH-level signals (velocity bursts and amount clustering) plus device\'96IP mismatch and large dollar exposure justifies a high risk score. I stop short of near-certain (\uc0\u8805 0.9) because: (a) tool results / reputation lookups are missing, and (b) there are zero confirmed frauds and zero model high-risk flags in the dataset. Thus 0.82 reflects high operational risk driven by detected behaviors but acknowledges some uncertainty from missing external signals.\
\
CRITICAL DATA GAP(s)\
(\'93No tool execution results available\'94 present \'97 list what cannot be performed and impact)\
- CRITICAL DATA GAP: IP reputation data (missing) - Impact: Cannot confirm if IP 103.175.214.243 or other IPs are part of known proxy/VPN/bot networks; reduces ability to escalate or block with confidence.\
- CRITICAL DATA GAP: Device reputation/fingerprint scoring (missing) - Impact: Cannot confirm whether device 4f20b111-f2c4-4991-ac6d-c08bf8... or 15aa5c03-c3c8-4baf-8df1-69156a... are known malicious or shared fingerprints.\
- CRITICAL DATA GAP: Email reputation / historical compromise checks (missing) - Impact: Cannot confirm whether moeller2media@gmail.com is previously breached or associated with fraud rings.\
- CRITICAL DATA GAP: Geolocation / IP-to-location correlation (missing) - Impact: Cannot detect impossible travel or country mismatches that would strengthen fraud determination.\
- CRITICAL DATA GAP: Payment instrument history (missing) - Impact: Cannot confirm if credit cards are new, re-used, stolen, or previously flagged.\
- CRITICAL DATA GAP: Chargeback/fraud outcome history (missing) - Impact: Cannot determine whether similar events l\
2025-11-14 08:26:10,997 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 7471 chars)\
2025-11-14 08:26:11,000 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5] \uc0\u9989  Authentication analysis complete - Risk: 1.00\
2025-11-14 08:26:11,004 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for authentication_agent: 57578ms, 2 steps\
2025-11-14 08:26:11,004 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: [] [Step 5.2.5] \uc0\u9989  Authentication analysis complete - Risk: 1.00\
2025-11-14 08:26:11,030 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted authentication domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:26:11,031 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced authentication agent completed\
2025-11-14 08:26:11,031 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 5/6\
[2025-11-14T08:26:11-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:26:11,046 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:26:11,058 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:26:11,069 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.355 (low)\
2025-11-14 08:26:11,069 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:26:11,069 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.07\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: merchant_agent (domain: merchant)\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: merchant_agent\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.355 (AIConfidenceLevel.LOW)\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:26:11,070 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: merchant_agent\
2025-11-14 08:26:11,070 [INFO] uvicorn.access: [] 127.0.0.1:62089 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:26:11,080 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.355 (low)\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.07\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:26:11,081 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 6 loops: 0.000\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: merchant_agent (domain: merchant)\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: merchant_agent\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.355 (AIConfidenceLevel.LOW)\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:26:11,081 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: merchant_agent\
2025-11-14 08:26:11,086 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence merchant agent starting\
2025-11-14 08:26:11,089 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u55356 \u57322  Merchant agent analyzing investigation\
2025-11-14 08:26:11,089 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for merchant_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:26:11,089 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] \uc0\u55357 \u56522  Merchant agent processing Snowflake data:\
2025-11-14 08:26:11,089 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data type: dict\
2025-11-14 08:26:11,089 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data keys: ['results', 'row_count', 'columns', 'database', 'schema', 'table', 'query_insights', 'query_validation', 'evidence_completeness', 'query_status', 'execution_timestamp', 'execution_duration_ms', 'schema_info']\
2025-11-14 08:26:11,089 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data['results'] count: 23\
2025-11-14 08:26:11,089 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] \uc0\u55357 \u56522  Sample record structure (first record):\
2025-11-14 08:26:11,089 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    Record keys: ['TABLE_RECORD_CREATED_AT', 'TABLE_RECORD_UPDATED_AT', 'EVENT_TYPE', 'ORIGINAL_TX_ID', 'STORE_ID', 'CLIENT_REQUEST_ID', 'APP_ID', 'TX_ID_KEY', 'SURROGATE_APP_TX_ID', 'NSURE_UNIQUE_TX_ID', 'UNIQUE_USER_ID', 'TX_DATETIME', 'TX_RECEIVED_DATETIME', 'TX_UPLOADED_TO_SNOWFLAKE', 'TX_TIMESTAMP_MS', 'IS_SENT_FOR_NSURE_REVIEW', 'AUTHORIZATION_STAGE', 'EMAIL', 'EMAIL_NORMALIZED', 'FIRST_NAME']\
2025-11-14 08:26:11,089 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    Merchant-related fields: ['MERCHANT_SEGMENT_ID', 'PROCESSOR_MERCHANT_IDENTIFIER', 'MERCHANT_NAME', 'MERCHANT_LAST_DECISION_UPLOADED_TO_SNOWFLAKE', 'MERCHANT_DECISIONS', 'COUNT_MERCHANT_DECISIONS', 'MERCHANT_LAST_DECISION', 'MERCHANT_LAST_DECISION_DATETIME', 'FIRST_MERCHANT_ACCEPTED_DATETIME', 'DAYS_FROM_FIRST_MERCHANT_ACCEPTANCE_TO_TX', 'MERCHANT_KPI_UPDATE_ID']\
2025-11-14 08:26:11,090 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] \uc0\u55357 \u56522  Evidence collected from Snowflake data: 6 items\
2025-11-14 08:26:11,090 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:26:11,090 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:26:11,090 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 23\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.397\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $2,444,022.00 across 23 transactions\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 23):\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:45:01.457000\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,764.00\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:44:28.044000\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,772.00\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
2025-11-14 08:26:11,090 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:25:12.013000\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:23:33.732000\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,778.00\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-11T07:22:02.765000\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $112,785.00\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - IP: 103.175.214.243 (ID)\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Email: moeller2media@gmail.com...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Payment: creditCard\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.409\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 23 raw records \u8594  formatted summary\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a merchant analysis expert.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transactions in short time) = HIGH fraud signal\
- Amount clustering (identical amounts in rapid succession) = HIGH fraud signal  \
- IP rotation (same device, multiple IPs) = MEDIUM-HIGH fraud signal\
- Device-IP m...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3266 chars)\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this merchant domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: moeller2media@gmail.com\
- Domain: merchant\
\
## Evidence Collected\
- Unique merchants: 1 across 23 transactions\
- Merchant risk distribution: High=0, Medium=0, Low=0\
- Merchant velocity: Single merchant (Atlantis Games)\
- Merchant category analysis: Single category or category data not available\
- Merchant decisions: \{'fulfillmentPendingChallengePostCapture': 9, 'Accepted': 14\}\
- Merchant Atlantis Games: Multiple decision types \{'fulfillmentPendingChallengePostCapture', 'Accepted'\}\
\
## Metrics and Data Points\
- Unique Merchants: 1\
- Total Transactions: 23\
- Fraud Transactions: 0\
- Merchant Risk Distribution: \{'UNKNOWN': 23\}\
- Merchant Decision Distribution: \{'fulfillmentPendingChallengePostCapture': 9, 'Accepted': 14\}\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 23\
- Date Range: 2025-10-28T14:44:57.768000 to 2025-11-11T07:45:01.457000\
- Average Model Score: 0.397\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $2,444,022.00 across 23 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 23):\
  Transaction 1:\
    - ID: 21814244-c75f-4a62-b7d3-1c8eb9454bed...\
    - DateTime: 2025-11-11T07:45:01.457000\
    - Amount: $112,764.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 6274f5ca-ab8d-42ca-a6b8-ad25e0f2dfb8...\
    - DateTime: 2025-11-11T07:44:28.044000\
    - Amount: $112,772.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 47ca2b38-772e-4e48-b689-832d09f9636d...\
    - DateTime: 2025-11-11T07:25:12.013000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: cf952756-cdfb-41a5-ac6a-053d8461225f...\
    - DateTime: 2025-11-11T07:23:33.732000\
    - Amount: $112,778.00\
    - IP: 103.175.214.243 (ID)\
    - Email: moeller2media@gmail.com...\
    - Device: 4f20b111-f2c4-4991-ac6d-c08bf8...\
    - Payment: creditCard\
    - Model Score: 0.409\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 1a3b13c8-9395-46b0-9235-0de44a36ec9b...\
    - DateTime: 2025-11-11T07:22:02.765000\
    - Amount: $112,785.00\
    - IP: 103.175.214.24...\
2025-11-14 08:26:11,091 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5603 chars)\
[2025-11-14T08:26:44-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:26:44,023 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55358 \u56598  LLM Response (after receiving formatted Snowflake data):\
2025-11-14 08:26:44,023 [INFO] app.service.agent.evidence_analyzer: []    Response content: RISK SCORE: 0.82 (on 0.0\'961.0 scale)\
\
CONFIDENCE: 0.62 (on 0.0\'961.0 scale)\
\
RISK FACTORS (increasing risk)\
- Velocity burst: 3 transactions within ~3 minutes on 2025-11-11 (07:22:02.765000, 07:23:33.732000, 07:25:12.013000) \'97 HIGH signal.\
- Repeated near-identical high-dollar amounts (amount clustering): examples in sample: $112,764.00; $112,772.00; $112,778.00 (appears twice); $112,785.00. FRAUD PATTERNS note: $112,718.00 appears 2 times \'97 HIGH signal.\
- Device-IP inconsistency: Device 15aa5c03-c3c8-4baf-8df1-69156a... used with 2 different IPs (per FRAUD PATTERNS) \'97 MEDIUM-HIGH signal.\
- Concentration on single merchant/email/device: 23 transactions tied to email moeller2media@gmail.com and merchant Atlantis Games \'97 unusual high-dollar repeat activity.\
- Merchant post-capture challenges: 9 transactions marked fulfillmentPendingChallengePostCapture vs 14 Accepted \'97 indicates merchant flagged orders for review post-capture.\
- High dollar volume concentrated in few transactions: Total volume $2,444,022.00 across 23 transactions \'97 increases financial impact if fraudulent.\
\
RISK FACTORS (decreasing risk)\
- No confirmed fraud in dataset (Confirmed Fraud: 0).\
- No transactions currently blocked; no transactions flagged as high-risk by model score >0.7 in Snowflake (High Risk Transactions: 0).\
\
DETAILED REASONING\
- Primary anomaly detection: The provided FRAUD PATTERNS list identifies velocity bursts and amount clustering as primary indicators. I base the risk score on those behavioral anomalies rather than the model scores (per instruction).\
- Velocity: The sample shows three transactions at 2025-11-11T07:22:02.765000, 07:23:33.732000, 07:25:12.013000 \'97 three transactions within ~3 minutes qualifies as a velocity burst (HIGH fraud signal). There is also another close pair at 07:44:28.044000 and 07:45:01.457000 (2 tx within ~33 seconds), indicating repeated burst behavior across the session.\
- Amount clustering: Multiple transactions are clustered around ~$112.7k amounts (explicit values in evidence: $112,764.00; $112,772.00; $112,778.00 (x2); $112,785.00). FRAUD PATTERNS explicitly note $112,718.00 appears twice. Repeated / templated high-dollar amounts in short windows are a strong fraud signal (HIGH).\
- Device/IP signals: Sample transactions 1\'965 show Device 4f20b111-f2c4-4991-ac6d-c08bf8... using IP 103.175.214.243 repeatedly. FRAUD PATTERNS indicate device 15aa5c03-c3c8-4baf-8df1-69156a... is seen with 2 different IPs (Device-IP mismatch). IP rotation or device appearing on multiple IPs can indicate proxy/VPN usage or account takeover behavior (MEDIUM-HIGH). The combination of clustered amounts, bursts, and device/IP contradictions elevates fraud likelihood.\
- Merchant signals: 9 fulfillmentPendingChallengePostCapture decisions suggest merchant-level concern on a subset of transactions; combined with high-dollar repeated purchases, this supports elevated risk.\
- Offsetting information: There are zero confirmed frauds and zero transactions with model score >0.7. However, per instructions, behavioral anomalies are primary indicators and override lack of confirmed fraud or model high-risk counts.\
- Impact of missing external reputations: No tool execution results were provided (see CRITICAL DATA GAP below). This reduces ability to confirm IP/device/email reputations or cross-check BIN/cardholder history, which lowers overall confidence in the exact numeric score though patterns themselves are strong.\
\
CRITICAL DATA GAP(S)\
- CRITICAL DATA GAP: IP reputation data not available - Impact: cannot confirm if IP 103.175.214.243 (or other IPs tied to device 15aa5c03...) is associated with botnets, proxies, or known fraud.\
- CRITICAL DATA GAP: Device fingerprint reputation not available - Impact: cannot confirm historical malicious use of devices 4f20b111-f2c4-4991-ac6d-c08bf8... or 15aa5c03-c3c8-4baf-8df1-69156a...\
- CRITICAL DATA GAP: Email reputation and historical chargeback/identity information (for moeller2media@gmail.com) not available - Impact: cannot determine if email is linked to known bad actors or previous chargebacks.\
- CRITICAL DATA GAP: BIN/issuer and cardholder history (issuer verification, velocity across cards) not available - Impact: cannot verify if cards used are synthetic or have negative history.\
- CRITICAL DATA GAP: Geo-location and shipping/ billing address verification not provided - Impact: cannot detect mismatches between IP geolocation and billing/shipping destinations.\
These gaps reduce confidence; priority for closing: IP reputation, device reputation, email/identity reputation.\
\
RECOMMENDATIONS (ordered and using exact evidence values)\
- [CRITICAL] Action: Check IP reputation for 103.175.214.243 \'97 block or require additional verification if IP is listed for proxy/VPN/botnet.\
- [CRITICAL] Action: Investigate device fingerprint 15aa5c03-c3c8-4baf-8df1-69156a... for IP rotation and prior fraud history \'97 if device seen with multiple IPs or known malicious history, suspend transactions and requi\
2025-11-14 08:26:44,024 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 7082 chars)\
2025-11-14 08:26:44,029 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7] \uc0\u9989  Merchant analysis complete - Risk: 1.00\
2025-11-14 08:26:44,034 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for merchant_agent: 32940ms, 2 steps\
2025-11-14 08:26:44,034 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u9989  Merchant analysis complete - Evidence collected: 7 points\
2025-11-14 08:26:44,035 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: [] \uc0\u55357 \u56589  Running merchant validation for investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:26:44,035 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: []    Entity: email=moeller2media@gmail.com\
2025-11-14 08:26:44,035 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: []    Historical date: 2025-05-18\
2025-11-14 08:26:44,035 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
            TX_ID_KEY,\
            TX_DATETIME,\
            MERCHANT_NAME,\
            PAID_AMOUNT_VALUE_IN_CURRENCY,\
            MODEL_SCORE,\
            IS_FRAUD_TX\
        FROM DBT.DBT_PROD...\
2025-11-14 08:26:44,039 [INFO] app.service.etag_service: [olorin_tid=32f7af54-2b79-4d5c-8022-5d62f02dfa93, investigation_id=e2dd40a0-761e-45e9-b9a5-5f66c3bb8c8b] etag_retrieved\
[2025-11-14T08:26:44-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:442: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_verify(_stdlib_to_openssl_verify[value], _verify_callback)\
2025-11-14 08:26:44,066 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:26:44,077 [INFO] uvicorn.access: [] 127.0.0.1:62089 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:26:45,045 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 0 rows\
2025-11-14 08:26:45,045 [WARNING] app.service.agent.orchestration.domain_agents.merchant_validation: [] \uc0\u9888 \u65039  No historical data found for validation\
2025-11-14 08:26:45,045 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u9989  Merchant validation completed\
2025-11-14 08:26:45,059 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted merchant domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 1.0, has_llm_analysis: True)\
2025-11-14 08:26:45,059 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced merchant agent completed\
2025-11-14 08:26:45,059 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 6/6\
2025-11-14 08:26:45,060 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.369 (low)\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.08\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:26:45,071 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 6 loops: 0.000\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.369 (AIConfidenceLevel.LOW)\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:26:45,071 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.369 (low)\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.09\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:26:45,083 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 7 loops: 0.000\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.369 (AIConfidenceLevel.LOW)\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:26:45,083 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:26:45,085 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:26:45,087 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:26:45,087 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:26:45,088 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=1.000, tx_risk=0.399, blended=0.820\
2025-11-14 08:26:45,088 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:26:45,088 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:27:21-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:27:21,769 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:27:21,769 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:27:21,769 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.82\
2025-11-14 08:27:21,770 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 36681ms, 2 steps\
2025-11-14 08:27:21,770 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 13 synthesis points\
2025-11-14 08:27:21,792 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.8197330188062955, has_llm_analysis: True)\
2025-11-14 08:27:21,793 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:27:21,793 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:27:21-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:27:21,804 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:27:21,815 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.09\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:27:21,826 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 7 loops: 0.000\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:27:21,826 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:27:21,837 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:27:21,837 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:27:21,837 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:27:21,838 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 8 loops: 0.000\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:27:21,838 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:27:21,839 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:27:21,842 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:27:21,842 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:27:21,842 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.966, tx_risk=0.399, blended=0.796\
2025-11-14 08:27:21,842 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:27:21,843 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:02-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:28:02,565 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:28:02,565 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:28:02,565 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.80\
2025-11-14 08:28:02,568 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 40723ms, 2 steps\
2025-11-14 08:28:02,568 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:28:02,595 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7956974213138015, has_llm_analysis: True)\
2025-11-14 08:28:02,595 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:28:02,595 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:28:02-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:28:02,607 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:28:02,617 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:28:02,626 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:02,626 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:02,626 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:02,626 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:02,627 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 8 loops: 0.000\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:02,627 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:28:02,627 [INFO] uvicorn.access: [] 127.0.0.1:63523 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:28:02,636 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:02,636 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:02,636 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:02,637 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 9 loops: 0.000\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:02,637 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:28:02,639 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:28:02,641 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:28:02,641 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:28:02,642 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.961, tx_risk=0.399, blended=0.792\
2025-11-14 08:28:02,642 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:28:02,642 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:38-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"\
2025-11-14 08:28:38,867 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete\
2025-11-14 08:28:38,867 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:28:38,867 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:28:38,869 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 36226ms, 2 steps\
2025-11-14 08:28:38,869 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:28:38,893 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.792492674981469, has_llm_analysis: True)\
2025-11-14 08:28:38,894 [INFO] app.service.etag_service: [investigation_id=7f493b4a-c120-4b5d-9dce-2ceff685c869, olorin_tid=bdcbf3f9-4f35-47b9-ad1b-690bee24b4fa] etag_retrieved\
2025-11-14 08:28:38,895 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:28:38,895 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:28:38-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"\
2025-11-14 08:28:38,911 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:28:38,922 [INFO] uvicorn.access: [] 127.0.0.1:63523 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:28:38,923 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:38,936 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 9 loops: 0.000\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:38,936 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:28:38,948 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:38,948 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:38,948 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:38,948 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:38,948 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:38,948 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:38,948 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:38,949 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:28:38,949 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:38,949 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 10 loops: 0.000\
2025-11-14 08:28:38,949 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:38,949 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:38,949 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:38,949 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:38,949 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:38,949 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:28:38,950 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:28:38,968 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:28:38,969 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:28:38,969 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:28:38,969 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:28:38,969 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:39-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:39-0500] INFO [] module=_base_client: Retrying request to /responses in 0.409773 seconds\
[2025-11-14T08:28:40-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:40-0500] INFO [] module=_base_client: Retrying request to /responses in 0.794046 seconds\
[2025-11-14T08:28:41-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:28:41,802 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:41,802 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:41,802 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:28:41,802 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:28:41,804 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2834ms, 2 steps\
2025-11-14 08:28:41,804 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:28:41,818 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7920653754704914, has_llm_analysis: True)\
2025-11-14 08:28:41,819 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:28:41,819 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:28:41-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:41-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.440611 seconds\
2025-11-14 08:28:41,821 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:41,831 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 10 loops: 0.000\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:41,831 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:41,841 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 11 loops: 0.000\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:41,841 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:28:41,843 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:28:41,847 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:28:41,847 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:28:41,847 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:28:41,847 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:28:41,847 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:42-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:42-0500] INFO [] module=_base_client: Retrying request to /responses in 0.439455 seconds\
[2025-11-14T08:28:43-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:43-0500] INFO [] module=_base_client: Retrying request to /responses in 0.967543 seconds\
[2025-11-14T08:28:45-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:28:45,139 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:45,139 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:45,139 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:28:45,139 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:28:45,141 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3293ms, 2 steps\
2025-11-14 08:28:45,141 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:28:45,156 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7920084022023609, has_llm_analysis: True)\
2025-11-14 08:28:45,156 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:28:45,156 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:28:45,169 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:28:45,179 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:28:45,188 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:45,188 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:45,188 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:45,189 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 11 loops: 0.000\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:45,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.12\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:45,199 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 12 loops: 0.000\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:45,199 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:28:45,200 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:28:45,203 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:28:45,203 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:28:45,203 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:28:45,204 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:28:45,204 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:45-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:45-0500] INFO [] module=_base_client: Retrying request to /responses in 0.447996 seconds\
[2025-11-14T08:28:46-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:46-0500] INFO [] module=_base_client: Retrying request to /responses in 0.867699 seconds\
[2025-11-14T08:28:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:28:48,025 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:48,025 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:48,025 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:28:48,025 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:28:48,026 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2822ms, 2 steps\
2025-11-14 08:28:48,026 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:28:48,041 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7920008057666102, has_llm_analysis: True)\
2025-11-14 08:28:48,041 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:28:48,041 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:28:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:48-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.916335 seconds\
2025-11-14 08:28:48,043 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:28:48,052 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:48,052 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:48,052 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.12\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:48,053 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 12 loops: 0.000\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:48,053 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:28:48,062 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:48,063 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 13 loops: 0.000\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:48,063 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:28:48,064 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:28:48,067 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:28:48,067 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:28:48,068 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:28:48,068 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:28:48,068 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:48-0500] INFO [] module=_base_client: Retrying request to /responses in 0.412419 seconds\
[2025-11-14T08:28:49-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:49-0500] INFO [] module=_base_client: Retrying request to /responses in 0.884104 seconds\
[2025-11-14T08:28:51-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:28:51,242 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:51,242 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:51,242 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:28:51,242 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:28:51,244 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3175ms, 2 steps\
2025-11-14 08:28:51,244 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:28:51,258 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7919997929085102, has_llm_analysis: True)\
2025-11-14 08:28:51,259 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:28:51,259 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:28:51,276 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:28:51,285 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:51,295 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 13 loops: 0.000\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:51,295 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:51,305 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 14 loops: 0.000\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:51,305 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:28:51,306 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:28:51,310 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:28:51,310 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:28:51,310 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:28:51,310 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:28:51,310 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:51-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:51-0500] INFO [] module=_base_client: Retrying request to /responses in 0.390295 seconds\
[2025-11-14T08:28:52-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:52-0500] INFO [] module=_base_client: Retrying request to /responses in 0.767450 seconds\
[2025-11-14T08:28:53-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:28:53,965 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:53,965 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:53,965 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:28:53,965 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:28:53,966 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2655ms, 2 steps\
2025-11-14 08:28:53,966 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:28:53,980 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7919996578607634, has_llm_analysis: True)\
2025-11-14 08:28:53,980 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:28:53,980 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:28:53-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:28:53,981 [ERROR] app.service.rag.embedding_service: [] OpenAI embedding generation failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:53,981 [WARNING] app.service.rag.vector_rag_service: [] Failed to generate embedding for chunk 14: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:53,983 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:53,993 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 14 loops: 0.000\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:53,993 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:53,994 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:28:54,003 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:54,004 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 15 loops: 0.000\
2025-11-14 08:28:54,004 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:54,004 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:54,004 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:54,004 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:54,004 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:54,004 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:28:54,005 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:28:54,008 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:28:54,008 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:28:54,008 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:28:54,008 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:28:54,008 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:55-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:55-0500] INFO [] module=_base_client: Retrying request to /responses in 0.412376 seconds\
[2025-11-14T08:28:55-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:55-0500] INFO [] module=_base_client: Retrying request to /responses in 0.850386 seconds\
[2025-11-14T08:28:57-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:28:57,130 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:57,130 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:28:57,130 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:28:57,130 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:28:57,131 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3122ms, 2 steps\
2025-11-14 08:28:57,131 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:28:57,145 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7919996398543973, has_llm_analysis: True)\
2025-11-14 08:28:57,145 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:28:57,145 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:28:57-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:28:57,158 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
[2025-11-14T08:28:57-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.409018 seconds\
2025-11-14 08:28:57,167 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:28:57,178 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:57,178 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:57,178 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:57,178 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:57,178 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:57,178 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:57,179 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 15 loops: 0.000\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:57,179 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:28:57,190 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 16 loops: 0.000\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:28:57,190 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:28:57,191 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:28:57,195 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:28:57,195 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:28:57,195 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:28:57,195 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:28:57,195 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:28:57-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:57-0500] INFO [] module=_base_client: Retrying request to /responses in 0.491908 seconds\
[2025-11-14T08:28:58-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:28:58-0500] INFO [] module=_base_client: Retrying request to /responses in 0.817468 seconds\
[2025-11-14T08:29:01-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:29:01,105 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:01,105 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:01,105 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:29:01,105 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:29:01,106 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3911ms, 2 steps\
2025-11-14 08:29:01,106 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:29:01,126 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7919996374535484, has_llm_analysis: True)\
2025-11-14 08:29:01,126 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:29:01,126 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:29:01,128 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:29:01,139 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 16 loops: 0.000\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:01,139 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:29:01,149 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:01,149 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:01,149 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.15\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:29:01,150 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 17 loops: 0.000\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:01,150 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:29:01,151 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:29:01,156 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:29:01,156 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:29:01,156 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:29:01,157 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:29:01,157 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:29:01-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:01-0500] INFO [] module=_base_client: Retrying request to /responses in 0.423928 seconds\
[2025-11-14T08:29:02-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:02-0500] INFO [] module=_base_client: Retrying request to /responses in 0.779037 seconds\
[2025-11-14T08:29:03-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:29:03,968 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:03,968 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:03,968 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:29:03,968 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:29:03,969 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2812ms, 2 steps\
2025-11-14 08:29:03,970 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:29:03,984 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7919996371334352, has_llm_analysis: True)\
2025-11-14 08:29:03,984 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:29:03,984 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:29:03-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:29:03,996 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
[2025-11-14T08:29:04-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.879109 seconds\
2025-11-14 08:29:04,005 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.15\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:29:04,014 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 17 loops: 0.000\
2025-11-14 08:29:04,014 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:04,015 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:04,015 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:04,015 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:04,015 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:04,015 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.17\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:29:04,026 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 18 loops: 0.000\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:04,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:29:04,027 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:29:04,029 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:29:04,029 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:29:04,030 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:29:04,030 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:29:04,030 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:29:04-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:04-0500] INFO [] module=_base_client: Retrying request to /responses in 0.495680 seconds\
[2025-11-14T08:29:05-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:05-0500] INFO [] module=_base_client: Retrying request to /responses in 0.909069 seconds\
[2025-11-14T08:29:07-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:29:07,072 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:07,072 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:07,072 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:29:07,072 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:29:07,073 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3043ms, 2 steps\
2025-11-14 08:29:07,073 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:29:07,088 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7919996370907536, has_llm_analysis: True)\
2025-11-14 08:29:07,088 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:29:07,088 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:29:07,090 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:29:07,101 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:07,101 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:07,101 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.17\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:29:07,102 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 18 loops: 0.000\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:07,102 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.19\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:29:07,113 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 19 loops: 0.000\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:07,113 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:29:07,115 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:29:07,118 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:29:07,119 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:29:07,119 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:29:07,119 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:29:07,119 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:29:07-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:07-0500] INFO [] module=_base_client: Retrying request to /responses in 0.421314 seconds\
[2025-11-14T08:29:08-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:08-0500] INFO [] module=_base_client: Retrying request to /responses in 0.800743 seconds\
[2025-11-14T08:29:09-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:29:09,732 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:09,732 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:09,732 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:29:09,732 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:29:09,733 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2613ms, 2 steps\
2025-11-14 08:29:09,733 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:29:09,748 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7919996370850627, has_llm_analysis: True)\
2025-11-14 08:29:09,748 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:29:09,748 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:29:09-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:29:09,765 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:29:09,773 [ERROR] app.service.rag.embedding_service: [] OpenAI embedding generation failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:09,773 [WARNING] app.service.rag.vector_rag_service: [] Failed to generate embedding for chunk 15: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:09,775 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.19\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:29:09,787 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 19 loops: 0.000\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:09,787 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:29:09,797 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:09,797 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:09,797 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:09,797 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:09,797 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:09,797 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:09,797 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:09,797 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.22\
2025-11-14 08:29:09,798 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 2\
2025-11-14 08:29:09,798 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  HIGH: Orchestrator loop limit approaching: 20/25\
2025-11-14 08:29:09,798 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 20 loops: 0.000\
2025-11-14 08:29:09,798 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:09,798 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:09,798 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:09,798 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:09,798 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:09,798 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:29:09,799 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:29:09,801 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:29:09,801 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:29:09,802 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.960, tx_risk=0.399, blended=0.792\
2025-11-14 08:29:09,802 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:29:09,802 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:29:10-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:10-0500] INFO [] module=_base_client: Retrying request to /responses in 0.459377 seconds\
[2025-11-14T08:29:11-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:11-0500] INFO [] module=_base_client: Retrying request to /responses in 0.976650 seconds\
[2025-11-14T08:29:13-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:29:13,115 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:13,115 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:13,115 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:29:13,115 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.79\
2025-11-14 08:29:13,119 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3314ms, 2 steps\
2025-11-14 08:29:13,120 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:29:13,147 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-3d0f6225dbb6 (risk_score: 0.7919996370843038, has_llm_analysis: True)\
2025-11-14 08:29:13,148 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:29:13,148 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:29:13-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:13-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.402502 seconds\
2025-11-14 08:29:13,150 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.22\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 2\
2025-11-14 08:29:13,164 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  HIGH: Orchestrator loop limit approaching: 20/25\
2025-11-14 08:29:13,164 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 20 loops: 0.000\
2025-11-14 08:29:13,164 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:29:13,165 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:29:13,165 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:13,165 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:13,165 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:29:13,165 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.381 (low)\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: domain_analysis\
2025-11-14 08:29:13,176 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u55357 \u57000  Immediate termination required: 2 critical concerns\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: emergency\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: False\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: True\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 1.00\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 3\
2025-11-14 08:29:13,176 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  CRITICAL: Orchestrator loop limit approaching: 21/12\
2025-11-14 08:29:13,176 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  CRITICAL: High resource pressure: 1.00\
2025-11-14 08:29:13,176 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 21 loops: 0.000\
2025-11-14 08:29:13,176 [WARNING] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55357 \u57000  Emergency termination required\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: summary\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.381 (AIConfidenceLevel.LOW)\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: True\
2025-11-14 08:29:13,176 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: summary\
2025-11-14 08:29:13,176 [WARNING] app.service.agent.orchestration.hybrid.intelligent_router: []    \uc0\u9888 \u65039  Safety override: emergency_termination\
2025-11-14 08:29:13,178 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u55357 \u56523  Hybrid Intelligence summary generation starting\
2025-11-14 08:29:13,178 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Confidence consolidated: 0.000 (MINIMAL)\
2025-11-14 08:29:13,178 [INFO] app.service.agent.orchestration.risk.evidence_gating: [] \uc0\u9989  Detected comprehensive Snowflake data: 23 transactions with fraud indicators\
2025-11-14 08:29:13,178 [INFO] app.service.agent.orchestration.risk.evidence_gating: [] \uc0\u55357 \u56580  Adjusted external score to 0.4 due to comprehensive Snowflake data\
2025-11-14 08:29:13,178 [INFO] app.service.agent.orchestration.risk.evidence_gating: [] \uc0\u55357 \u57057 \u65039  Evidence gating: Risk capped at 0.400 due to capped_for_low_evidence\
2025-11-14 08:29:13,178 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Evidence gating applied: strength=0.446\
2025-11-14 08:29:13,178 [INFO] app.service.agent.orchestration.risk.policy: [] \uc0\u55357 \u56594  LLM narrative isolation: Updated 6 domains - ['network', 'device', 'location', 'logs', 'authentication', 'merchant']\
2025-11-14 08:29:13,178 [INFO] app.service.agent.orchestration.risk.policy: []    Engine math will now exclude LLM claimed_risk from all calculations\
2025-11-14 08:29:13,180 [INFO] app.service.agent.orchestration.risk.finalize: [] Cross-domain deduplication: removed 14 duplicate paragraphs\
2025-11-14 08:29:13,180 [INFO] app.service.agent.orchestration.risk.finalize: [] \uc0\u55357 \u56589  Fraud pattern score: 0.340\
2025-11-14 08:29:13,180 [INFO] app.service.agent.orchestration.risk.finalize: []    Patterns detected: velocity=True, clustering=True, rotation=False\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.finalize: [] Evidence strength computed: 0.600 (diversity: 0.10, corroboration: 0.20, volume: 0.20, quality: 0.10) [internal: False, external: 0, domains: 7]\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.finalize: [] \uc0\u55357 \u56589  compute_final_risk: domain_findings type=<class 'dict'>, keys=['network', 'device', 'location', 'logs', 'authentication', 'merchant', 'risk']\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.finalize: []    logs: risk_score=1.0\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.finalize: []    network: risk_score=1.0\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.finalize: []    device: risk_score=1.0\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.finalize: []    location: risk_score=1.0\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.finalize: []    authentication: risk_score=1.0\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u9989  EVIDENCE GATING: PASS (scores=5, signals=18)\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: numeric_domains=['logs', 'network', 'device', 'location', 'authentication']\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: scores=[1.0, 1.0, 1.0, 1.0, 1.0]\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: pre_gate=1.000, final=1.000, gate=PASS\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.policy: [] \uc0\u55357 \u56580  RECONCILED: is_public for moeller2media@gmail.com: None \u8594  True\
2025-11-14 08:29:13,181 [ERROR] app.service.agent.orchestration.domain.linter: [] \uc0\u55357 \u57000  LINTING FAILURES DETECTED (1 issues):\
2025-11-14 08:29:13,181 [ERROR] app.service.agent.orchestration.domain.linter: []   1. state.risk_score (0.4) != final_risk (1.0)\
2025-11-14 08:29:13,181 [WARNING] app.service.agent.orchestration.risk.finalize: [] \uc0\u55357 \u57000  LINTING VIOLATIONS DETECTED: 1 issues before publishing risk\
2025-11-14 08:29:13,181 [WARNING] app.service.agent.orchestration.risk.finalize: []    LINT ERROR 1: state.risk_score (0.4) != final_risk (1.0)\
2025-11-14 08:29:13,181 [ERROR] app.service.agent.orchestration.domain.linter: [] \uc0\u55357 \u57000  LINTING FAILURES DETECTED (1 issues):\
2025-11-14 08:29:13,181 [ERROR] app.service.agent.orchestration.domain.linter: []   1. state.risk_score (0.4) != final_risk (1.0)\
2025-11-14 08:29:13,181 [WARNING] app.service.agent.orchestration.domain.linter: [] \uc0\u9888 \u65039   Investigation linting warnings: 1 issues\
2025-11-14 08:29:13,181 [WARNING] app.service.agent.orchestration.domain.linter: []   WARNING: state.risk_score (0.4) != final_risk (1.0)\
2025-11-14 08:29:13,181 [INFO] app.service.agent.orchestration.risk.finalize: [] \uc0\u55356 \u57263  Action plan generated: 4 recommendations for risk 1.000\
2025-11-14 08:29:13,181 [WARNING] app.service.agent.orchestration.risk.finalize: [] end_time missing - computing defensively to prevent crash\
2025-11-14 08:29:13,181 [WARNING] app.service.agent.orchestration.risk.finalize: [] \uc0\u9888 \u65039  FALLBACK: No valid timing data, using current time as end_time = 2025-11-14T13:29:13.181976+00:00\
2025-11-14 08:29:13,182 [ERROR] app.service.agent.orchestration.risk.finalize: [] \uc0\u10060  Business logic regression detected: tools_used=1 but tool_results is empty\
2025-11-14 08:29:13,182 [ERROR] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u10060  Enhanced summary failed: tools_used=1 but tool_results is empty\
2025-11-14 08:29:13,182 [ERROR] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] Enhanced summary generation error details\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/orchestration/hybrid/graph/nodes/summary_nodes.py", line 123, in enhanced_summary_node\
    finalize_risk(state)\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/orchestration/risk/finalize.py", line 290, in finalize_risk\
    _assert_sanity_checks(state, final_risk)\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/orchestration/risk/finalize.py", line 644, in _assert_sanity_checks\
    _assert_business_logic_regressions(state)\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/orchestration/risk/finalize.py", line 706, in _assert_business_logic_regressions\
    assert len(tool_results) > 0, f"tools_used=\{len(tools_used)\} but tool_results is empty"\
           ^^^^^^^^^^^^^^^^^^^^^\
AssertionError: tools_used=1 but tool_results is empty\
2025-11-14 08:29:13,184 [INFO] app.service.agent.orchestration.hybrid.canonical_outcome: [] \uc0\u9989  Canonical outcome built: failed for auto-comp-3d0f6225dbb6\
2025-11-14 08:29:13,184 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u55357 \u57057 \u65039  Canonical outcome generated for error case: failed\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Hybrid Intelligence Graph investigation completion\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u55357 \u56522  Final Investigation Statistics:\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Investigation ID: auto-comp-3d0f6225dbb6\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Total duration: 0ms\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Orchestrator loops: 21\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Domains completed: 7/6\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Tools used: 1\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Safety overrides: 0\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Final confidence: 0.000\
2025-11-14 08:29:13,189 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Investigation efficiency: 0.744\
2025-11-14 08:29:13,197 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56523  REAL AGENT SERVICE RESULT: Investigation completed...\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  LLM Call: MultiAgentOrchestrator \u8594  gpt-4o\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Tools: langgraph_parallel_execution, recursion_guard | Tokens: 126.80000000000001\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Completed real structured investigation execution in 520905ms with RecursionGuard protection.\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  Decision: DeviceAnalysisAgent \u8594  device_analysis_complete\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Confidence: 95.00 | Outcome: N/A\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Device analysis completed successfully with comprehensive findings\
2025-11-14 08:29:13,198 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u9989  REAL AGENT EXECUTION COMPLETED in 520905ms\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: DeviceAnalysisAgent (analysis_agent)\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 104181ms \uc0\u8594  LocationAnalysisAgent\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['device_analysis_completed']\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: LocationAnalysisAgent (analysis_agent)\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 104181ms \uc0\u8594  NetworkAnalysisAgent\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['location_analysis_completed']\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: NetworkAnalysisAgent (analysis_agent)\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 104181ms \uc0\u8594  LogsAnalysisAgent\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['network_analysis_completed']\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: LogsAnalysisAgent (analysis_agent)\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 104181ms \uc0\u8594  RiskAssessmentAgent\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['logs_analysis_completed']\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: RiskAssessmentAgent (synthesis_agent)\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 104181ms \uc0\u8594  END\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['all_analyses_completed', 'risk_assessment_completed']\
2025-11-14 08:29:13,198 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  results_processing\
2025-11-14 08:29:13,199 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 75% | Phases: 3 completed\
2025-11-14 08:29:13,199 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: results_processing\
2025-11-14 08:29:13,214 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-3d0f6225dbb6: \{'current_phase': 'results_processing', 'progress_percentage': 85.0\}\
2025-11-14 08:29:13,214 [INFO] app.router.controllers.investigation_completion: [] \uc0\u55357 \u56523  REAL AGENT RESULT CONTENT: Investigation completed...\
2025-11-14 08:29:13,214 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  results_processing\
2025-11-14 08:29:13,214 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 75% | Phases: 3 completed\
2025-11-14 08:29:13,214 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: results_processing\
2025-11-14 08:29:13,225 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-3d0f6225dbb6: \{'current_phase': 'results_processing', 'progress_percentage': 85.0\}\
2025-11-14 08:29:13,226 [INFO] app.router.controllers.investigation_completion: [] \uc0\u55357 \u56523  REAL AGENT RESULT CONTENT: Investigation completed...\
2025-11-14 08:29:13,227 [INFO] app.service.agent.journey_tracker: [] Completed journey tracking for investigation: auto-comp-3d0f6225dbb6 (225ms, 6 nodes)\
2025-11-14 08:29:13,240 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-3d0f6225dbb6: \{'current_phase': 'completion', 'progress_percentage': 100.0, 'status': 'completed'\}\
2025-11-14 08:29:13,241 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: completed \u8594  completion\
2025-11-14 08:29:13,241 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 80% | Phases: 4 completed\
2025-11-14 08:29:13,254 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-3d0f6225dbb6: \{'status': 'completed', 'completion_time': '2025-11-14T13:29:13.241113+00:00', 'findings_summary': \{'risk_score': None, 'findings': [\{'investigation_outcome': 'REAL structured investigation completed', 'total_agents_used': 5, 'investigation_duration_ms': 0, 'real_agent_execution': True\}], 'summary': 'Investigation completed', 'completed_at': '2025-11-14T13:29:13.241125+00:00'\}\}\
2025-11-14 08:29:13,254 [INFO] app.router.controllers.investigation_completion: [] Completed structured investigation: auto-comp-3d0f6225dbb6\
2025-11-14 08:29:13,254 [INFO] app.service.agent.recursion_guard: [] Removed context for investigation auto-comp-3d0f6225dbb6, final stats: \{'investigation_id': 'auto-comp-3d0f6225dbb6', 'thread_id': 'auto-comp-3d0f6225dbb6-None', 'duration_seconds': 521.0313830375671, 'current_depth': 0, 'max_depth_reached': 0, 'total_tool_calls': 0, 'unique_tools_used': 0, 'node_path': [], 'tool_sequence': []\}\
2025-11-14 08:29:13,254 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u57057 \u65039  Cleaned up RecursionGuard context for investigation auto-comp-3d0f6225dbb6\
2025-11-14 08:29:13,254 [INFO] app.router.controllers.investigation_executor: [] Completed structured investigation: auto-comp-3d0f6225dbb6\
[2025-11-14T08:29:13-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:13-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.856338 seconds\
[2025-11-14T08:29:14-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:29:14,533 [ERROR] app.service.rag.embedding_service: [] OpenAI embedding generation failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:29:14,533 [WARNING] app.service.rag.vector_rag_service: [] Failed to generate embedding for chunk 16: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
[2025-11-14T08:29:14-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:14-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.378813 seconds\
2025-11-14 08:29:14,786 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-3d0f6225dbb6: progress_json exists=True, has tool_executions=True, count=1\
2025-11-14 08:29:14,793 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Investigation auto-comp-3d0f6225dbb6 completed!\
2025-11-14 08:29:15,386 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Created and completed historical investigation: auto-comp-3d0f6225dbb6\
2025-11-14 08:29:15,386 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Prediction Validation Setup:\
2025-11-14 08:29:15,386 [INFO] app.service.investigation.auto_comparison: []    Window A (Historical Investigation): 2025-10-28 to 2025-11-11\
2025-11-14 08:29:15,386 [INFO] app.service.investigation.auto_comparison: []    Window B (Validation Period): 2025-11-11 to 2025-11-14\
2025-11-14 08:29:15,386 [INFO] app.service.investigation.auto_comparison: []    Predicted Risk: None\
2025-11-14 08:29:15,387 [INFO] app.service.agent.tools.database_tool.database_factory: [] Database provider initialized: snowflake\
2025-11-14 08:29:15,387 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-10-28T14:44:57.768000-04:00' AND TX_DATETIME < '2025-11-11T13:44:57.768000-05:00' AND EMAIL_NORMALIZED = 'moeller2media@gmail....\
2025-11-14 08:29:15,388 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Using private key authentication for user: manual_review_agent_ro\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Private key loaded from: /Users/gklainert/rsa_key.p8\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u55357 \u56599  Initiating Snowflake connection...\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Account: ETMZUSX-LW98386\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    User: manual_review_agent_ro\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Auth Method: private_key\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Private Key: rsa_key.p8\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Database: DBT\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Schema: DBT_PROD\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Warehouse: manual_review_agent_wh\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Role: PUBLIC\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    Timeout: 300s\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: []    This may take 30-60 seconds...\
2025-11-14 08:29:15,435 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Connecting to Snowflake account: ETMZUSX-LW98386\
[2025-11-14T08:29:15-0500] INFO [] module=connection: Snowflake Connector for Python Version: 3.17.3, Python Version: 3.11.12, Platform: macOS-15.7.2-x86_64-i386-64bit\
[2025-11-14T08:29:15-0500] INFO [] module=connection: Connecting to GLOBAL Snowflake domain\
2025-11-14 08:29:17,907 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] \uc0\u9989  Successfully connected to Snowflake: DBT.DBT_PROD\
2025-11-14 08:29:19,361 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:29:19,361 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:29:19,362 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-11-11T13:44:57.768000-05:00' AND TX_DATETIME < '2025-11-14T08:20:22.121090-05:00' AND EMAIL_NORMALIZED = 'moeller2media@gmail....\
2025-11-14 08:29:19,843 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:29:19,843 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:29:19,843 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email:moeller2media@gmail.com in comparison windows. Window A: 0 transactions, Window B: 0 transactions. Skipping comparison - entity may not have sufficient historical data.\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Auto-Comparison 3/3\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: []    Entity: okuoku1959122@gmail.com\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: []    Entity Type: email\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: []    Risk Score: 0.464\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: []    Transactions: 7\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Running auto-comparison for entity: email=okuoku1959122@gmail.com\
2025-11-14 08:29:20,845 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Looking for historical investigations between 2025-05-18 and 2025-08-16\
2025-11-14 08:29:21,246 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  Investigation inv-1762911549893-xk0267ez has no risk score, skipping...\
2025-11-14 08:29:21,246 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No historical investigation found - creating new investigation...\
2025-11-14 08:29:21,247 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-02T08:29:20.845872-05:00' AND TX_DATETIME < '2025-08-16T08:29:20.845872-05:00' AND EMAIL_NORMALIZED = 'okuoku1959122@gmail....\
2025-11-14 08:29:22,762 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:29:22,763 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:29:22,763 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-16T08:29:20.845872-05:00' AND TX_DATETIME < '2025-11-14T08:29:20.845872-05:00' AND EMAIL_NORMALIZED = 'okuoku1959122@gmail....\
2025-11-14 08:29:26,018 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:29:26,018 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:29:26,018 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found in desired historical window (2025-08-02 to 2025-08-16)\
2025-11-14 08:29:26,018 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56589  Finding actual transaction date range for email=okuoku1959122@gmail.com...\
2025-11-14 08:29:26,019 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
                MIN(TX_DATETIME) as earliest_date,\
                MAX(TX_DATETIME) as latest_date,\
                COUNT(*) as tx_count\
            FROM DBT.DBT_PROD.TXS\
            WHERE TX_...\
2025-11-14 08:29:31,641 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:29:31,641 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:29:31,642 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56517  Found transaction date range for email=okuoku1959122@gmail.com: 2025-11-01 to 2025-11-13 (59 transactions)\
2025-11-14 08:29:31,642 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  Insufficient transaction span (12 days) for meaningful comparison\
2025-11-14 08:29:31,642 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating historical investigation:\
2025-11-14 08:29:31,642 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-08-02 to 2025-08-16\
2025-11-14 08:29:31,642 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56616  Creating investigation auto-comp-a022e93e4e7f for email=okuoku1959122@gmail.com\
2025-11-14 08:29:31,642 [INFO] app.service.investigation.auto_comparison: []    Window: 2025-08-02 to 2025-08-16\
2025-11-14 08:29:31,647 [INFO] app.service.investigation_trigger_service: [] Extracted structured investigation request for auto-comp-a022e93e4e7f: entity_id=okuoku1959122@gmail.com, entity_type=email\
2025-11-14 08:29:31,647 [INFO] app.service.investigation_trigger_service: [] Initialized progress_json for investigation auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,648 [INFO] app.service.investigation_trigger_service: [] State update verification for auto-comp-a022e93e4e7f: lifecycle_stage=IN_PROGRESS, status=IN_PROGRESS, version=2, progress_json_initialized=True\
2025-11-14 08:29:31,649 [INFO] app.service.investigation_trigger_service: [] Updated investigation auto-comp-a022e93e4e7f state to IN_PROGRESS (version 1 -> 2)\
2025-11-14 08:29:31,650 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56960  Triggering investigation execution for auto-comp-a022e93e4e7f...\
2025-11-14 08:29:31,650 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Investigation auto-comp-a022e93e4e7f created and execution triggered, waiting for completion...\
2025-11-14 08:29:31,650 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9881 \u65039  BACKGROUND TASK STARTED: execute_structured_investigation for auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,650 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960 \u55357 \u56960 \u55357 \u56960  STARTING BACKGROUND INVESTIGATION: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,650 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-a022e93e4e7f already in IN_PROGRESS status\
2025-11-14 08:29:31,650 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u56960  STARTING REAL AUTONOMOUS INVESTIGATION: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,650 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verified entity information: email=okuoku1959122@gmail.com...\
2025-11-14 08:29:31,650 [INFO] app.service.agent.recursion_guard: [] Created execution context for investigation auto-comp-a022e93e4e7f, thread auto-comp-a022e93e4e7f-None\
2025-11-14 08:29:31,650 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u57057 \u65039  Created RecursionGuard context for investigation auto-comp-a022e93e4e7f with thread_id auto-comp-a022e93e4e7f-None\
2025-11-14 08:29:31,650 [INFO] app.router.controllers.investigation_executor: [] \uc0\u9989  Verification complete - execution can proceed for auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,650 [INFO] app.router.controllers.investigation_executor: [] \uc0\u8505 \u65039   Investigation auto-comp-a022e93e4e7f already in IN_PROGRESS status\
2025-11-14 08:29:31,652 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-a022e93e4e7f: \{'status': 'in_progress', 'current_phase': 'agent_initialization'\}\
2025-11-14 08:29:31,652 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_initialization\
2025-11-14 08:29:31,652 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 0% | Phases: 0 completed\
2025-11-14 08:29:31,652 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_initialization\
2025-11-14 08:29:31,652 [WARNING] app.service.agent.journey_tracker: [] No active journey for investigation: auto-comp-a022e93e4e7f. Creating emergency journey for node tracking.\
2025-11-14 08:29:31,652 [INFO] app.service.agent.journey_tracker: [] Started journey tracking for investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,655 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-a022e93e4e7f: \{'current_phase': 'agent_initialization', 'progress_percentage': 5.0, 'status': 'in_progress'\}\
2025-11-14 08:29:31,655 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55357 \u56615  Creating REAL LangGraph agent system for auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,655 [INFO] app.service.agent.orchestration.graph_builder: [] Creating traditional agent graph: parallel=True, enhanced_tools=True, subgraphs=False\
2025-11-14 08:29:31,655 [INFO] app.service.agent.orchestration.graph_builder: [] Creating parallel graph with structured agents and RecursionGuard protection\
2025-11-14 08:29:31,678 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:29:31,678 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:29:31,678 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:29:31,678 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:29:31,678 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:29:31,678 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:29:31,678 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:29:31,678 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:29:31,678 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Created enhanced tool node with 18 healthy tools\
2025-11-14 08:29:31,679 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Added tools node with 18 tools to graph\
2025-11-14 08:29:31,680 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u55357 \u57057 \u65039  Redis disabled in configuration - using MemorySaver\
2025-11-14 08:29:31,683 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  Parallel structured agent graph compiled successfully\
2025-11-14 08:29:31,684 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  context_preparation\
2025-11-14 08:29:31,684 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 25% | Phases: 1 completed\
2025-11-14 08:29:31,684 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: context_preparation\
2025-11-14 08:29:31,687 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-a022e93e4e7f: \{'current_phase': 'context_preparation', 'progress_percentage': 15.0\}\
2025-11-14 08:29:31,687 [INFO] app.router.controllers.investigation_phases: [] \uc0\u55358 \u56800  Creating REAL agent context for auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,688 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56589  EXECUTING REAL AGENT INVESTIGATION: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,688 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  agent_execution\
2025-11-14 08:29:31,688 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 50% | Phases: 2 completed\
2025-11-14 08:29:31,688 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: agent_execution\
2025-11-14 08:29:31,690 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-a022e93e4e7f: \{'current_phase': 'agent_execution', 'progress_percentage': 25.0\}\
2025-11-14 08:29:31,691 [INFO] app.router.controllers.investigation_agent_tracking: [] \uc0\u55357 \u56523  ATTEMPTING TO LOG LLM INTERACTION FOR: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,691 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  LLM Call: MultiAgentOrchestrator \u8594  gpt-4o\
2025-11-14 08:29:31,691 [INFO] app.service.logging.autonomous_investigation_logger: []            Tools: langgraph_parallel_execution | Tokens: 124.80000000000001\
2025-11-14 08:29:31,691 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Initiating real structured investigation with Device, Location, Network, Logs, and Risk Analysis age...\
2025-11-14 08:29:31,691 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  Decision: DeviceAnalysisAgent \u8594  device_analysis_start\
2025-11-14 08:29:31,691 [INFO] app.service.logging.autonomous_investigation_logger: []            Confidence: 95.00 | Outcome: N/A\
2025-11-14 08:29:31,691 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Analyzing device fingerprint inconsistencies and spoofing indicators\
2025-11-14 08:29:31,691 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56598  INVOKING REAL AGENTS: Device, Location, Network, Logs, Risk Analysis\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u55356 \u57263  Migration Manager: Getting investigation graph\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: []    Investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u55357 \u56599  Service adapter: Getting investigation graph\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: []    Entity type: email\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: [] \uc0\u55356 \u57263  Selecting investigation graph with typed results\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Entity type: email\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    Fallback counter: 0\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_selector: []    \uc0\u55358 \u56800  Hybrid intelligence graph selected\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.migration.graph_selection.graph_builders: [] \uc0\u55357 \u56615  Hybrid graph streaming: enabled\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u55357 \u56580  LEGACY: build_hybrid_investigation_graph called\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u10145 \u65039  Delegating to modular graph builder\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55357 \u56522  Parameters: enhanced_tools=True, streaming=True, interrupts=False, investigation_id=auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Building hybrid intelligence graph\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Enhanced tools: True\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Streaming enabled: True\
2025-11-14 08:29:31,691 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u55356 \u57303 \u65039  Creating hybrid intelligence graph foundation\
2025-11-14 08:29:31,692 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:29:31,694 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], tool_names: None\
2025-11-14 08:29:31,694 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:29:31,694 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:29:31,694 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'threat_intelligence', 'database', 'search', 'blockchain', 'intelligence', 'ml_ai', 'web', 'file_system', 'api', 'mcp_clients', 'mcp_servers', 'utility'], specific: None)\
2025-11-14 08:29:31,694 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:29:31,694 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u55357 \u56550  Loaded 18 tools for hybrid investigation\
2025-11-14 08:29:31,695 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.tool_nodes: [] \uc0\u9989  [Hybrid] Using EnhancedToolNode with 18 tools and persistence enabled\
2025-11-14 08:29:31,695 [INFO] app.service.agent.orchestration.hybrid.graph.builders.node_factory: [] \uc0\u55356 \u57303 \u65039  Node factory completed: 16 nodes created\
2025-11-14 08:29:31,696 [INFO] app.service.agent.orchestration.hybrid.graph.builders.memory_provider: [] \uc0\u55357 \u57057 \u65039  Using in-memory storage for hybrid graph (Redis checkpoint unavailable)\
2025-11-14 08:29:31,715 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: [] \uc0\u9989  Hybrid intelligence graph compiled successfully\
2025-11-14 08:29:31,715 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Nodes: 19\
2025-11-14 08:29:31,715 [INFO] app.service.agent.orchestration.hybrid.graph.builders.graph_foundation: []    Intelligence mode: adaptive\
2025-11-14 08:29:31,715 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: [] \uc0\u9989  LEGACY: Graph building delegated successfully\
2025-11-14 08:29:31,715 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57263  100% backward compatibility maintained\
2025-11-14 08:29:31,715 [INFO] app.service.agent.orchestration.hybrid.hybrid_graph_builder: []    \uc0\u55356 \u57303 \u65039  Using modular architecture with 14 components\
2025-11-14 08:29:31,715 [INFO] app.service.agent.orchestration.hybrid.integration.service_adapter: [] \uc0\u9989  Investigation graph ready: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,715 [INFO] app.service.agent.orchestration.hybrid.migration.migration_manager: [] \uc0\u9989  Investigation graph ready: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,715 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55358 \u56800  Using Hybrid Intelligence graph for investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,715 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56960  EXECUTING CLEAN GRAPH ORCHESTRATION (replacing old agent service)\
[2025-11-14T08:29:31-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:29:31-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.907274 seconds\
2025-11-14 08:29:31,718 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56615  Enhanced Tool Execution Logger initialized for investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,718 [INFO] app.service.agent.orchestration.investigation_coordinator: [] \uc0\u55357 \u56613  START_INVESTIGATION FUNCTION CALLED \u55357 \u56613 \
2025-11-14 08:29:31,718 [INFO] app.service.agent.orchestration.investigation_coordinator: [] [start_investigation] initiating fraud investigation flow\
2025-11-14 08:29:31,718 [INFO] app.service.agent.orchestration.investigation_coordinator: [] [start_investigation] Using hybrid state structure - extracting from state\
2025-11-14 08:29:31,718 [INFO] app.service.agent.orchestration.investigation_coordinator: [] \uc0\u55357 \u56589  Hybrid state parameters: entity_id=okuoku1959122@gmail.com, entity_type=email, investigation_id=auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,718 [INFO] app.service.agent.orchestration.investigation_coordinator: [] Set investigation context for auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,718 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u9989  Hybrid investigation started: auto-comp-a022e93e4e7f\
2025-11-14 08:29:31,720 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Starting data retrieval\
2025-11-14 08:29:31,720 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Entity=okuoku1959122@gmail.com (type: email)\
2025-11-14 08:29:31,720 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: SnowflakeProvider provider initialized\
2025-11-14 08:29:31,720 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Executing query for email=okuoku1959122@gmail.com (column: EMAIL)\
2025-11-14 08:29:31,720 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT\
                        TX_ID_KEY,\
                        EMAIL,\
                        IP,\
                        PAID_AMOUNT_VALUE_IN_CURRENCY,\
                        PAID_AMOUNT_CURRENCY...\
2025-11-14 08:31:23,704 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 59 rows\
2025-11-14 08:31:23,705 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 59 rows returned\
2025-11-14 08:31:23,705 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u9989  DATABASE FETCH: Retrieved 59 transactions (query limit: 2000, matched: 59 for email=okuoku1959122@gmail.com)\
2025-11-14 08:31:23,705 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.investigation_nodes: [] \uc0\u55357 \u56522  DATABASE FETCH: Tracked as tool usage (total tools: 1)\
2025-11-14 08:31:23,736 [CRITICAL] app.service.agent.orchestration.enhanced_routing: [] \uc0\u55357 \u56613  DEBUGGING: raw_data_or_investigation_routing CALLED\
2025-11-14 08:31:23,736 [CRITICAL] app.service.agent.orchestration.enhanced_routing: [] \uc0\u55357 \u56613  DEBUGGING: Investigation ID: auto-comp-a022e93e4e7f\
2025-11-14 08:31:23,736 [INFO] app.service.agent.orchestration.enhanced_routing: [] Determining investigation routing: raw data vs standard flow\
2025-11-14 08:31:23,736 [INFO] app.service.agent.orchestration.enhanced_routing: [] Database transaction data detected (59 rows from snowflake) - routing to standard fraud investigation (CSV data not found in messages)\
2025-11-14 08:31:23,737 [INFO] uvicorn.access: [] 127.0.0.1:64103 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:31:23,750 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: [] \uc0\u55358 \u56800  Hybrid-aware assistant preparing LLM context with AI recommendations\
2025-11-14 08:31:23,751 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: []    \uc0\u55358 \u56598  Running LLM with AI guidance context\
2025-11-14 08:31:23,809 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:31:23,809 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:31:23,809 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:31:23,809 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:31:23,810 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:31:23,810 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:31:23,810 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:31:23,810 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:31:23,811 [INFO] app.service.llm_manager: [] \uc0\u55357 \u56580  bind_tools called on GPT-5 Responses API wrapper - falling back to Chat Completions API for tool support\
2025-11-14 08:31:23,811 [INFO] app.service.llm_manager: []    Tools to bind: 18\
2025-11-14 08:31:23,854 [INFO] app.service.agent.orchestration.assistant: [] \uc0\u9989  Created investigation-context-aware system message for email=okuoku1959122@gmail.com\
2025-11-14 08:31:23,854 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u57057 \u65039  LLM Resilience Configuration:\
2025-11-14 08:31:23,854 [INFO] app.service.agent.orchestration.llm_resilience: []    Timeout: 60s\
2025-11-14 08:31:23,854 [INFO] app.service.agent.orchestration.llm_resilience: []    Max Retries: 3\
2025-11-14 08:31:23,854 [INFO] app.service.agent.orchestration.llm_resilience: []    Initial Retry Delay: 1.0s\
2025-11-14 08:31:23,854 [INFO] app.service.agent.orchestration.llm_resilience: []    Backoff Multiplier: 2.0x\
2025-11-14 08:31:23,854 [INFO] app.service.agent.orchestration.llm_resilience: []    Max Retry Delay: 30.0s\
2025-11-14 08:31:23,854 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 1/4\
2025-11-14 08:31:23,861 [INFO] app.service.etag_service: [olorin_tid=18d50d2d-8549-4014-8b2e-de0918ce09a5, investigation_id=f126395a-b4a6-45dc-a32f-45d11cd27b42] etag_retrieved\
2025-11-14 08:31:23,862 [INFO] uvicorn.access: [] 127.0.0.1:64103 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
[2025-11-14T08:31:23-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:23,943 [ERROR] app.service.rag.embedding_service: [] OpenAI embedding generation failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:23,944 [WARNING] app.service.rag.vector_rag_service: [] Failed to generate embedding for chunk 17: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
[2025-11-14T08:31:24-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:24-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.428742 seconds\
[2025-11-14T08:31:24-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:24-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.880111 seconds\
[2025-11-14T08:31:24-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:24-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.466087 seconds\
[2025-11-14T08:31:25-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:25,449 [ERROR] app.service.rag.embedding_service: [] OpenAI embedding generation failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:25,449 [WARNING] app.service.rag.vector_rag_service: [] Failed to generate embedding for chunk 18: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
[2025-11-14T08:31:25-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:25-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.460427 seconds\
[2025-11-14T08:31:25-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:25-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.887831 seconds\
[2025-11-14T08:31:26-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:26-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.979816 seconds\
[2025-11-14T08:31:27-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:27,181 [ERROR] app.service.rag.embedding_service: [] OpenAI embedding generation failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:27,181 [WARNING] app.service.rag.vector_rag_service: [] Failed to generate embedding for chunk 19: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:27,181 [INFO] app.service.rag.vector_rag_service: [] Created 20 chunks for document 24083d28-098f-4a95-b53c-ed6e82b4b35d\
2025-11-14 08:31:27,204 [INFO] app.service.rag.investigation_indexer: [] Indexed investigation auto-comp-fa5c5cc6cfea with 3 chunks\
2025-11-14 08:31:27,275 [INFO] app.service.rag.investigation_indexer: [] Indexed 1 new/updated investigations out of 157 checked\
2025-11-14 08:31:27,275 [INFO] app.service.rag.investigation_indexing_background: [] Indexed 1 new/updated investigations\
[2025-11-14T08:31:27-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:27,338 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u10060   LLM Invocation Error: Type=RateLimitError, Retryable=True, Attempt=1, Duration=3.48s\
2025-11-14 08:31:27,338 [ERROR] app.service.agent.orchestration.llm_resilience: []    Error details: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:27,338 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   Error is retryable, will retry...\
2025-11-14 08:31:27,338 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   LLM Retry 1/3: Waiting 1.0s before retry\
2025-11-14 08:31:28,340 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 2/4\
[2025-11-14T08:31:28-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:28-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.402190 seconds\
2025-11-14 08:31:28,729 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
[2025-11-14T08:31:29-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:29-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.762556 seconds\
[2025-11-14T08:31:30-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:30,537 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u10060   LLM Invocation Error: Type=RateLimitError, Retryable=True, Attempt=2, Duration=2.20s\
2025-11-14 08:31:30,537 [ERROR] app.service.agent.orchestration.llm_resilience: []    Error details: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:30,537 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   Error is retryable, will retry...\
2025-11-14 08:31:30,537 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   LLM Retry 2/3: Waiting 2.0s before retry\
2025-11-14 08:31:32,539 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 3/4\
[2025-11-14T08:31:32-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:32-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.460019 seconds\
[2025-11-14T08:31:33-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:33-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.795838 seconds\
2025-11-14 08:31:33,733 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
[2025-11-14T08:31:34-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:34,493 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u10060   LLM Invocation Error: Type=RateLimitError, Retryable=True, Attempt=3, Duration=1.95s\
2025-11-14 08:31:34,493 [ERROR] app.service.agent.orchestration.llm_resilience: []    Error details: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:34,493 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   Error is retryable, will retry...\
2025-11-14 08:31:34,493 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   LLM Retry 3/3: Waiting 4.0s before retry\
2025-11-14 08:31:34,748 [INFO] uvicorn.access: [] 127.0.0.1:64649 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:31:34,771 [INFO] app.service.etag_service: [olorin_tid=14b04faa-7d35-4a21-9246-3a36d21a8eb0, investigation_id=725819ae-1678-49af-b6e5-13477e8ffad4] etag_retrieved\
2025-11-14 08:31:34,774 [INFO] uvicorn.access: [] 127.0.0.1:64649 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:31:38,495 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 4/4\
2025-11-14 08:31:38,739 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
[2025-11-14T08:31:39-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:39-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.475620 seconds\
[2025-11-14T08:31:40-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:40-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.858305 seconds\
[2025-11-14T08:31:41-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:41,319 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u10060   LLM Invocation Error: Type=RateLimitError, Retryable=True, Attempt=4, Duration=2.82s\
2025-11-14 08:31:41,319 [ERROR] app.service.agent.orchestration.llm_resilience: []    Error details: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:41,319 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u57003   LLM invocation failed after 4 attempts (total duration 17.47s). Last error: RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:41,320 [ERROR] app.service.agent.orchestration.assistant: [] \uc0\u10060  LLM invocation failed permanently: LLM invocation failed after 4 attempts (total duration 17.47s). Last error: RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:41,320 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: [] \uc0\u9989  Hybrid-aware assistant completed with LLM guidance\
2025-11-14 08:31:41,320 [WARNING] app.service.agent.orchestration.hybrid.graph.builders.edge_configurator: [] \uc0\u9888 \u65039  No tool calls detected (1 consecutive attempts). Retrying fraud_investigation with stronger prompts.\
2025-11-14 08:31:41,322 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: [] \uc0\u55358 \u56800  Hybrid-aware assistant preparing LLM context with AI recommendations\
2025-11-14 08:31:41,322 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: []    \uc0\u55358 \u56598  Running LLM with AI guidance context\
2025-11-14 08:31:41,344 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56589  get_tools_for_agent called with categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], tool_names: None\
2025-11-14 08:31:41,344 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56522  Registry state: initialized=True, tools_count=18\
2025-11-14 08:31:41,344 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u55357 \u56615  Available tool names: ['splunk_query_tool', 'sumologic_query_tool', 'snowflake_query_tool', 'fetch_series', 'detect_anomalies', 'list_anomalies', 'open_investigation', 'attach_evidence', 'segment_hunter', 'entity_extractor']...\
2025-11-14 08:31:41,345 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Retrieved 18 tools for agent (categories: ['olorin', 'search', 'database', 'threat_intelligence', 'mcp_clients', 'mcp_servers', 'blockchain', 'intelligence', 'ml_ai', 'web'], specific: None)\
2025-11-14 08:31:41,345 [INFO] app.service.agent.tools.tool_registry: [] \uc0\u9989  Tool validation passed: sample tool 'splunk_query_tool' is properly initialized\
2025-11-14 08:31:41,345 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  DATABASE_PROVIDER=snowflake - Skipping DatabaseQueryTool, will use SnowflakeQueryTool instead\
2025-11-14 08:31:41,345 [INFO] app.service.agent.orchestration.graph_builder: [] \uc0\u9989  SnowflakeQueryTool is available (DATABASE_PROVIDER=snowflake, total 18 tools)\
2025-11-14 08:31:41,345 [INFO] app.service.agent.orchestration.graph_builder: [] Graph builder loaded 18 tools including 7 threat intelligence tools and 0 MCP client tools\
2025-11-14 08:31:41,345 [INFO] app.service.llm_manager: [] \uc0\u55357 \u56580  bind_tools called on GPT-5 Responses API wrapper - falling back to Chat Completions API for tool support\
2025-11-14 08:31:41,345 [INFO] app.service.llm_manager: []    Tools to bind: 18\
2025-11-14 08:31:41,374 [INFO] app.service.agent.orchestration.assistant: [] \uc0\u9989  Created investigation-context-aware system message for email=okuoku1959122@gmail.com\
2025-11-14 08:31:41,374 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u57057 \u65039  LLM Resilience Configuration:\
2025-11-14 08:31:41,374 [INFO] app.service.agent.orchestration.llm_resilience: []    Timeout: 60s\
2025-11-14 08:31:41,375 [INFO] app.service.agent.orchestration.llm_resilience: []    Max Retries: 3\
2025-11-14 08:31:41,375 [INFO] app.service.agent.orchestration.llm_resilience: []    Initial Retry Delay: 1.0s\
2025-11-14 08:31:41,375 [INFO] app.service.agent.orchestration.llm_resilience: []    Backoff Multiplier: 2.0x\
2025-11-14 08:31:41,375 [INFO] app.service.agent.orchestration.llm_resilience: []    Max Retry Delay: 30.0s\
2025-11-14 08:31:41,375 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 1/4\
[2025-11-14T08:31:41-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:41-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.411259 seconds\
[2025-11-14T08:31:41-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:41-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.910502 seconds\
[2025-11-14T08:31:42-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:42,960 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u10060   LLM Invocation Error: Type=RateLimitError, Retryable=True, Attempt=1, Duration=1.59s\
2025-11-14 08:31:42,960 [ERROR] app.service.agent.orchestration.llm_resilience: []    Error details: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:42,960 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   Error is retryable, will retry...\
2025-11-14 08:31:42,960 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   LLM Retry 1/3: Waiting 1.0s before retry\
2025-11-14 08:31:43,744 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:31:43,962 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 2/4\
[2025-11-14T08:31:44-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:44-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.476532 seconds\
[2025-11-14T08:31:45-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:45-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.891835 seconds\
[2025-11-14T08:31:46-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:46,382 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u10060   LLM Invocation Error: Type=RateLimitError, Retryable=True, Attempt=2, Duration=2.42s\
2025-11-14 08:31:46,382 [ERROR] app.service.agent.orchestration.llm_resilience: []    Error details: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:46,382 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   Error is retryable, will retry...\
2025-11-14 08:31:46,382 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   LLM Retry 2/3: Waiting 2.0s before retry\
2025-11-14 08:31:48,385 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 3/4\
[2025-11-14T08:31:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:48-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.397307 seconds\
2025-11-14 08:31:48,748 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
[2025-11-14T08:31:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:48-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.990437 seconds\
[2025-11-14T08:31:50-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:50,013 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u10060   LLM Invocation Error: Type=RateLimitError, Retryable=True, Attempt=3, Duration=1.63s\
2025-11-14 08:31:50,013 [ERROR] app.service.agent.orchestration.llm_resilience: []    Error details: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:50,013 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   Error is retryable, will retry...\
2025-11-14 08:31:50,013 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u56580   LLM Retry 3/3: Waiting 4.0s before retry\
2025-11-14 08:31:53,753 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:31:54,015 [INFO] app.service.agent.orchestration.llm_resilience: [] \uc0\u55358 \u56598   LLM Invocation Attempt 4/4\
[2025-11-14T08:31:54-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:54-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.425533 seconds\
[2025-11-14T08:31:54-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:54-0500] INFO [] module=_base_client: Retrying request to /chat/completions in 0.818979 seconds\
[2025-11-14T08:31:55-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:55,620 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u10060   LLM Invocation Error: Type=RateLimitError, Retryable=True, Attempt=4, Duration=1.61s\
2025-11-14 08:31:55,620 [ERROR] app.service.agent.orchestration.llm_resilience: []    Error details: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:55,620 [ERROR] app.service.agent.orchestration.llm_resilience: [] \uc0\u55357 \u57003   LLM invocation failed after 4 attempts (total duration 14.25s). Last error: RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:55,620 [ERROR] app.service.agent.orchestration.assistant: [] \uc0\u10060  LLM invocation failed permanently: LLM invocation failed after 4 attempts (total duration 14.25s). Last error: RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:55,620 [INFO] app.service.agent.orchestration.hybrid.graph.assistant.hybrid_assistant: [] \uc0\u9989  Hybrid-aware assistant completed with LLM guidance\
2025-11-14 08:31:55,621 [WARNING] app.service.agent.orchestration.hybrid.graph.builders.edge_configurator: [] \uc0\u9888 \u65039  Max retries (2) reached for tool calls (2 consecutive AI messages without tools). Proceeding without tools.\
2025-11-14 08:31:55,623 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.intelligence_nodes: [] \uc0\u55358 \u56800  Hybrid Intelligence AI confidence assessment starting\
2025-11-14 08:31:55,624 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.114 (low)\
2025-11-14 08:31:55,624 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:31:55,624 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:31:55,624 [ERROR] app.service.agent.orchestration.hybrid.graph.nodes.intelligence_nodes: [] \uc0\u10060  AI confidence assessment failed: 'dict' object has no attribute 'ai_confidence'\
2025-11-14 08:31:55,626 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:31:55,626 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:31:55,626 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:31:55,626 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:31:55,626 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:31:55,626 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:31:55,626 [ERROR] app.service.agent.orchestration.hybrid.graph.nodes.intelligence_nodes: [] \uc0\u10060  Safety validation failed: name 'fmt_num' is not defined\
2025-11-14 08:31:55,628 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.114 (low)\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: network_agent (domain: network)\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  ROUTING TO DOMAIN AGENT: network_agent\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: network_agent\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.114 (AIConfidenceLevel.LOW)\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:31:55,629 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: network_agent\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.114 (low)\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: network_agent (domain: network)\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  ROUTING TO DOMAIN AGENT: network_agent\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: network_agent\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.114 (AIConfidenceLevel.LOW)\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:31:55,631 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: network_agent\
2025-11-14 08:31:55,632 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence network agent starting\
2025-11-14 08:31:55,633 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] [Step 5.2.1] \uc0\u55356 \u57104  Network agent analyzing investigation\
2025-11-14 08:31:55,633 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for network_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:31:55,633 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Network agent processing Snowflake data:\
2025-11-14 08:31:55,633 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data type: dict\
2025-11-14 08:31:55,633 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data keys: ['success', 'row_count', 'results', 'source']\
2025-11-14 08:31:55,633 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data['results'] count: 59\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    snowflake_data['row_count']: 59\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Processed results count: 59\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Sample record structure (first record):\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Record keys: ['TX_ID_KEY', 'EMAIL', 'IP', 'PAID_AMOUNT_VALUE_IN_CURRENCY', 'PAID_AMOUNT_CURRENCY', 'TX_DATETIME', 'PAYMENT_METHOD', 'CARD_BRAND', 'DEVICE_ID', 'USER_AGENT', 'IP_COUNTRY_CODE', 'IS_FRAUD_TX', 'MODEL_SCORE', 'MODEL_DECISION']\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Sample values: \{'TX_ID_KEY': '23521172', 'EMAIL': 'okuoku1959122@gmail.com', 'IP': '2405:1202:50be:dc00:fcfa:56e7:9039:d685', 'PAID_AMOUNT_VALUE_IN_CURRENCY': 400000.0, 'PAID_AMOUNT_CURRENCY': 'JPY'\}\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Evidence collected from Snowflake data: 4 items\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Evidence 1: Geographic analysis: 2 unique country/countries found: ['JP', 'IN']...\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Evidence 2: Multi-country activity: ['JP', 'IN']...\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Evidence 3: IP analysis: 13 unique IP address(es) found in transaction data...\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: []    Evidence 4: Suspicious IP diversity pattern: 13 unique addresses...\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.network_agent: [] \uc0\u55357 \u56522  Total evidence before LLM analysis: 4 items\
2025-11-14 08:31:55,634 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:31:55,634 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:31:55,634 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:31:55,634 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:31:55,634 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:31:55,634 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:31:55,634 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 59\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.540\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $39,050,000.00 across 59 transactions\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 59):\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23521172...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:58:31\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $400,000.00\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.445\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520885...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:44:36\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $850,000.00\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.470\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520457...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:32:14\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $900,000.00\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502488...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 15:01:44\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $500,000.00\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.465\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502209...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 14:43:58\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $800,000.00\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.466\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:31:55,635 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 59 raw records \u8594  formatted summary\
2025-11-14 08:31:55,636 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:31:55,636 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a network security expert specializing in IP reputation analysis, \
            geographic patterns, VPN detection, and network behavior analysis. You understand \
            network-based fraud indicators and can assess IP-related risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple tr...\
2025-11-14 08:31:55,636 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3475 chars)\
2025-11-14 08:31:55,636 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this network domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: okuoku1959122@gmail.com\
- Domain: network\
\
## Evidence Collected\
- Geographic analysis: 2 unique country/countries found: ['JP', 'IN']\
- Multi-country activity: ['JP', 'IN']\
- IP analysis: 13 unique IP address(es) found in transaction data\
- Suspicious IP diversity pattern: 13 unique addresses\
\
## Metrics and Data Points\
- Unique Countries: 2\
- Unique Ip Count: 13\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 59\
- Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
- Average Model Score: 0.540\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $39,050,000.00 across 59 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 59):\
  Transaction 1:\
    - ID: 23521172...\
    - DateTime: 2025-11-13 14:58:31\
    - Amount: $400,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.445\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 23520885...\
    - DateTime: 2025-11-13 14:44:36\
    - Amount: $850,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.470\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 23520457...\
    - DateTime: 2025-11-13 14:32:14\
    - Amount: $900,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: 23502488...\
    - DateTime: 2025-11-12 15:01:44\
    - Amount: $500,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.465\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 23502209...\
    - DateTime: 2025-11-12 14:43:58\
    - Amount: $800,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.466\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTERNS DETECTED (PRIMARY INDICATORS):\
- VELOCITY BURST: 3 transactions in 5 minutes\
- AMOUNT CLUSTERING: $850,000.00 appears 4 times\
- DEVICE-IP MISMATCH: Devic...\
2025-11-14 08:31:55,636 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5160 chars)\
[2025-11-14T08:31:56-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:56-0500] INFO [] module=_base_client: Retrying request to /responses in 0.451558 seconds\
[2025-11-14T08:31:57-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:57-0500] INFO [] module=_base_client: Retrying request to /responses in 0.765918 seconds\
[2025-11-14T08:31:58-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:31:58,591 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\uc0\u10060  EVIDENCE ANALYZER EXCEPTION CAUGHT\
   Domain: network\
   Exception: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
   Exception type: RateLimitError\
   Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
   Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\
2025-11-14 08:31:58,599 [ERROR] app.service.agent.evidence_analyzer: [] \uc0\u10060  network evidence analysis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:31:58,599 [ERROR] app.service.agent.evidence_analyzer: []    Exception type: RateLimitError\
2025-11-14 08:31:58,599 [ERROR] app.service.agent.evidence_analyzer: []    Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
2025-11-14 08:31:58,599 [ERROR] app.service.agent.evidence_analyzer: []    Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
2025-11-14 08:31:58,599 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.1] \uc0\u9989  Network analysis complete - Risk: 0.50\
2025-11-14 08:31:58,602 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for network_agent: 2966ms, 2 steps\
2025-11-14 08:31:58,605 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted network domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.5, has_llm_analysis: True)\
2025-11-14 08:31:58,605 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced network agent completed\
2025-11-14 08:31:58,605 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 1/6\
2025-11-14 08:31:58,607 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:31:58,607 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.237 (low)\
2025-11-14 08:31:58,607 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:31:58,607 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: device_agent (domain: device)\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: device_agent\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.237 (AIConfidenceLevel.LOW)\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:31:58,608 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: device_agent\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.237 (low)\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: device_agent (domain: device)\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: device_agent\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.237 (AIConfidenceLevel.LOW)\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:31:58,609 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: device_agent\
2025-11-14 08:31:58,610 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence device agent starting\
2025-11-14 08:31:58,611 [INFO] app.service.agent.orchestration.domain_agents.device_agent: [] [Step 5.2.2] \uc0\u55357 \u56561  Device agent analyzing investigation\
2025-11-14 08:31:58,611 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for device_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:31:58,611 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:31:58,611 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:31:58,611 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:31:58,611 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:31:58,611 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 59\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.540\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $39,050,000.00 across 59 transactions\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 59):\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23521172...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:58:31\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $400,000.00\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.445\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520885...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:44:36\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $850,000.00\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.470\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520457...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:32:14\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $900,000.00\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502488...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 15:01:44\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $500,000.00\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.465\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502209...\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 14:43:58\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $800,000.00\
2025-11-14 08:31:58,612 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.466\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 59 raw records \u8594  formatted summary\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a device fingerprinting expert specializing in device consistency \
            analysis, browser spoofing detection, and device behavior patterns. You understand \
            device-based fraud indicators and can assess device-related risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multipl...\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3478 chars)\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this device domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: okuoku1959122@gmail.com\
- Domain: device\
\
## Evidence Collected\
- Unique devices: 2 across 59 transactions\
- User agent variations: 3\
- Device diversity: 1 browsers, 2 operating systems\
- Analysis based on: USER_AGENT\
\
## Metrics and Data Points\
- Snowflake Records: 59\
- Unique Device Count: 2\
- Total Transactions: 59\
- Unique User Agents: 3\
- Unique Browsers: 1\
- Unique Os: 2\
- Unique Device Models: None\
- Unique Os Versions: None\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 59\
- Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
- Average Model Score: 0.540\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $39,050,000.00 across 59 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 59):\
  Transaction 1:\
    - ID: 23521172...\
    - DateTime: 2025-11-13 14:58:31\
    - Amount: $400,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.445\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 23520885...\
    - DateTime: 2025-11-13 14:44:36\
    - Amount: $850,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.470\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 23520457...\
    - DateTime: 2025-11-13 14:32:14\
    - Amount: $900,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: 23502488...\
    - DateTime: 2025-11-12 15:01:44\
    - Amount: $500,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.465\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 23502209...\
    - DateTime: 2025-11-12 14:43:58\
    - Amount: $800,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.466\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTERNS DETECTED (PRIMARY INDICATORS):\
- VELOCITY BURST: 3 transactions in 5 minutes\
- AMOUNT...\
2025-11-14 08:31:58,613 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5228 chars)\
[2025-11-14T08:31:59-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:31:59-0500] INFO [] module=_base_client: Retrying request to /responses in 0.479799 seconds\
[2025-11-14T08:32:00-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:00-0500] INFO [] module=_base_client: Retrying request to /responses in 0.943332 seconds\
[2025-11-14T08:32:01-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:01,702 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\uc0\u10060  EVIDENCE ANALYZER EXCEPTION CAUGHT\
   Domain: device\
   Exception: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
   Exception type: RateLimitError\
   Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
   Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\
2025-11-14 08:32:01,702 [ERROR] app.service.agent.evidence_analyzer: [] \uc0\u10060  device evidence analysis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:01,702 [ERROR] app.service.agent.evidence_analyzer: []    Exception type: RateLimitError\
2025-11-14 08:32:01,702 [ERROR] app.service.agent.evidence_analyzer: []    Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
2025-11-14 08:32:01,703 [ERROR] app.service.agent.evidence_analyzer: []    Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
2025-11-14 08:32:01,703 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.2] \uc0\u9989  Device analysis complete - Risk: 0.40\
2025-11-14 08:32:01,704 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for device_agent: 3092ms, 2 steps\
2025-11-14 08:32:01,704 [INFO] app.service.agent.orchestration.domain_agents.device_agent: [] [Step 5.2.2] \uc0\u9989  Device analysis complete - Evidence collected: 5 points\
2025-11-14 08:32:01,707 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted device domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.4, has_llm_analysis: True)\
2025-11-14 08:32:01,707 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced device agent completed\
2025-11-14 08:32:01,707 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 2/6\
2025-11-14 08:32:01,708 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:32:01,710 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:01,710 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.260 (low)\
2025-11-14 08:32:01,710 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:01,710 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.00\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: location_agent (domain: location)\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: location_agent\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.260 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:01,711 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: location_agent\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.260 (low)\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.04\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: location_agent (domain: location)\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: location_agent\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.260 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:01,712 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:01,713 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:01,713 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: location_agent\
2025-11-14 08:32:01,714 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence location agent starting\
2025-11-14 08:32:01,714 [INFO] app.service.agent.orchestration.domain_agents.location_agent: [] [Step 5.2.3] \uc0\u55357 \u56525  Location agent analyzing investigation\
2025-11-14 08:32:01,714 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for location_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:01,716 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:32:01,716 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:32:01,716 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 59\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.540\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $39,050,000.00 across 59 transactions\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 59):\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23521172...\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:58:31\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $400,000.00\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.445\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520885...\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:44:36\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $850,000.00\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.470\
2025-11-14 08:32:01,716 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520457...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:32:14\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $900,000.00\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502488...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 15:01:44\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $500,000.00\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.465\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502209...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 14:43:58\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $800,000.00\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.466\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 59 raw records \u8594  formatted summary\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a geographic analysis expert specializing in location patterns, \
            impossible travel detection, and geographic risk assessment. You understand \
            location-based fraud indicators and can assess geographic risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transacti...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3469 chars)\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this location domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: okuoku1959122@gmail.com\
- Domain: location\
\
## Evidence Collected\
- CRITICAL: Impossible travel JP\uc0\u8594 IN in 16.9 minutes requiring 13121 mph (max possible ~600 mph)\
- Geographic movement: IN\uc0\u8594 JP in 166.2h (22 mph - feasible)\
- FRAUD INDICATOR: 1 impossible travel pattern(s) detected\
- Geographic spread: 0 cities across 2 countries\
\
## Metrics and Data Points\
- Snowflake Records: 59\
- Unique Countries: 2\
- Location Changes: 2\
- Impossible Travel Count: 1\
- Max Speed Required Mph: 13120.638599137865\
- High Risk Countries Count: 0\
- Unique Cities: 0\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 59\
- Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
- Average Model Score: 0.540\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $39,050,000.00 across 59 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 59):\
  Transaction 1:\
    - ID: 23521172...\
    - DateTime: 2025-11-13 14:58:31\
    - Amount: $400,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.445\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 23520885...\
    - DateTime: 2025-11-13 14:44:36\
    - Amount: $850,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.470\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 23520457...\
    - DateTime: 2025-11-13 14:32:14\
    - Amount: $900,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: 23502488...\
    - DateTime: 2025-11-12 15:01:44\
    - Amount: $500,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.465\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 23502209...\
    - DateTime: 2025-11-12 14:43:58\
    - Amount: $800,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.466\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific...\
2025-11-14 08:32:01,717 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5343 chars)\
[2025-11-14T08:32:01-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:01-0500] INFO [] module=_base_client: Retrying request to /responses in 0.474835 seconds\
[2025-11-14T08:32:02-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:02-0500] INFO [] module=_base_client: Retrying request to /responses in 0.934150 seconds\
[2025-11-14T08:32:04-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:04,082 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\uc0\u10060  EVIDENCE ANALYZER EXCEPTION CAUGHT\
   Domain: location\
   Exception: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
   Exception type: RateLimitError\
   Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
   Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\
2025-11-14 08:32:04,082 [ERROR] app.service.agent.evidence_analyzer: [] \uc0\u10060  location evidence analysis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:04,082 [ERROR] app.service.agent.evidence_analyzer: []    Exception type: RateLimitError\
2025-11-14 08:32:04,082 [ERROR] app.service.agent.evidence_analyzer: []    Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
2025-11-14 08:32:04,083 [ERROR] app.service.agent.evidence_analyzer: []    Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
2025-11-14 08:32:04,083 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.3] \uc0\u9989  Location analysis complete - Risk: 0.50\
2025-11-14 08:32:04,084 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for location_agent: 2369ms, 2 steps\
2025-11-14 08:32:04,084 [INFO] app.service.agent.orchestration.domain_agents.location_agent: [] [Step 5.2.3] \uc0\u9989  Location analysis complete - Risk: 0.50\
2025-11-14 08:32:04,087 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted location domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.5, has_llm_analysis: True)\
2025-11-14 08:32:04,087 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced location agent completed\
2025-11-14 08:32:04,087 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 3/6\
2025-11-14 08:32:04,088 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:04,089 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.286 (low)\
2025-11-14 08:32:04,089 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:04,089 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:04,089 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.05\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: logs_agent (domain: logs)\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: logs_agent\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.286 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:04,090 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: logs_agent\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.286 (low)\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.05\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: logs_agent (domain: logs)\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: logs_agent\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.286 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:04,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: logs_agent\
2025-11-14 08:32:04,092 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence logs agent starting\
2025-11-14 08:32:04,093 [INFO] app.service.agent.orchestration.domain_agents.logs_agent: [] [Step 5.2.4] \uc0\u55357 \u56541  Logs agent analyzing investigation\
2025-11-14 08:32:04,094 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for logs_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:04,094 [INFO] app.service.agent.orchestration.domain.field_whitelist: [] \uc0\u55357 \u57057 \u65039  WHITELIST FILTER (logs): Blocked 14 non-domain fields: ['TX_ID_KEY', 'EMAIL', 'IP', 'PAID_AMOUNT_VALUE_IN_CURRENCY', 'PAID_AMOUNT_CURRENCY']\
2025-11-14 08:32:04,094 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:32:04,094 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:32:04,094 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 59\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.540\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $39,050,000.00 across 59 transactions\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 59):\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23521172...\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:58:31\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $400,000.00\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.445\
2025-11-14 08:32:04,094 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520885...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:44:36\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $850,000.00\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.470\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520457...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:32:14\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $900,000.00\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502488...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 15:01:44\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $500,000.00\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.465\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502209...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 14:43:58\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $800,000.00\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.466\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 59 raw records \u8594  formatted summary\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a log analysis expert specializing in behavioral pattern analysis, \
            system logs interpretation, and activity pattern detection. You understand \
            behavioral fraud indicators and can assess activity-based risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transac...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3467 chars)\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this logs domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: okuoku1959122@gmail.com\
- Domain: logs\
\
## Evidence Collected\
- Transaction failures: 0 out of 59 transactions\
- Transaction frequency: 59 transactions analyzed\
- SUSPICIOUS: 59 transactions may indicate automated behavior\
\
## Metrics and Data Points\
- Failed Transaction Count: 0\
- Total Transaction Count: 59\
- Failure Rate: 0.0\
- Transaction Count: 59\
- Error Count: 0\
- Unique Error Codes: 0\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 59\
- Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
- Average Model Score: 0.540\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $39,050,000.00 across 59 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 59):\
  Transaction 1:\
    - ID: 23521172...\
    - DateTime: 2025-11-13 14:58:31\
    - Amount: $400,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.445\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 23520885...\
    - DateTime: 2025-11-13 14:44:36\
    - Amount: $850,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.470\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 23520457...\
    - DateTime: 2025-11-13 14:32:14\
    - Amount: $900,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: 23502488...\
    - DateTime: 2025-11-12 15:01:44\
    - Amount: $500,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.465\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 23502209...\
    - DateTime: 2025-11-12 14:43:58\
    - Amount: $800,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.466\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTERNS DETECTED (PRIMARY INDICATORS):\
- VELOCITY BURST: 3 transactions in 5 minutes\
- AMOUNT CLUSTERING: $850,000.00 appears 4 times\
-...\
2025-11-14 08:32:04,095 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5186 chars)\
[2025-11-14T08:32:04-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:04-0500] INFO [] module=_base_client: Retrying request to /responses in 0.428587 seconds\
[2025-11-14T08:32:05-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:05-0500] INFO [] module=_base_client: Retrying request to /responses in 0.793770 seconds\
[2025-11-14T08:32:06-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:06,516 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\uc0\u10060  EVIDENCE ANALYZER EXCEPTION CAUGHT\
   Domain: logs\
   Exception: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
   Exception type: RateLimitError\
   Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
   Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\
2025-11-14 08:32:06,516 [ERROR] app.service.agent.evidence_analyzer: [] \uc0\u10060  logs evidence analysis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:06,516 [ERROR] app.service.agent.evidence_analyzer: []    Exception type: RateLimitError\
2025-11-14 08:32:06,516 [ERROR] app.service.agent.evidence_analyzer: []    Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
2025-11-14 08:32:06,517 [ERROR] app.service.agent.evidence_analyzer: []    Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
2025-11-14 08:32:06,517 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.4] \uc0\u9989  Logs analysis complete - Risk: 0.40\
2025-11-14 08:32:06,518 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for logs_agent: 2423ms, 2 steps\
2025-11-14 08:32:06,518 [INFO] app.service.agent.orchestration.domain_agents.logs_agent: [] [Step 5.2.4] \uc0\u9989  Logs analysis complete - Risk: 0.40\
2025-11-14 08:32:06,521 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted logs domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.4, has_llm_analysis: True)\
2025-11-14 08:32:06,522 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced logs agent completed\
2025-11-14 08:32:06,522 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 4/6\
2025-11-14 08:32:06,523 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:06,523 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.299 (low)\
2025-11-14 08:32:06,523 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:06,523 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.06\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: authentication_agent (domain: authentication)\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: authentication_agent\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.299 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:06,524 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: authentication_agent\
2025-11-14 08:32:06,525 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.299 (low)\
2025-11-14 08:32:06,525 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:06,525 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.06\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: authentication_agent (domain: authentication)\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: authentication_agent\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.299 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:06,526 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: authentication_agent\
2025-11-14 08:32:06,527 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence authentication agent starting\
2025-11-14 08:32:06,528 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: [] [Step 5.2.5] \uc0\u55357 \u56592  Authentication agent analyzing investigation\
2025-11-14 08:32:06,528 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for authentication_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:06,528 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: [] \uc0\u55357 \u56522  Authentication agent - Sample record structure (first record):\
2025-11-14 08:32:06,528 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: []    Record keys: ['TX_ID_KEY', 'EMAIL', 'IP', 'PAID_AMOUNT_VALUE_IN_CURRENCY', 'PAID_AMOUNT_CURRENCY', 'TX_DATETIME', 'PAYMENT_METHOD', 'CARD_BRAND', 'DEVICE_ID', 'USER_AGENT', 'IP_COUNTRY_CODE', 'IS_FRAUD_TX', 'MODEL_SCORE', 'MODEL_DECISION']\
2025-11-14 08:32:06,528 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: []    Sample values: \{'TX_ID_KEY': '23521172', 'EMAIL': 'okuoku1959122@gmail.com', 'IP': '2405:1202:50be:dc00:fcfa:56e7:9039:d685', 'PAID_AMOUNT_VALUE_IN_CURRENCY': 400000.0, 'PAID_AMOUNT_CURRENCY': 'JPY'\}\
2025-11-14 08:32:06,528 [WARNING] app.service.agent.orchestration.domain_agents.authentication_agent: [] \uc0\u9888 \u65039  Authentication agent: No evidence collected from analysis functions, adding basic transaction count\
2025-11-14 08:32:06,528 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:32:06,528 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:32:06,528 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 59\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.540\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $39,050,000.00 across 59 transactions\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 59):\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23521172...\
2025-11-14 08:32:06,528 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:58:31\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $400,000.00\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.445\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520885...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:44:36\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $850,000.00\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.470\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520457...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:32:14\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $900,000.00\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502488...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 15:01:44\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $500,000.00\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.465\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502209...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 14:43:58\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $800,000.00\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.466\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 59 raw records \u8594  formatted summary\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are an authentication security expert specializing in login \
            pattern analysis, credential security, and authentication anomaly detection. You \
            understand authentication-based fraud indicators and security risks.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transact...\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3476 chars)\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this authentication domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: okuoku1959122@gmail.com\
- Domain: authentication\
\
## Evidence Collected\
- Transaction data analyzed: 59 records processed\
- Authentication analysis completed on transaction dataset\
\
## Metrics and Data Points\
- Snowflake Records: 59\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 59\
- Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
- Average Model Score: 0.540\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $39,050,000.00 across 59 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 59):\
  Transaction 1:\
    - ID: 23521172...\
    - DateTime: 2025-11-13 14:58:31\
    - Amount: $400,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.445\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 23520885...\
    - DateTime: 2025-11-13 14:44:36\
    - Amount: $850,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.470\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 23520457...\
    - DateTime: 2025-11-13 14:32:14\
    - Amount: $900,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: 23502488...\
    - DateTime: 2025-11-12 15:01:44\
    - Amount: $500,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.465\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 23502209...\
    - DateTime: 2025-11-12 14:43:58\
    - Amount: $800,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.466\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTERNS DETECTED (PRIMARY INDICATORS):\
- VELOCITY BURST: 3 transactions in 5 minutes\
- AMOUNT CLUSTERING: $850,000.00 appears 4 times\
- DEVICE-IP MISMATCH: Device fdb94e81-8d28-46ca-b307-f04712... used 12 different IPs\
\
\uc0\u9888 \u65039  CRITICAL: These behavioral patterns are PRIMARY fraud indicators....\
2025-11-14 08:32:06,529 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5033 chars)\
[2025-11-14T08:32:06-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:06-0500] INFO [] module=_base_client: Retrying request to /responses in 0.479120 seconds\
[2025-11-14T08:32:07-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:07-0500] INFO [] module=_base_client: Retrying request to /responses in 0.820551 seconds\
[2025-11-14T08:32:08-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:08,729 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\uc0\u10060  EVIDENCE ANALYZER EXCEPTION CAUGHT\
   Domain: authentication\
   Exception: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
   Exception type: RateLimitError\
   Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
   Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\
2025-11-14 08:32:08,730 [ERROR] app.service.agent.evidence_analyzer: [] \uc0\u10060  authentication evidence analysis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:08,730 [ERROR] app.service.agent.evidence_analyzer: []    Exception type: RateLimitError\
2025-11-14 08:32:08,730 [ERROR] app.service.agent.evidence_analyzer: []    Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
2025-11-14 08:32:08,730 [ERROR] app.service.agent.evidence_analyzer: []    Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
2025-11-14 08:32:08,730 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.5] \uc0\u9989  Authentication analysis complete - Risk: 0.20\
2025-11-14 08:32:08,732 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for authentication_agent: 2203ms, 2 steps\
2025-11-14 08:32:08,732 [INFO] app.service.agent.orchestration.domain_agents.authentication_agent: [] [Step 5.2.5] \uc0\u9989  Authentication analysis complete - Risk: 0.20\
2025-11-14 08:32:08,734 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted authentication domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.2, has_llm_analysis: True)\
2025-11-14 08:32:08,735 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced authentication agent completed\
2025-11-14 08:32:08,735 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 5/6\
2025-11-14 08:32:08,736 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:32:08,737 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.310 (low)\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.07\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 0\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: merchant_agent (domain: merchant)\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: merchant_agent\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.310 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:08,738 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:08,739 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: merchant_agent\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.310 (low)\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.07\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:08,740 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 6 loops: 0.000\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  Next domain agent: merchant_agent (domain: merchant)\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: merchant_agent\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.310 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:08,740 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: merchant_agent\
2025-11-14 08:32:08,741 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence merchant agent starting\
2025-11-14 08:32:08,742 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u55356 \u57322  Merchant agent analyzing investigation\
2025-11-14 08:32:08,742 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for merchant_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:08,742 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] \uc0\u55357 \u56522  Merchant agent processing Snowflake data:\
2025-11-14 08:32:08,742 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data type: dict\
2025-11-14 08:32:08,742 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data keys: ['success', 'row_count', 'results', 'source']\
2025-11-14 08:32:08,742 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    snowflake_data['results'] count: 59\
2025-11-14 08:32:08,742 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] \uc0\u55357 \u56522  Sample record structure (first record):\
2025-11-14 08:32:08,742 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    Record keys: ['TX_ID_KEY', 'EMAIL', 'IP', 'PAID_AMOUNT_VALUE_IN_CURRENCY', 'PAID_AMOUNT_CURRENCY', 'TX_DATETIME', 'PAYMENT_METHOD', 'CARD_BRAND', 'DEVICE_ID', 'USER_AGENT', 'IP_COUNTRY_CODE', 'IS_FRAUD_TX', 'MODEL_SCORE', 'MODEL_DECISION']\
2025-11-14 08:32:08,742 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: []    Merchant-related fields: []\
2025-11-14 08:32:08,743 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] \uc0\u55357 \u56522  Evidence collected from Snowflake data: 5 items\
2025-11-14 08:32:08,743 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7.4] \uc0\u55357 \u56615  Tool Results Aggregation - 0 tool results available for LLM analysis\
2025-11-14 08:32:08,743 [WARNING] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7.4] \uc0\u9888 \u65039  No tool results available - LLM will only see Snowflake data and manual evidence\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56615  Tool Results Aggregation:\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    Total tool results available: 0\
2025-11-14 08:32:08,743 [WARNING] app.service.agent.evidence_analyzer: []    \uc0\u9888 \u65039  No tool results provided - LLM analysis may be incomplete\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56522  LLM receiving formatted Snowflake data:\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56520  Formatted summary:\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    Snowflake Transaction Context:\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    - Total Records: 59\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    - Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    - Average Model Score: 0.540\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    - High Risk Transactions (>0.7): 0\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    - Confirmed Fraud: 0\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    DOLLAR-WEIGHTED ANALYSIS:\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    - Total Volume: $39,050,000.00 across 59 transactions\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    - High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    - Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []    SAMPLE TRANSACTIONS (first 5 of 59):\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []      Transaction 1:\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23521172...\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:58:31\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $400,000.00\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.445\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []      Transaction 2:\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520885...\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:44:36\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $850,000.00\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:08,743 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.470\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []      Transaction 3:\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23520457...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-13 14:32:14\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $900,000.00\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.453\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []      Transaction 4:\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502488...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 15:01:44\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $500,000.00\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.465\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []      Transaction 5:\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - ID: 23502209...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - DateTime: 2025-11-12 14:43:58\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Amount: $800,000.00\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Email: okuoku1959122@gmail.com...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Device: fdb94e81-8d28-46ca-b307-f04712...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Payment: revolut\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Model Score: 0.466\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []        - Fraud Flag: False\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []    NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56541  Included in: SystemMessage (evidence analysis phase)\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []    \uc0\u55357 \u56522  Source data: 59 raw records \u8594  formatted summary\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: [] \uc0\u55357 \u56541  LLM Prompt (with formatted Snowflake data):\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []    System Message: You are a merchant analysis expert.\
\
You MUST NOT use MODEL_SCORE (or any model-derived risk score) to set or justify the numeric risk you return.\
You may cite it as context, but its weight is 0 in your final risk computation.\
\
EVIDENCE VOLUME RULE: If evidence volume is low (\uc0\u8804 1 event) AND no fraud patterns detected, \
you MAY default to LOW risk (\uc0\u8804 0.3) or explicitly state "needs more evidence" with low confidence.\
\
CRITICAL EXCEPTION: When Snowflake data shows clear fraud patterns (velocity bursts, amount clustering, \
IP rotation, device-IP mismatch), these behavioral anomalies are PRIMARY fraud indicators that override \
evidence volume constraints. Escalate risk regardless of external tool availability.\
\
BEHAVIORAL ANOMALIES ARE PRIMARY INDICATORS:\
- Velocity bursts (multiple transactions in short time) = HIGH fraud signal\
- Amount clustering (identical amounts in rapid succession) = HIGH fraud signal  \
- IP rotation (same device, multiple IPs) = MEDIUM-HIGH fraud signal\
- Device-IP m...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 3266 chars)\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []    Human Message: Analyze this merchant domain evidence for fraud risk assessment:\
\
\
SYSTEM RULE: You MUST provide a numeric risk score between 0.0 and 1.0 based on the evidence.\
Calculate the score by analyzing risk factors, patterns, and fraud indicators in the data provided.\
\
## Entity Information\
- Type: email\
- ID: okuoku1959122@gmail.com\
- Domain: merchant\
\
## Evidence Collected\
- Unique merchants: 1 across 59 transactions\
- Merchant risk distribution: High=0, Medium=0, Low=0\
- Merchant velocity: Single merchant (UNKNOWN)\
- Merchant category analysis: Single category or category data not available\
- Merchant decisions: \{'UNKNOWN': 59\}\
\
## Metrics and Data Points\
- Unique Merchants: 1\
- Total Transactions: 59\
- Fraud Transactions: 0\
- Merchant Risk Distribution: \{'UNKNOWN': 59\}\
- Merchant Decision Distribution: \{'UNKNOWN': 59\}\
\
## Snowflake Context\
Snowflake Transaction Context:\
- Total Records: 59\
- Date Range: 2025-11-01 15:04:04 to 2025-11-13 14:58:31\
- Average Model Score: 0.540\
- High Risk Transactions (>0.7): 0\
- Confirmed Fraud: 0\
\
DOLLAR-WEIGHTED ANALYSIS:\
- Total Volume: $39,050,000.00 across 59 transactions\
- High Risk (\uc0\u8805 0.7): 0.0% of volume ($0.00) from 0.0% of transactions\
- Blocked Transactions: 0.0% of volume ($0.00) from 0.0% of transactions\
\
SAMPLE TRANSACTIONS (first 5 of 59):\
  Transaction 1:\
    - ID: 23521172...\
    - DateTime: 2025-11-13 14:58:31\
    - Amount: $400,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.445\
    - Fraud Flag: False\
  Transaction 2:\
    - ID: 23520885...\
    - DateTime: 2025-11-13 14:44:36\
    - Amount: $850,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.470\
    - Fraud Flag: False\
  Transaction 3:\
    - ID: 23520457...\
    - DateTime: 2025-11-13 14:32:14\
    - Amount: $900,000.00\
    - IP: 2405:1202:50be:dc00:fcfa:56e7:9039:d685 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.453\
    - Fraud Flag: False\
  Transaction 4:\
    - ID: 23502488...\
    - DateTime: 2025-11-12 15:01:44\
    - Amount: $500,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.465\
    - Fraud Flag: False\
  Transaction 5:\
    - ID: 23502209...\
    - DateTime: 2025-11-12 14:43:58\
    - Amount: $800,000.00\
    - IP: 2405:1202:50be:dc00:daf0:3b99:16f3:8b10 (JP)\
    - Email: okuoku1959122@gmail.com...\
    - Device: fdb94e81-8d28-46ca-b307-f04712...\
    - Payment: revolut\
    - Model Score: 0.466\
    - Fraud Flag: False\
\
NOTE: MODEL_SCORE is for reference only - your analysis should be based on domain-specific evidence.\
\
## FRAUD PATTER...\
2025-11-14 08:32:08,744 [INFO] app.service.agent.evidence_analyzer: []    ... (truncated, full length: 5316 chars)\
[2025-11-14T08:32:08-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:08-0500] INFO [] module=_base_client: Retrying request to /responses in 0.480175 seconds\
[2025-11-14T08:32:09-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:09-0500] INFO [] module=_base_client: Retrying request to /responses in 0.924508 seconds\
[2025-11-14T08:32:11-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:11,126 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\uc0\u10060  EVIDENCE ANALYZER EXCEPTION CAUGHT\
   Domain: merchant\
   Exception: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
   Exception type: RateLimitError\
   Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
   Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
================================================================================\
\
2025-11-14 08:32:11,128 [ERROR] app.service.agent.evidence_analyzer: [] \uc0\u10060  merchant evidence analysis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:11,128 [ERROR] app.service.agent.evidence_analyzer: []    Exception type: RateLimitError\
2025-11-14 08:32:11,128 [ERROR] app.service.agent.evidence_analyzer: []    Exception args: ("Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}",)\
2025-11-14 08:32:11,129 [ERROR] app.service.agent.evidence_analyzer: []    Full traceback:\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/evidence_analyzer.py", line 187, in analyze_domain_evidence\
    response = await self.llm.ainvoke([system_msg, human_msg])\
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/llm_manager.py", line 79, in ainvoke\
    resp = self.client.responses.create(\
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_utils/_utils.py", line 287, in wrapper\
    return func(*args, **kwargs)\
           ^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/resources/responses/responses.py", line 701, in create\
    return self._post(\
           ^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1249, in post\
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\
  File "/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/openai/_base_client.py", line 1037, in request\
    raise self._make_status_error_from_response(err.response) from None\
openai.RateLimitError: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
\
2025-11-14 08:32:11,130 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.7] \uc0\u9989  Merchant analysis complete - Risk: 0.60\
2025-11-14 08:32:11,133 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for merchant_agent: 2388ms, 2 steps\
2025-11-14 08:32:11,134 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u9989  Merchant analysis complete - Evidence collected: 6 points\
2025-11-14 08:32:11,135 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: [] \uc0\u55357 \u56589  Running merchant validation for investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:11,136 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: []    Entity: email=okuoku1959122@gmail.com\
2025-11-14 08:32:11,136 [INFO] app.service.agent.orchestration.domain_agents.merchant_validation: []    Historical date: 2025-05-18\
2025-11-14 08:32:11,136 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT \
            TX_ID_KEY,\
            TX_DATETIME,\
            MERCHANT_NAME,\
            PAID_AMOUNT_VALUE_IN_CURRENCY,\
            MODEL_SCORE,\
            IS_FRAUD_TX\
        FROM DBT.DBT_PROD...\
/Users/gklainert/Library/Caches/pypoetry/virtualenvs/olorin-service-qT9n0YLx-py3.11/lib/python3.11/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py:442: DeprecationWarning: Attempting to mutate a Context after a Connection was created. In the future, this will raise an exception\
  self._ctx.set_verify(_stdlib_to_openssl_verify[value], _verify_callback)\
2025-11-14 08:32:12,085 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 0 rows\
2025-11-14 08:32:12,085 [WARNING] app.service.agent.orchestration.domain_agents.merchant_validation: [] \uc0\u9888 \u65039  No historical data found for validation\
2025-11-14 08:32:12,085 [INFO] app.service.agent.orchestration.domain_agents.merchant_agent: [] [Step 5.2.7] \uc0\u9989  Merchant validation completed\
2025-11-14 08:32:12,088 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted merchant domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.6, has_llm_analysis: True)\
2025-11-14 08:32:12,088 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced merchant agent completed\
2025-11-14 08:32:12,089 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 6/6\
2025-11-14 08:32:12,090 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:12,090 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.331 (low)\
2025-11-14 08:32:12,090 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:12,090 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.08\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:12,091 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 6 loops: 0.000\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.331 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:12,091 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.331 (low)\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.09\
2025-11-14 08:32:12,092 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:12,092 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 7 loops: 0.000\
2025-11-14 08:32:12,093 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:12,093 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:12,093 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.331 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:12,093 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:12,093 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:12,093 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:12,094 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:12,094 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:12,094 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:12,094 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.443\
2025-11-14 08:32:12,095 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:12,095 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:12-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:12-0500] INFO [] module=_base_client: Retrying request to /responses in 0.395529 seconds\
[2025-11-14T08:32:13-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:13-0500] INFO [] module=_base_client: Retrying request to /responses in 0.815069 seconds\
[2025-11-14T08:32:14-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:14,255 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:14,255 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:14,255 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:14,255 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:14,256 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2160ms, 2 steps\
2025-11-14 08:32:14,256 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 13 synthesis points\
2025-11-14 08:32:14,259 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.44337146632522406, has_llm_analysis: True)\
2025-11-14 08:32:14,259 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:14,259 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:14,261 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:32:14,262 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.09\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:14,263 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 7 loops: 0.000\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:14,263 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:14,265 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 8 loops: 0.000\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:14,265 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:14,266 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:14,267 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:14,267 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:14,267 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:14,267 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:14,267 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:14-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:14-0500] INFO [] module=_base_client: Retrying request to /responses in 0.384441 seconds\
[2025-11-14T08:32:15-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:15-0500] INFO [] module=_base_client: Retrying request to /responses in 0.948765 seconds\
[2025-11-14T08:32:16-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:16,736 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:16,736 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:16,736 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:16,736 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:16,741 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2470ms, 2 steps\
2025-11-14 08:32:16,741 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:16,747 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.4436906631384264, has_llm_analysis: True)\
2025-11-14 08:32:16,748 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:16,748 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:16,749 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:16,750 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 8 loops: 0.000\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:16,750 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:16,752 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:16,752 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:16,752 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:16,752 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:16,753 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 9 loops: 0.000\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:16,753 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:16,754 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:16,754 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:16,755 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:16,755 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:16,755 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:16,755 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:17-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:17-0500] INFO [] module=_base_client: Retrying request to /responses in 0.490421 seconds\
[2025-11-14T08:32:18-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:18-0500] INFO [] module=_base_client: Retrying request to /responses in 0.858203 seconds\
[2025-11-14T08:32:19-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:19,482 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:19,482 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:19,482 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:19,482 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:19,485 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2728ms, 2 steps\
2025-11-14 08:32:19,485 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:19,490 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.4437320405031009, has_llm_analysis: True)\
2025-11-14 08:32:19,490 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:19,490 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:19,491 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:32:19,493 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:19,493 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:19,493 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:19,493 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.10\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:19,494 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 9 loops: 0.000\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:19,494 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:19,495 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:19,495 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:19,495 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:19,495 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:19,496 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 10 loops: 0.000\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:19,496 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:19,497 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:19,498 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:19,498 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:19,498 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:19,498 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:19,498 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:20-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:20-0500] INFO [] module=_base_client: Retrying request to /responses in 0.434471 seconds\
[2025-11-14T08:32:20-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:20-0500] INFO [] module=_base_client: Retrying request to /responses in 0.852405 seconds\
[2025-11-14T08:32:22-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:22,115 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:22,115 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:22,115 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:22,115 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:22,116 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2617ms, 2 steps\
2025-11-14 08:32:22,116 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:22,120 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.44373740423555863, has_llm_analysis: True)\
2025-11-14 08:32:22,120 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:22,120 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:22,121 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:22,122 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 10 loops: 0.000\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:22,122 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:22,124 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 11 loops: 0.000\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:22,124 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:22,126 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:22,126 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:22,126 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:22,126 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:22,127 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:22,127 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:22-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:22-0500] INFO [] module=_base_client: Retrying request to /responses in 0.487429 seconds\
[2025-11-14T08:32:23-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:23-0500] INFO [] module=_base_client: Retrying request to /responses in 0.838544 seconds\
[2025-11-14T08:32:24-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:24,460 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:24,460 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:24,460 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:24,460 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:24,462 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2334ms, 2 steps\
2025-11-14 08:32:24,462 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:24,467 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.4437380995342106, has_llm_analysis: True)\
2025-11-14 08:32:24,467 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:24,467 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:24,469 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.11\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:24,470 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 11 loops: 0.000\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:24,470 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.12\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:24,472 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 12 loops: 0.000\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:24,472 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:24,473 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:24,474 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:24,474 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:24,474 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:24,474 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:24,474 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:24-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:24-0500] INFO [] module=_base_client: Retrying request to /responses in 0.429313 seconds\
[2025-11-14T08:32:25-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:25-0500] INFO [] module=_base_client: Retrying request to /responses in 0.898792 seconds\
[2025-11-14T08:32:27-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:27,675 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:27,675 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:27,675 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:27,675 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:27,676 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3201ms, 2 steps\
2025-11-14 08:32:27,676 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:27,679 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.44373818966551726, has_llm_analysis: True)\
2025-11-14 08:32:27,679 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:27,679 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:27,681 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:32:27,685 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:32:27,685 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:32:27,969 [INFO] app.service.rag.investigation_indexer: [] Found 158 investigations with status='COMPLETED'\
2025-11-14 08:32:27,991 [INFO] app.service.rag.vector_rag_service: [] Ingesting document dc062c3b-2ea3-448c-bc28-f2fbfdd5308e: 1 chunks to create\
2025-11-14 08:32:27,995 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.12\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:27,996 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 12 loops: 0.000\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:27,996 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:27,998 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 13 loops: 0.000\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:27,998 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:27,999 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:28,000 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:28,000 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:28,000 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:28,000 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:28,001 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:28-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:28-0500] INFO [] module=_base_client: Retrying request to /responses in 0.489568 seconds\
[2025-11-14T08:32:29-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:29-0500] INFO [] module=_base_client: Retrying request to /responses in 0.876107 seconds\
[2025-11-14T08:32:30-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:30,347 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:30,347 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:30,348 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:30,348 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:30,349 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2347ms, 2 steps\
2025-11-14 08:32:30,349 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:30,352 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.44373820134920516, has_llm_analysis: True)\
2025-11-14 08:32:30,352 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:30,352 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:30,356 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:30,356 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:30,356 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:30,356 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:30,357 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 13 loops: 0.000\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:30,357 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:32:30,358 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:30,358 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 14 loops: 0.000\
2025-11-14 08:32:30,359 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:30,359 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:30,359 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:30,359 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:30,359 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:30,359 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:30,360 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:30,360 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:30,360 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:30,361 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:30,361 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:30,361 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:30-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:30-0500] INFO [] module=_base_client: Retrying request to /responses in 0.473620 seconds\
[2025-11-14T08:32:31-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:31-0500] INFO [] module=_base_client: Retrying request to /responses in 0.840708 seconds\
[2025-11-14T08:32:32-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:32,505 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:32,506 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:32,506 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:32,506 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:32,507 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2145ms, 2 steps\
2025-11-14 08:32:32,507 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:32,510 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.4437382028637573, has_llm_analysis: True)\
2025-11-14 08:32:32,510 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:32,510 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:32,513 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:32,513 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:32,513 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:32,513 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.13\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:32,514 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 14 loops: 0.000\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:32,514 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:32,515 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:32,515 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:32,515 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:32,515 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:32,515 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:32,515 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:32,515 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:32,515 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:32:32,516 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:32,516 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 15 loops: 0.000\
2025-11-14 08:32:32,516 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:32,516 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:32,516 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:32,516 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:32,516 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:32,516 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:32,517 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:32,517 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:32,517 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:32,517 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:32,517 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:32,518 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:32-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:32-0500] INFO [] module=_base_client: Retrying request to /responses in 0.419405 seconds\
[2025-11-14T08:32:34-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:34-0500] INFO [] module=_base_client: Retrying request to /responses in 0.993413 seconds\
[2025-11-14T08:32:35-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:35,967 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:35,967 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:35,967 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:35,967 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:35,969 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3450ms, 2 steps\
2025-11-14 08:32:35,969 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:35,973 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.44373820306008815, has_llm_analysis: True)\
2025-11-14 08:32:35,973 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:35,973 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:32:35-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:35,975 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
[2025-11-14T08:32:35-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.447275 seconds\
2025-11-14 08:32:35,977 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:35,978 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 15 loops: 0.000\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:35,978 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:35,979 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:35,979 [INFO] uvicorn.access: [] 127.0.0.1:64922 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:32:35,980 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:35,980 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:35,980 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:35,981 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 16 loops: 0.000\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:35,981 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:35,982 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:35,983 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:35,983 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:35,983 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:35,983 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:35,983 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:36-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:36-0500] INFO [] module=_base_client: Retrying request to /responses in 0.458438 seconds\
[2025-11-14T08:32:37-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:37-0500] INFO [] module=_base_client: Retrying request to /responses in 0.986218 seconds\
[2025-11-14T08:32:38-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:38,527 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:38,527 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:38,527 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:38,527 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:38,528 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2544ms, 2 steps\
2025-11-14 08:32:38,528 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:38,531 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.44373820308553846, has_llm_analysis: True)\
2025-11-14 08:32:38,532 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:38,532 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:38,535 [INFO] app.service.etag_service: [investigation_id=fa73ec99-82ed-4818-af79-15a8ef601bcc, olorin_tid=61702a18-b399-4c8c-a174-d7df6103ca81] etag_retrieved\
2025-11-14 08:32:38,536 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:38,537 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:38,537 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:38,537 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:38,537 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:38,537 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:38,537 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:38,537 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:38,538 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.14\
2025-11-14 08:32:38,538 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:38,538 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 16 loops: 0.000\
2025-11-14 08:32:38,538 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:38,538 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:38,538 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:38,538 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:38,538 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:38,538 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:38,538 [INFO] uvicorn.access: [] 127.0.0.1:64922 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.15\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:38,540 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 17 loops: 0.000\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:38,540 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:38,541 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:38,542 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:38,542 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:38,542 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:38,542 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:38,543 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:39-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:39-0500] INFO [] module=_base_client: Retrying request to /responses in 0.395016 seconds\
[2025-11-14T08:32:40-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:40-0500] INFO [] module=_base_client: Retrying request to /responses in 0.918292 seconds\
[2025-11-14T08:32:41-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:41,772 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:41,772 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:41,772 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:41,772 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:41,773 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 3230ms, 2 steps\
2025-11-14 08:32:41,773 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:41,776 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.4437382030888376, has_llm_analysis: True)\
2025-11-14 08:32:41,777 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:41,777 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:32:41-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:41,778 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
[2025-11-14T08:32:41-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.817642 seconds\
2025-11-14 08:32:41,780 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.15\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:41,781 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 17 loops: 0.000\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:41,781 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:41,782 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:41,782 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:41,782 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.17\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:41,783 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 18 loops: 0.000\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:41,783 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:41,784 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:41,785 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:41,785 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:41,785 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:41,785 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:41,785 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:42-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:42-0500] INFO [] module=_base_client: Retrying request to /responses in 0.431107 seconds\
[2025-11-14T08:32:42-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:42-0500] INFO [] module=_base_client: Retrying request to /responses in 0.995222 seconds\
[2025-11-14T08:32:44-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:44,016 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:44,017 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:44,017 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:44,017 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:44,018 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2232ms, 2 steps\
2025-11-14 08:32:44,018 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:44,021 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.44373820308926526, has_llm_analysis: True)\
2025-11-14 08:32:44,021 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:44,021 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:44,023 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.17\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:44,024 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 18 loops: 0.000\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:44,024 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.19\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:44,026 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 19 loops: 0.000\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:44,026 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:44,027 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:44,028 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:44,028 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:44,028 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:44,028 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:44,028 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:44-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:44-0500] INFO [] module=_base_client: Retrying request to /responses in 0.420690 seconds\
[2025-11-14T08:32:45-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:45-0500] INFO [] module=_base_client: Retrying request to /responses in 0.810150 seconds\
[2025-11-14T08:32:46-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:46,393 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:46,393 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:46,393 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:46,393 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:46,394 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2365ms, 2 steps\
2025-11-14 08:32:46,394 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:46,397 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.44373820308932066, has_llm_analysis: True)\
2025-11-14 08:32:46,397 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:46,397 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
[2025-11-14T08:32:46-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:46,398 [ERROR] app.service.rag.embedding_service: [] OpenAI embedding generation failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:46,398 [WARNING] app.service.rag.vector_rag_service: [] Failed to generate embedding for chunk 0: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:46,398 [INFO] app.service.rag.vector_rag_service: [] Created 1 chunks for document dc062c3b-2ea3-448c-bc28-f2fbfdd5308e\
2025-11-14 08:32:46,400 [INFO] app.service.rag.investigation_indexer: [] Indexed investigation auto-comp-3d0f6225dbb6 with 1 chunks\
2025-11-14 08:32:46,465 [INFO] app.service.rag.investigation_indexer: [] Indexed 1 new/updated investigations out of 158 checked\
2025-11-14 08:32:46,465 [INFO] app.service.rag.investigation_indexing_background: [] Indexed 1 new/updated investigations\
2025-11-14 08:32:46,466 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.19\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 1\
2025-11-14 08:32:46,467 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 19 loops: 0.000\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:46,467 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.22\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 2\
2025-11-14 08:32:46,469 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  HIGH: Orchestrator loop limit approaching: 20/25\
2025-11-14 08:32:46,469 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 20 loops: 0.000\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:46,469 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: risk_agent\
2025-11-14 08:32:46,470 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u55356 \u57263  Hybrid Intelligence risk agent starting\
2025-11-14 08:32:46,471 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9888 \u65039  Risk agent performing final assessment\
2025-11-14 08:32:46,471 [INFO] app.service.agent.chain_of_thought_logger: [] Started thought process tracking for risk_agent on investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:46,471 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u55357 \u56522  Volume weighting: domain_risk=0.441, tx_risk=0.449, blended=0.444\
2025-11-14 08:32:46,471 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56800  Starting LLM synthesis of all domain findings\
2025-11-14 08:32:46,471 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u55358 \u56598  Invoking LLM for cross-domain synthesis...\
[2025-11-14T08:32:46-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:46-0500] INFO [] module=_base_client: Retrying request to /responses in 0.446382 seconds\
[2025-11-14T08:32:47-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:32:47-0500] INFO [] module=_base_client: Retrying request to /responses in 0.823177 seconds\
[2025-11-14T08:32:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:32:48,870 [ERROR] app.service.llm_manager: [] \uc0\u10060  GPT-5 Responses API error: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:48,870 [ERROR] app.service.agent.orchestration.domain_agents.risk_agent: [] \uc0\u10060  LLM synthesis failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:32:48,870 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  LLM synthesis complete - Cross-domain patterns identified\
2025-11-14 08:32:48,870 [INFO] app.service.agent.orchestration.domain_agents.base: [] [Step 5.2.8] \uc0\u9989  Risk analysis complete - Risk: 0.44\
2025-11-14 08:32:48,871 [INFO] app.service.agent.chain_of_thought_logger: [] Completed thought process for risk_agent: 2399ms, 2 steps\
2025-11-14 08:32:48,871 [INFO] app.service.agent.orchestration.domain_agents.risk_agent: [] [Step 5.2.6] \uc0\u9989  Risk synthesis complete - Narrative-only domain with 14 synthesis points\
2025-11-14 08:32:48,875 [INFO] app.service.domain_findings_service: [] \uc0\u9989  Persisted risk domain findings for investigation auto-comp-a022e93e4e7f (risk_score: 0.4437382030893279, has_llm_analysis: True)\
2025-11-14 08:32:48,875 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: [] \uc0\u9989  Enhanced risk agent completed\
2025-11-14 08:32:48,875 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.domain_agent_enhancer: []    Domains completed: 7/6\
2025-11-14 08:32:48,876 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:32:48,878 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u55356 \u57243 \u65039  Hybrid Intelligence orchestrator executing\
2025-11-14 08:32:48,878 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:48,878 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:48,878 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: standard\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: True\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: False\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 0.22\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 2\
2025-11-14 08:32:48,879 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  HIGH: Orchestrator loop limit approaching: 20/25\
2025-11-14 08:32:48,879 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 20 loops: 0.000\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55356 \u57263  All 6 domain agents complete - routing to risk aggregation agent\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: risk_agent\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: False\
2025-11-14 08:32:48,879 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.orchestrator_node: [] \uc0\u9989  Hybrid orchestrator decision: risk_agent\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: [] \uc0\u55358 \u56800  AI confidence calculated: 0.344 (low)\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Strategy: comprehensive\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.intelligence.decision_engine: []    Next action: summary\
2025-11-14 08:32:48,880 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u55357 \u57000  Immediate termination required: 2 critical concerns\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: [] \uc0\u55357 \u57057 \u65039  Safety validation complete\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety level: emergency\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    AI control allowed: False\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Termination required: True\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Resource pressure: 1.00\
2025-11-14 08:32:48,880 [INFO] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    Safety concerns: 3\
2025-11-14 08:32:48,880 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  CRITICAL: Orchestrator loop limit approaching: 21/12\
2025-11-14 08:32:48,880 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  CRITICAL: High resource pressure: 1.00\
2025-11-14 08:32:48,880 [WARNING] app.service.agent.orchestration.hybrid.advanced_safety_manager: []    \uc0\u9888 \u65039  MEDIUM: Low evidence quality after 21 loops: 0.000\
2025-11-14 08:32:48,880 [WARNING] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55357 \u57000  Emergency termination required\
2025-11-14 08:32:48,881 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Routing decision: summary\
2025-11-14 08:32:48,881 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Confidence: 0.344 (AIConfidenceLevel.LOW)\
2025-11-14 08:32:48,881 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Strategy: InvestigationStrategy.COMPREHENSIVE\
2025-11-14 08:32:48,881 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: []    Safety override: True\
2025-11-14 08:32:48,881 [INFO] app.service.agent.orchestration.hybrid.intelligent_router: [] \uc0\u55358 \u56813  Hybrid routing: summary\
2025-11-14 08:32:48,881 [WARNING] app.service.agent.orchestration.hybrid.intelligent_router: []    \uc0\u9888 \u65039  Safety override: emergency_termination\
2025-11-14 08:32:48,882 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u55357 \u56523  Hybrid Intelligence summary generation starting\
2025-11-14 08:32:48,882 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Confidence consolidated: 0.000 (MINIMAL)\
2025-11-14 08:32:48,882 [INFO] app.service.agent.orchestration.risk.evidence_gating: [] \uc0\u9989  Detected comprehensive Snowflake data: 59 transactions with fraud indicators\
2025-11-14 08:32:48,882 [INFO] app.service.agent.orchestration.risk.evidence_gating: [] \uc0\u55357 \u56580  Adjusted external score to 0.4 due to comprehensive Snowflake data\
2025-11-14 08:32:48,882 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Evidence gating applied: strength=0.831\
2025-11-14 08:32:48,882 [INFO] app.service.agent.orchestration.risk.policy: [] \uc0\u55357 \u56594  LLM narrative isolation: Updated 6 domains - ['network', 'device', 'location', 'logs', 'authentication', 'merchant']\
2025-11-14 08:32:48,882 [INFO] app.service.agent.orchestration.risk.policy: []    Engine math will now exclude LLM claimed_risk from all calculations\
2025-11-14 08:32:48,882 [INFO] app.service.agent.orchestration.risk.finalize: [] Cross-domain deduplication: removed 9 duplicate paragraphs\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: [] \uc0\u55357 \u56589  Fraud pattern score: 0.460\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: []    Patterns detected: velocity=True, clustering=True, rotation=False\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: [] Evidence strength computed: 0.600 (diversity: 0.10, corroboration: 0.20, volume: 0.20, quality: 0.10) [internal: False, external: 0, domains: 7]\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: [] \uc0\u55357 \u56589  compute_final_risk: domain_findings type=<class 'dict'>, keys=['network', 'device', 'location', 'logs', 'authentication', 'merchant', 'risk']\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: []    logs: risk_score=0.4\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: []    network: risk_score=0.5\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: []    device: risk_score=0.4\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: []    location: risk_score=0.5\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.risk.finalize: []    authentication: risk_score=0.2\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u9989  EVIDENCE GATING: PASS (scores=5, signals=22)\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: numeric_domains=['logs', 'network', 'device', 'location', 'authentication']\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: scores=[0.4, 0.5, 0.4, 0.5, 0.2]\
2025-11-14 08:32:48,883 [INFO] app.service.agent.orchestration.domain.aggregator: [] \uc0\u55356 \u57263  SINGLE AGGREGATOR: pre_gate=0.400, final=0.400, gate=PASS\
2025-11-14 08:32:48,884 [INFO] app.service.agent.orchestration.risk.policy: [] \uc0\u55357 \u56580  RECONCILED: is_public for okuoku1959122@gmail.com: None \u8594  True\
2025-11-14 08:32:48,884 [ERROR] app.service.agent.orchestration.domain.linter: [] \uc0\u55357 \u57000  LINTING FAILURES DETECTED (1 issues):\
2025-11-14 08:32:48,884 [ERROR] app.service.agent.orchestration.domain.linter: []   1. state.risk_score (0.6) != final_risk (0.4)\
2025-11-14 08:32:48,884 [WARNING] app.service.agent.orchestration.risk.finalize: [] \uc0\u55357 \u57000  LINTING VIOLATIONS DETECTED: 1 issues before publishing risk\
2025-11-14 08:32:48,884 [WARNING] app.service.agent.orchestration.risk.finalize: []    LINT ERROR 1: state.risk_score (0.6) != final_risk (0.4)\
2025-11-14 08:32:48,884 [ERROR] app.service.agent.orchestration.domain.linter: [] \uc0\u55357 \u57000  LINTING FAILURES DETECTED (1 issues):\
2025-11-14 08:32:48,884 [ERROR] app.service.agent.orchestration.domain.linter: []   1. state.risk_score (0.6) != final_risk (0.4)\
2025-11-14 08:32:48,884 [WARNING] app.service.agent.orchestration.domain.linter: [] \uc0\u9888 \u65039   Investigation linting warnings: 1 issues\
2025-11-14 08:32:48,884 [WARNING] app.service.agent.orchestration.domain.linter: []   WARNING: state.risk_score (0.6) != final_risk (0.4)\
2025-11-14 08:32:48,884 [INFO] app.service.agent.orchestration.risk.finalize: [] \uc0\u55356 \u57263  Action plan generated: 2 recommendations for risk 0.400\
2025-11-14 08:32:48,884 [WARNING] app.service.agent.orchestration.risk.finalize: [] end_time missing - computing defensively to prevent crash\
2025-11-14 08:32:48,884 [WARNING] app.service.agent.orchestration.risk.finalize: [] \uc0\u9888 \u65039  FALLBACK: No valid timing data, using current time as end_time = 2025-11-14T13:32:48.884511+00:00\
2025-11-14 08:32:48,884 [ERROR] app.service.agent.orchestration.risk.finalize: [] \uc0\u10060  Business logic regression detected: tools_used=1 but tool_results is empty\
2025-11-14 08:32:48,884 [ERROR] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u10060  Enhanced summary failed: tools_used=1 but tool_results is empty\
2025-11-14 08:32:48,884 [ERROR] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] Enhanced summary generation error details\
Traceback (most recent call last):\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/orchestration/hybrid/graph/nodes/summary_nodes.py", line 123, in enhanced_summary_node\
    finalize_risk(state)\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/orchestration/risk/finalize.py", line 290, in finalize_risk\
    _assert_sanity_checks(state, final_risk)\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/orchestration/risk/finalize.py", line 644, in _assert_sanity_checks\
    _assert_business_logic_regressions(state)\
  File "/Users/gklainert/Documents/olorin/olorin-server/app/service/agent/orchestration/risk/finalize.py", line 706, in _assert_business_logic_regressions\
    assert len(tool_results) > 0, f"tools_used=\{len(tools_used)\} but tool_results is empty"\
           ^^^^^^^^^^^^^^^^^^^^^\
AssertionError: tools_used=1 but tool_results is empty\
2025-11-14 08:32:48,885 [INFO] app.service.agent.orchestration.hybrid.canonical_outcome: [] \uc0\u9989  Canonical outcome built: failed for auto-comp-a022e93e4e7f\
2025-11-14 08:32:48,885 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u55357 \u57057 \u65039  Canonical outcome generated for error case: failed\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u9989  Hybrid Intelligence Graph investigation completion\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: [] \uc0\u55357 \u56522  Final Investigation Statistics:\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Investigation ID: auto-comp-a022e93e4e7f\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Total duration: 0ms\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Orchestrator loops: 21\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Domains completed: 7/6\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Tools used: 1\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Safety overrides: 0\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Final confidence: 0.000\
2025-11-14 08:32:48,887 [INFO] app.service.agent.orchestration.hybrid.graph.nodes.summary_nodes: []    Investigation efficiency: 0.744\
2025-11-14 08:32:48,889 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u55357 \u56523  REAL AGENT SERVICE RESULT: Investigation completed...\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  LLM Call: MultiAgentOrchestrator \u8594  gpt-4o\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Tools: langgraph_parallel_execution, recursion_guard | Tokens: 126.80000000000001\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Completed real structured investigation execution in 197198ms with RecursionGuard protection.\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55358 \u56800  Decision: DeviceAnalysisAgent \u8594  device_analysis_complete\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Confidence: 95.00 | Outcome: N/A\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Reasoning: Device analysis completed successfully with comprehensive findings\
2025-11-14 08:32:48,890 [INFO] app.router.controllers.investigation_executor_core: [] \uc0\u9989  REAL AGENT EXECUTION COMPLETED in 197198ms\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: DeviceAnalysisAgent (analysis_agent)\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 39439ms \uc0\u8594  LocationAnalysisAgent\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['device_analysis_completed']\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: LocationAnalysisAgent (analysis_agent)\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 39439ms \uc0\u8594  NetworkAnalysisAgent\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['location_analysis_completed']\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: NetworkAnalysisAgent (analysis_agent)\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 39439ms \uc0\u8594  LogsAnalysisAgent\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['network_analysis_completed']\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: LogsAnalysisAgent (analysis_agent)\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 39439ms \uc0\u8594  RiskAssessmentAgent\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['logs_analysis_completed']\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56522  Node: RiskAssessmentAgent (synthesis_agent)\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Duration: 39439ms \uc0\u8594  END\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            State Changes: +['all_analyses_completed', 'risk_assessment_completed']\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  results_processing\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 75% | Phases: 3 completed\
2025-11-14 08:32:48,890 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: results_processing\
2025-11-14 08:32:48,893 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-a022e93e4e7f: \{'current_phase': 'results_processing', 'progress_percentage': 85.0\}\
2025-11-14 08:32:48,893 [INFO] app.router.controllers.investigation_completion: [] \uc0\u55357 \u56523  REAL AGENT RESULT CONTENT: Investigation completed...\
2025-11-14 08:32:48,894 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: phase_progress \u8594  results_processing\
2025-11-14 08:32:48,894 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 75% | Phases: 3 completed\
2025-11-14 08:32:48,894 [INFO] app.service.logging.autonomous_investigation_logger: []            Active Agents: results_processing\
2025-11-14 08:32:48,896 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-a022e93e4e7f: \{'current_phase': 'results_processing', 'progress_percentage': 85.0\}\
2025-11-14 08:32:48,896 [INFO] app.router.controllers.investigation_completion: [] \uc0\u55357 \u56523  REAL AGENT RESULT CONTENT: Investigation completed...\
2025-11-14 08:32:48,897 [INFO] app.service.agent.journey_tracker: [] Completed journey tracking for investigation: auto-comp-a022e93e4e7f (225ms, 6 nodes)\
2025-11-14 08:32:48,899 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-a022e93e4e7f: \{'current_phase': 'completion', 'progress_percentage': 100.0, 'status': 'completed'\}\
2025-11-14 08:32:48,900 [INFO] app.service.logging.autonomous_investigation_logger: []         \uc0\u55357 \u56520  Progress: completed \u8594  completion\
2025-11-14 08:32:48,900 [INFO] app.service.logging.autonomous_investigation_logger: []            Completion: 80% | Phases: 4 completed\
2025-11-14 08:32:48,901 [INFO] app.router.controllers.investigation_controller: [] Persisted status update for investigation auto-comp-a022e93e4e7f: \{'status': 'completed', 'completion_time': '2025-11-14T13:32:48.900046+00:00', 'findings_summary': \{'risk_score': None, 'findings': [\{'investigation_outcome': 'REAL structured investigation completed', 'total_agents_used': 5, 'investigation_duration_ms': 0, 'real_agent_execution': True\}], 'summary': 'Investigation completed', 'completed_at': '2025-11-14T13:32:48.900055+00:00'\}\}\
2025-11-14 08:32:48,901 [INFO] app.router.controllers.investigation_completion: [] Completed structured investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:32:48,902 [INFO] app.service.agent.recursion_guard: [] Removed context for investigation auto-comp-a022e93e4e7f, final stats: \{'investigation_id': 'auto-comp-a022e93e4e7f', 'thread_id': 'auto-comp-a022e93e4e7f-None', 'duration_seconds': 197.2513678073883, 'current_depth': 0, 'max_depth_reached': 0, 'total_tool_calls': 0, 'unique_tools_used': 0, 'node_path': [], 'tool_sequence': []\}\
2025-11-14 08:32:48,902 [INFO] app.router.controllers.investigation_executor: [] \uc0\u55357 \u57057 \u65039  Cleaned up RecursionGuard context for investigation auto-comp-a022e93e4e7f\
2025-11-14 08:32:48,902 [INFO] app.router.controllers.investigation_executor: [] Completed structured investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:32:53,880 [INFO] app.service.investigation_progress_service: [] [PROGRESS] Investigation auto-comp-a022e93e4e7f: progress_json exists=True, has tool_executions=False, count=0\
2025-11-14 08:32:53,881 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Investigation auto-comp-a022e93e4e7f completed!\
2025-11-14 08:32:54,271 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Created and completed historical investigation: auto-comp-a022e93e4e7f\
2025-11-14 08:32:54,271 [INFO] app.service.investigation.auto_comparison: [] \uc0\u55357 \u56522  Prediction Validation Setup:\
2025-11-14 08:32:54,271 [INFO] app.service.investigation.auto_comparison: []    Window A (Historical Investigation): 2025-08-02 to 2025-08-16\
2025-11-14 08:32:54,271 [INFO] app.service.investigation.auto_comparison: []    Window B (Validation Period): 2025-08-16 to 2025-11-14\
2025-11-14 08:32:54,271 [INFO] app.service.investigation.auto_comparison: []    Predicted Risk: None\
2025-11-14 08:32:54,272 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-02T09:29:20.845872-04:00' AND TX_DATETIME < '2025-08-16T09:29:20.845872-04:00' AND EMAIL_NORMALIZED = 'okuoku1959122@gmail....\
2025-11-14 08:32:55,201 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:32:55,201 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:32:55,202 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Executing Snowflake query: SELECT COUNT(*) as count FROM DBT.DBT_PROD.TXS WHERE TX_DATETIME >= '2025-08-16T09:29:20.845872-04:00' AND TX_DATETIME < '2025-11-14T08:29:20.845872-05:00' AND EMAIL_NORMALIZED = 'okuoku1959122@gmail....\
2025-11-14 08:32:58,606 [INFO] app.service.agent.tools.snowflake_tool.real_client: [] Query completed, returned 1 rows\
2025-11-14 08:32:58,606 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake query executed: 1 rows returned\
2025-11-14 08:32:58,606 [WARNING] app.service.investigation.auto_comparison: [] \uc0\u9888 \u65039  No transaction data found for email:okuoku1959122@gmail.com in comparison windows. Window A: 0 transactions, Window B: 0 transactions. Skipping comparison - entity may not have sufficient historical data.\
2025-11-14 08:32:59,607 [INFO] app.service.investigation.auto_comparison: [] \
======================================================================\
2025-11-14 08:32:59,607 [INFO] app.service.investigation.auto_comparison: [] \uc0\u9989  Auto-comparison summary:\
2025-11-14 08:32:59,607 [INFO] app.service.investigation.auto_comparison: []    Total: 3\
2025-11-14 08:32:59,607 [INFO] app.service.investigation.auto_comparison: []    Successful: 0\
2025-11-14 08:32:59,607 [INFO] app.service.investigation.auto_comparison: []    Failed: 3\
2025-11-14 08:32:59,607 [INFO] app.service.investigation.auto_comparison: [] ======================================================================\
2025-11-14 08:32:59,608 [INFO] app.service: [] \uc0\u9989  Auto-comparisons completed: 3 reports generated\
2025-11-14 08:33:34,719 [INFO] uvicorn.access: [] 127.0.0.1:65193 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:33:34,736 [INFO] app.service.etag_service: [investigation_id=0c905de4-f954-4809-95ea-fc967aef96a0, olorin_tid=f1701201-fc8b-4632-945a-b6487ceed7c6] etag_retrieved\
2025-11-14 08:33:34,744 [INFO] uvicorn.access: [] 127.0.0.1:65193 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
2025-11-14 08:33:46,470 [INFO] app.service.rag.investigation_indexer: [] Sample investigation statuses found: \{'IN_PROGRESS', 'COMPLETED'\}\
2025-11-14 08:33:46,470 [INFO] app.service.rag.investigation_indexer: [] Total investigations checked: 10\
2025-11-14 08:33:46,661 [INFO] app.service.rag.investigation_indexer: [] Found 159 investigations with status='COMPLETED'\
2025-11-14 08:33:46,671 [INFO] app.service.rag.vector_rag_service: [] Ingesting document 019365ce-876b-4e69-81f7-d29b4bb25fe2: 1 chunks to create\
[2025-11-14T08:33:46-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:33:46-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.404853 seconds\
[2025-11-14T08:33:47-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
[2025-11-14T08:33:47-0500] INFO [] module=_base_client: Retrying request to /embeddings in 0.760742 seconds\
[2025-11-14T08:33:48-0500] INFO [] module=_client: HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 429 Too Many Requests"\
2025-11-14 08:33:48,099 [ERROR] app.service.rag.embedding_service: [] OpenAI embedding generation failed: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:33:48,099 [WARNING] app.service.rag.vector_rag_service: [] Failed to generate embedding for chunk 0: Error code: 429 - \{'error': \{'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'\}\}\
2025-11-14 08:33:48,099 [INFO] app.service.rag.vector_rag_service: [] Created 1 chunks for document 019365ce-876b-4e69-81f7-d29b4bb25fe2\
2025-11-14 08:33:48,100 [INFO] app.service.rag.investigation_indexer: [] Indexed investigation auto-comp-a022e93e4e7f with 1 chunks\
2025-11-14 08:33:48,168 [INFO] app.service.rag.investigation_indexer: [] Indexed 1 new/updated investigations out of 159 checked\
2025-11-14 08:33:48,168 [INFO] app.service.rag.investigation_indexing_background: [] Indexed 1 new/updated investigations\
2025-11-14 08:34:34,712 [INFO] uvicorn.access: [] 127.0.0.1:65492 - "OPTIONS /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 200\
2025-11-14 08:34:34,761 [INFO] app.service.etag_service: [investigation_id=961ee80e-1022-4d59-877a-c6054a440123, olorin_tid=e86cf38e-42d2-4e09-acfd-9e44dd6179aa] etag_retrieved\
2025-11-14 08:34:34,766 [INFO] uvicorn.access: [] 127.0.0.1:65492 - "GET /api/v1/investigations/inv-1763104709526-la1zm46k/events?limit=50 HTTP/1.1" 304\
^C2025-11-14 08:34:40,137 [INFO] uvicorn.error: [] Shutting down\
2025-11-14 08:34:40,239 [INFO] uvicorn.error: [] Waiting for application shutdown.\
2025-11-14 08:34:40,239 [INFO] app.service: [] Shutting down Olorin application...\
2025-11-14 08:34:40,239 [INFO] app.service: [] \uc0\u55357 \u56588  Disconnecting database provider...\
2025-11-14 08:34:40,239 [INFO] app.service.agent.tools.database_tool.snowflake_provider: [] Snowflake provider disconnect called\
2025-11-14 08:34:40,239 [INFO] app.service: [] \uc0\u9989  Database provider disconnected\
2025-11-14 08:34:40,240 [INFO] app.service: [] \uc0\u9989  Async client cleanup completed\
2025-11-14 08:34:40,240 [INFO] app.service.rag.startup_integration: [] \uc0\u55358 \u56825  Cleaning up RAG system...\
2025-11-14 08:34:40,240 [INFO] app.service.rag.investigation_indexing_background: [] Stopped investigation indexing background service\
2025-11-14 08:34:40,241 [INFO] app.service.rag.startup_integration: [] \uc0\u9989  RAG system cleanup completed\
2025-11-14 08:34:40,241 [INFO] app.service: [] \uc0\u9989  RAG system cleanup completed\
2025-11-14 08:34:40,241 [INFO] app.service: [] \uc0\u9200  Stopping detection scheduler...\
2025-11-14 08:34:40,241 [INFO] app.service.anomaly.scheduler: [] Stopping detection scheduler...\
2025-11-14 08:34:40,241 [INFO] app.service.anomaly.scheduler: [] Detection scheduler stopped\
2025-11-14 08:34:40,241 [INFO] app.service: [] \uc0\u9989  Detection scheduler stopped\
2025-11-14 08:34:40,241 [INFO] app.service.performance.performance_manager: [] Shutting down performance optimization system...\
2025-11-14 08:34:40,242 [INFO] app.service.agent.tools.enhanced_cache.cache: [] Cache cleared\
2025-11-14 08:34:40,242 [INFO] app.service.performance.performance_manager: [] Performance optimization system shutdown completed\
}