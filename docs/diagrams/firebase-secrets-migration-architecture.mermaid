graph TB
    %% Firebase Secrets Migration Architecture for Olorin AI
    
    subgraph "Application Layer"
        APP[Olorin Application]
        CONFIG[Configuration Layer<br/>config.py]
        DBCONFIG[Database Config Helper<br/>database_config.py]
    end
    
    subgraph "Firebase Secrets Integration"
        FBSECRETS[Firebase Secrets Utility<br/>firebase_secrets.py]
        CACHE[LRU Cache<br/>@lru_cache]
        FBAPI[Firebase Secrets Manager API]
    end
    
    subgraph "Fallback Mechanisms"
        ENV[Environment Variables<br/>Local Development]
        DEFAULTS[Configuration Defaults<br/>Non-Critical Secrets]
    end
    
    subgraph "Secret Categories"
        CRITICAL[Critical Secrets<br/>ğŸ” Database Passwords<br/>ğŸ” JWT Keys<br/>ğŸ” API Keys]
        BOOTSTRAP[Bootstrap Secrets<br/>ğŸ”‘ Firebase Credentials<br/>ğŸ”‘ Service Account Keys]
        EXTERNAL[External API Keys<br/>ğŸŒ OpenAI/Anthropic<br/>ğŸŒ Splunk/SumoLogic<br/>ğŸŒ Snowflake]
    end
    
    subgraph "Migration Tools"
        MIGRATOR[migrate-env-to-firebase.py<br/>ğŸ“¦ .env Migration<br/>ğŸ“¦ Docker Compose<br/>ğŸ“¦ Environment Vars]
        MANAGER[firebase-secrets-manager.py<br/>ğŸ› ï¸ Upload/Download<br/>ğŸ› ï¸ Rotate/Delete<br/>ğŸ› ï¸ Validate/List]
        VALIDATOR[validate-secrets.py<br/>âœ… Integration Tests<br/>âœ… Performance Tests<br/>âœ… Config Validation]
        BACKUP[backup-restore-secrets.py<br/>ğŸ’¾ Full Backup<br/>ğŸ’¾ Sync Environments<br/>ğŸ’¾ Disaster Recovery]
    end
    
    subgraph "Testing Framework"
        TESTCONFIG[firebase_secrets_test_config.py<br/>ğŸ§ª Mock Manager<br/>ğŸ§ª Test Fixtures<br/>ğŸ§ª Validation Utils]
        UNITTEST[Unit Tests<br/>ğŸ“‹ Mock Secrets<br/>ğŸ“‹ Fallback Testing]
        INTEGRATION[Integration Tests<br/>ğŸ”— Real Firebase<br/>ğŸ”— Config Testing]
    end
    
    subgraph "Monitoring & Operations"
        METRICS[Performance Metrics<br/>ğŸ“Š Latency < 100ms<br/>ğŸ“Š Success Rate 99.9%<br/>ğŸ“Š Cache Hit Rate]
        ALERTS[Alerting System<br/>ğŸš¨ Retrieval Failures<br/>ğŸš¨ High Latency<br/>ğŸš¨ Connectivity Issues]
        LOGS[Audit Logging<br/>ğŸ“ Access Logs<br/>ğŸ“ Error Tracking<br/>ğŸ“ Performance Data]
    end
    
    %% Flow connections
    APP --> CONFIG
    CONFIG --> DBCONFIG
    DBCONFIG --> FBSECRETS
    
    FBSECRETS --> CACHE
    CACHE --> FBAPI
    
    %% Fallback flows
    FBSECRETS -.-> ENV
    FBSECRETS -.-> DEFAULTS
    
    %% Secret types
    FBAPI --> CRITICAL
    FBAPI --> BOOTSTRAP
    FBAPI --> EXTERNAL
    
    %% Migration flows
    MIGRATOR --> FBAPI
    MANAGER --> FBAPI
    VALIDATOR --> FBAPI
    BACKUP --> FBAPI
    
    %% Testing flows
    TESTCONFIG -.-> FBSECRETS
    UNITTEST --> TESTCONFIG
    INTEGRATION --> FBAPI
    
    %% Monitoring flows
    FBSECRETS --> METRICS
    METRICS --> ALERTS
    FBSECRETS --> LOGS
    
    %% Styling
    classDef appLayer fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef fbLayer fill:#f3e5f5,stroke:#4a148c,stroke-width:2px  
    classDef fallbackLayer fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef secretLayer fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef toolLayer fill:#fff8e1,stroke:#f57f17,stroke-width:2px
    classDef testLayer fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    classDef monitorLayer fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    
    class APP,CONFIG,DBCONFIG appLayer
    class FBSECRETS,CACHE,FBAPI fbLayer
    class ENV,DEFAULTS fallbackLayer
    class CRITICAL,BOOTSTRAP,EXTERNAL secretLayer
    class MIGRATOR,MANAGER,VALIDATOR,BACKUP toolLayer
    class TESTCONFIG,UNITTEST,INTEGRATION testLayer
    class METRICS,ALERTS,LOGS monitorLayer