<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Domain Agent Risk Scoring Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .section {
            margin: 40px 0;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .critical-issues {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
        }
        
        .architecture-flow {
            background: linear-gradient(135deg, #48cae4, #0077b6);
            color: white;
        }
        
        .verification-process {
            background: linear-gradient(135deg, #06ffa5, #02c39a);
            color: white;
        }
        
        .risk-aggregation {
            background: linear-gradient(135deg, #f72585, #b5179e);
            color: white;
        }
        
        .section h2 {
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .diagram-container {
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            overflow-x: auto;
        }
        
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-item {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid rgba(255,255,255,0.8);
        }
        
        .phase-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin: 5px;
        }
        
        .completed { background: #06ffa5; color: #333; }
        .in-progress { background: #feca57; color: #333; }
        .pending { background: #ff6b6b; color: white; }
        
        @media (max-width: 768px) {
            .container { padding: 15px; }
            .header h1 { font-size: 2em; }
            .feature-list { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Domain Agent Risk Scoring Architecture</h1>
<<<<<<< HEAD
            <p><strong>Project:</strong> Olorin Autonomous Investigation System</p>
=======
            <p><strong>Project:</strong> Olorin Structured Investigation System</p>
>>>>>>> 001-modify-analyzer-method
            <p><strong>Date:</strong> September 8, 2025 | <strong>Author:</strong> Gil Klainert</p>
        </div>

        <div class="section critical-issues">
            <h2>üö® Critical Issues Identified</h2>
            <div class="feature-list">
                <div class="feature-item">
                    <h3>Network Agent - VERIFY REAL DATA</h3>
                    <p>Risk Score: 0.9/1.0 - Must verify this comes from real tool data, not mock data</p>
                </div>
                <div class="feature-item">
                    <h3>Failed Domain Agents</h3>
                    <ul>
                        <li>Device Analysis: No results available</li>
                        <li>Location Analysis: No results available</li>
                        <li>Logs Analysis: No results available</li>
                        <li>Risk Aggregation: No results available</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section architecture-flow">
            <h2>üèóÔ∏è Investigation Architecture Flow</h2>
            <div class="diagram-container">
                <div class="mermaid">
                    graph TD
                        A[Investigation Start] --> B[Snowflake Data Query]
                        B --> C{External IP Found?}
                        C -->|Yes| D[Network Agent Analysis]
                        C -->|No| E[Investigation Failed]
                        
                        D --> F[Device Analysis Agent]
                        D --> G[Location Analysis Agent]
                        D --> H[Logs Analysis Agent]
                        
                        F --> I[Threat Intel Tools]
                        G --> J[Geolocation Services]
                        H --> K[SumoLogic Integration]
                        
                        I --> L[VPN/Proxy Detection]
                        I --> M[AbuseIPDB Reputation]
                        I --> N[VirusTotal Analysis]
                        
                        J --> O[IP Geolocation]
                        J --> P[Impossible Travel Detection]
                        
                        K --> Q[Log Pattern Analysis]
                        K --> R[Behavioral Analysis]
                        
                        L --> S[Risk Aggregation Agent]
                        M --> S
                        N --> S
                        O --> S
                        P --> S
                        Q --> S
                        R --> S
                        
                        S --> T[LLM-Based Risk Assessment]
                        T --> U[Final Risk Score & Report]
                        
                        style D fill:#48cae4
                        style F fill:#ff6b6b
                        style G fill:#ff6b6b
                        style H fill:#ff6b6b
                        style S fill:#f72585
                </div>
            </div>
        </div>

        <div class="section verification-process">
            <h2>üîç Live Mode Data Verification Process</h2>
            <div class="diagram-container">
                <div class="mermaid">
                    flowchart LR
                        A[Live Investigation] --> B{Network Agent 0.9 Score}
                        B --> C[Trace VPN/Proxy Detection]
                        B --> D[Trace Cross-Border Analysis]
                        B --> E[Trace Threat Intel APIs]
                        
                        C --> F{Real API Data?}
                        D --> G{Real Geolocation?}
                        E --> H{Real AbuseIPDB/VT?}
                        
                        F -->|Yes| I[‚úÖ Verified Real Data]
                        F -->|No| J[‚ùå Mock Data Found]
                        
                        G -->|Yes| I
                        G -->|No| J
                        
                        H -->|Yes| I  
                        H -->|No| J
                        
                        I --> K[Continue to Agent Fixes]
                        J --> L[Fix Data Sources First]
                        
                        style I fill:#06ffa5
                        style J fill:#ff6b6b
                </div>
            </div>
        </div>

        <div class="section risk-aggregation">
            <h2>üß† New Risk Aggregation Design</h2>
            <div class="diagram-container">
                <div class="mermaid">
                    graph TB
                        A[Network Agent Results] --> E[Risk Aggregation LLM]
                        B[Device Agent Results] --> E
                        C[Location Agent Results] --> E
                        D[Logs Agent Results] --> E
                        
                        E --> F[Comprehensive Analysis Prompt]
                        F --> G{All Agent Findings}
                        G --> H[Chain of Thought Reasoning]
                        H --> I[Risk Factor Interactions]
                        I --> J[Confidence Assessment]
                        J --> K[Final Risk Score]
                        K --> L[Detailed Reasoning Report]
                        
                        M[NOT Simple Average] -.-> E
                        N[Include All Reasoning] -.-> F
                        O[LLM-Based Intelligence] -.-> H
                        
                        style E fill:#f72585
                        style H fill:#b5179e
                        style K fill:#06ffa5
                        style M fill:#ff6b6b
                </div>
            </div>
            
            <div class="feature-list">
                <div class="feature-item">
                    <h3>üö´ NOT a Simple Average</h3>
                    <p>Risk aggregation will use LLM reasoning to analyze interactions between all domain agent findings</p>
                </div>
                <div class="feature-item">
                    <h3>üß† LLM-Based Intelligence</h3>
                    <p>Include all domain agent thoughts, reasoning, and chain of thought in the final analysis</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üìä Implementation Phases</h2>
            <div class="diagram-container">
                <div class="mermaid">
                    timeline
                        title Domain Agent Risk Scoring Fix Timeline
                        
                        Phase 1 : Live Mode Data Verification
                                : Network Agent Verification
                                : Snowflake Data Verification
                                : Real Tool Data Tracing
                        
                        Phase 2 : Domain Agent Failure Analysis  
                                : Device Agent Investigation
                                : Location Agent Investigation
                                : Logs Agent Investigation
                        
                        Phase 3 : Risk Aggregation Redesign
                                : LLM Prompt Design
                                : Agent Integration
                                : Testing Framework
                        
                        Phase 4 : Implementation & Testing
                                : Live Mode Testing
                                : Error Handling
                                : Performance Monitoring
                        
                        Phase 5 : Validation & Documentation
                                : Verification Checklist
                                : Documentation Updates
                                : Troubleshooting Guide
                </div>
            </div>
            
            <div class="feature-list">
                <div class="feature-item">
                    <span class="phase-status completed">‚úÖ Phase 0: Planning</span>
                    <p>Plan created, approved, and documented</p>
                </div>
                <div class="feature-item">
                    <span class="phase-status in-progress">üîÑ Phase 1: Verification</span>
                    <p>Currently verifying real data sources</p>
                </div>
                <div class="feature-item">
                    <span class="phase-status pending">‚è≥ Phase 2-5: Pending</span>
                    <p>Awaiting Phase 1 completion</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'neutral',
            flowchart: {
                curve: 'basis',
                padding: 20
            },
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#333',
                primaryBorderColor: '#764ba2',
                lineColor: '#764ba2',
                sectionBkgColor: '#f8f9fa',
                altSectionBkgColor: '#e9ecef',
                gridColor: '#dee2e6',
                secondaryColor: '#48cae4',
                tertiaryColor: '#06ffa5'
            }
        });
    </script>
</body>
</html>