<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LangGraph Clean Architecture - Interactive Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            text-align: center;
            color: white;
            padding: 40px 0;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin-bottom: 30px;
        }
        h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .subtitle {
            margin-top: 10px;
            font-size: 1.2em;
            opacity: 0.95;
        }
        .diagram-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .diagram-title {
            color: #333;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        .diagram-description {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        .mermaid {
            text-align: center;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .feature-card h3 {
            margin-top: 0;
            font-size: 1.3em;
        }
        .feature-card ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .phase-timeline {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .phase-item {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        .phase-number {
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 20px;
        }
        .phase-content h4 {
            margin: 0 0 5px 0;
            color: #333;
        }
        .phase-content p {
            margin: 0;
            color: #666;
        }
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            h1 {
                font-size: 1.8em;
            }
            .diagram-container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ LangGraph Clean Architecture</h1>
            <div class="subtitle">Complete Fraud Investigation System with 52 Tools</div>
        </div>

        <!-- Overall Architecture -->
        <div class="diagram-container">
            <h2 class="diagram-title">Overall System Architecture</h2>
            <p class="diagram-description">
                High-level view of the complete LangGraph investigation system showing the orchestrator, 
                tools node, and all domain agents working together.
            </p>
            <div class="mermaid">
                graph TB
                    Start([Start Investigation]) --> DI[Data Ingestion]
                    DI --> O[Orchestrator Agent]
                    
                    O --> |"Tool Calls"| T[Tools Node<br/>52 Tools]
                    T --> |"Tool Results"| O
                    
                    O --> |"Phase: Domain Analysis"| DA{Domain Agents}
                    
                    DA --> NA[Network Agent]
                    DA --> DEA[Device Agent]
                    DA --> LA[Location Agent]
                    DA --> LOA[Logs Agent]
                    DA --> RA[Risk Agent]
                    
                    NA --> O
                    DEA --> O
                    LA --> O
                    LOA --> O
                    RA --> O
                    
                    O --> |"Phase: Summary"| S[Summary Node]
                    S --> End([End])
                    
                    style O fill:#667eea,stroke:#fff,stroke-width:3px,color:#fff
                    style T fill:#28a745,stroke:#fff,stroke-width:3px,color:#fff
                    style NA fill:#17a2b8,stroke:#fff,stroke-width:2px,color:#fff
                    style DEA fill:#17a2b8,stroke:#fff,stroke-width:2px,color:#fff
                    style LA fill:#17a2b8,stroke:#fff,stroke-width:2px,color:#fff
                    style LOA fill:#17a2b8,stroke:#fff,stroke-width:2px,color:#fff
                    style RA fill:#17a2b8,stroke:#fff,stroke-width:2px,color:#fff
            </div>
        </div>

        <!-- Investigation Flow -->
        <div class="diagram-container">
            <h2 class="diagram-title">Investigation Flow & Phases</h2>
            <p class="diagram-description">
                Detailed flow showing how the investigation progresses through different phases,
                with Snowflake analysis as the mandatory first step.
            </p>
            <div class="mermaid">
                graph LR
                    Init[Initialization] --> SF[Snowflake Analysis<br/>30-Day Lookback]
                    SF --> |"Snowflake Results"| TE[Tool Execution<br/>Based on Findings]
                    TE --> |"Tool Results"| DA[Domain Analysis<br/>5 Agents]
                    DA --> |"Domain Findings"| RS[Risk Scoring]
                    RS --> Sum[Summary Generation]
                    
                    SF -.->|"MANDATORY"| SF1[Query IP Patterns]
                    SF -.->|"MANDATORY"| SF2[Query Risk Scores]
                    SF -.->|"MANDATORY"| SF3[Query Fraud Indicators]
                    
                    TE -.->|"Selected Tools"| T1[Threat Intelligence]
                    TE -.->|"Selected Tools"| T2[Blockchain Analysis]
                    TE -.->|"Selected Tools"| T3[ML/AI Analysis]
                    
                    style SF fill:#ff6b6b,stroke:#fff,stroke-width:3px,color:#fff
                    style TE fill:#4ecdc4,stroke:#fff,stroke-width:2px,color:#fff
                    style DA fill:#45b7d1,stroke:#fff,stroke-width:2px,color:#fff
            </div>
        </div>

        <!-- Tool Categories -->
        <div class="diagram-container">
            <h2 class="diagram-title">Tool Categories & Integration</h2>
            <p class="diagram-description">
                All 52 tools organized by category, bound to the orchestrator LLM for intelligent selection.
            </p>
            <div class="mermaid">
                graph TD
                    O[Orchestrator LLM] --> |"bind_tools()"| TN[Tool Node]
                    
                    TN --> C1[Olorin Tools]
                    TN --> C2[Threat Intelligence]
                    TN --> C3[Database/SIEM]
                    TN --> C4[Blockchain]
                    TN --> C5[ML/AI Analysis]
                    TN --> C6[Web/OSINT]
                    TN --> C7[Utility Tools]
                    
                    C1 --> |"PRIMARY"| Snow[Snowflake<br/>30-Day Analysis]
                    C1 --> Splunk[Splunk]
                    C1 --> Sumo[SumoLogic]
                    
                    C2 --> VT[VirusTotal]
                    C2 --> Abuse[AbuseIPDB]
                    C2 --> Shodan[Shodan]
                    
                    C3 --> DB1[Query Tools]
                    C3 --> DB2[Schema Tools]
                    
                    C4 --> Crypto[Crypto Analysis]
                    C4 --> NFT[NFT Tracking]
                    
                    C5 --> Anomaly[Anomaly Detection]
                    C5 --> Pattern[Pattern Recognition]
                    
                    C6 --> OSINT[OSINT Tools]
                    C6 --> Social[Social Media]
                    
                    style Snow fill:#ff6b6b,stroke:#fff,stroke-width:3px,color:#fff
                    style O fill:#667eea,stroke:#fff,stroke-width:3px,color:#fff
                    style TN fill:#28a745,stroke:#fff,stroke-width:3px,color:#fff
            </div>
        </div>

        <!-- State Management -->
        <div class="diagram-container">
            <h2 class="diagram-title">State Management & Message Flow</h2>
            <p class="diagram-description">
                How state flows through the graph and ensures proper tool_use ‚Üí tool_result sequencing.
            </p>
            <div class="mermaid">
                sequenceDiagram
                    participant S as State
                    participant O as Orchestrator
                    participant T as Tools Node
                    participant A as Domain Agents
                    
                    S->>O: Initial State
                    O->>O: Check Phase
                    O->>S: Update Phase: snowflake_analysis
                    
                    O->>T: AIMessage with tool_calls
                    T->>T: Execute Tools
                    T->>O: ToolMessages with results
                    O->>S: Update snowflake_data
                    
                    O->>S: Update Phase: domain_analysis
                    O->>A: Route to Agents
                    A->>A: Analyze Domain
                    A->>S: Update domain_findings
                    A->>O: Return Control
                    
                    O->>S: Calculate risk_score
                    O->>S: Update Phase: complete
            </div>
        </div>

        <!-- Routing Logic -->
        <div class="diagram-container">
            <h2 class="diagram-title">Routing Decision Logic</h2>
            <p class="diagram-description">
                How the orchestrator decides where to route based on state and message content.
            </p>
            <div class="mermaid">
                graph TD
                    O[Orchestrator] --> Check{Check Last Message}
                    
                    Check --> |"Has tool_calls?"| Tools[Route to Tools]
                    Check --> |"No tool_calls"| Phase{Check Phase}
                    
                    Phase --> |"snowflake_analysis"| CheckSF{Snowflake Done?}
                    CheckSF --> |"No"| Tools
                    CheckSF --> |"Yes"| NextPhase[Next Phase]
                    
                    Phase --> |"domain_analysis"| Parallel{Parallel Mode?}
                    Parallel --> |"Yes"| AllAgents[All Agents]
                    Parallel --> |"No"| Sequential[Sequential Agents]
                    
                    Phase --> |"summary"| Summary[Summary Node]
                    
                    Tools --> O
                    AllAgents --> O
                    Sequential --> O
                    Summary --> End[End]
                    
                    style O fill:#667eea,stroke:#fff,stroke-width:3px,color:#fff
                    style Tools fill:#28a745,stroke:#fff,stroke-width:3px,color:#fff
                    style AllAgents fill:#17a2b8,stroke:#fff,stroke-width:2px,color:#fff
            </div>
        </div>

        <!-- Implementation Timeline -->
        <div class="phase-timeline">
            <h2 class="diagram-title">Implementation Timeline</h2>
            
            <div class="phase-item">
                <div class="phase-number">1</div>
                <div class="phase-content">
                    <h4>Week 1: Core Development</h4>
                    <p>Build orchestrator, state schema, and basic graph structure</p>
                </div>
            </div>
            
            <div class="phase-item">
                <div class="phase-number">2</div>
                <div class="phase-content">
                    <h4>Week 2: Integration</h4>
                    <p>Integrate all 52 tools and implement domain agents</p>
                </div>
            </div>
            
            <div class="phase-item">
                <div class="phase-number">3</div>
                <div class="phase-content">
                    <h4>Week 3: Testing</h4>
                    <p>Comprehensive unit and integration testing</p>
                </div>
            </div>
            
            <div class="phase-item">
                <div class="phase-number">4</div>
                <div class="phase-content">
                    <h4>Week 4: Staging</h4>
                    <p>Deploy to staging environment for validation</p>
                </div>
            </div>
            
            <div class="phase-item">
                <div class="phase-number">5</div>
                <div class="phase-content">
                    <h4>Week 5: Production</h4>
                    <p>Gradual rollout with feature flags</p>
                </div>
            </div>
        </div>

        <!-- Key Features -->
        <div class="features-grid">
            <div class="feature-card">
                <h3>üéØ Central Orchestration</h3>
                <ul>
                    <li>Single orchestrator managing flow</li>
                    <li>Phase-based investigation</li>
                    <li>Intelligent tool selection</li>
                    <li>State management</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>üîß 52 Tools Integration</h3>
                <ul>
                    <li>All tools in single node</li>
                    <li>No circular references</li>
                    <li>Proper message sequencing</li>
                    <li>Error handling</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>‚ùÑÔ∏è Snowflake First</h3>
                <ul>
                    <li>Mandatory 30-day analysis</li>
                    <li>Primary data source</li>
                    <li>Pattern detection</li>
                    <li>Risk scoring</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>ü§ñ 5 Domain Agents</h3>
                <ul>
                    <li>Network analysis</li>
                    <li>Device fingerprinting</li>
                    <li>Location verification</li>
                    <li>Logs analysis</li>
                    <li>Risk assessment</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>‚ö° Performance</h3>
                <ul>
                    <li>Parallel execution</li>
                    <li>Optimized routing</li>
                    <li>< 30 second investigations</li>
                    <li>95%+ success rate</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>üìä Monitoring</h3>
                <ul>
                    <li>Phase tracking</li>
                    <li>Tool usage audit</li>
                    <li>Error reporting</li>
                    <li>Performance metrics</li>
                </ul>
            </div>
        </div>

    </div>

    <script>
        // Initialize Mermaid
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#fff',
                primaryBorderColor: '#764ba2',
                lineColor: '#667eea',
                secondaryColor: '#764ba2',
                tertiaryColor: '#f8f9fa'
            }
        });
    </script>
</body>
</html>