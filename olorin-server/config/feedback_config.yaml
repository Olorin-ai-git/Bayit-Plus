# Feedback Loop Configuration
# Feature: 026-llm-training-pipeline
# Controls the feedback collection and prompt optimization process

feedback:
  # Master switch for feedback collection
  enabled: ${LLM_FEEDBACK_ENABLED:true}

  # Collection settings
  collection:
    # Collect feedback from completed investigations
    collect_from_investigations: ${LLM_FEEDBACK_COLLECT_INVESTIGATIONS:true}
    # Collect feedback from confusion matrix results
    collect_from_confusion_matrix: ${LLM_FEEDBACK_COLLECT_CONFUSION_MATRIX:true}
    # Minimum samples before triggering optimization
    min_samples_for_optimization: ${LLM_FEEDBACK_MIN_SAMPLES:50}
    # Maximum samples to store per prompt version
    max_samples_per_version: ${LLM_FEEDBACK_MAX_SAMPLES:1000}

  # Performance thresholds that trigger optimization
  thresholds:
    # Minimum acceptable precision
    min_precision: ${LLM_FEEDBACK_PRECISION_THRESHOLD:0.85}
    # Minimum acceptable recall
    min_recall: ${LLM_FEEDBACK_RECALL_THRESHOLD:0.80}
    # Minimum acceptable F1 score
    min_f1_score: ${LLM_FEEDBACK_F1_THRESHOLD:0.82}
    # Maximum acceptable false positive rate
    max_false_positive_rate: ${LLM_FEEDBACK_MAX_FPR:0.15}
    # Maximum acceptable false negative rate
    max_false_negative_rate: ${LLM_FEEDBACK_MAX_FNR:0.20}

  # Optimization settings
  optimization:
    # Enable automatic prompt optimization
    auto_optimize: ${LLM_FEEDBACK_AUTO_OPTIMIZE:true}
    # Optimization frequency (in hours)
    optimization_frequency_hours: ${LLM_FEEDBACK_OPTIMIZATION_FREQUENCY:24}
    # Maximum optimization iterations per cycle
    max_iterations: ${LLM_FEEDBACK_MAX_ITERATIONS:3}
    # Improvement threshold to accept new prompt
    improvement_threshold: ${LLM_FEEDBACK_IMPROVEMENT_THRESHOLD:0.02}

  # Rollback settings
  rollback:
    # Enable automatic rollback on degradation
    auto_rollback: ${LLM_FEEDBACK_AUTO_ROLLBACK:true}
    # Degradation threshold to trigger rollback (percentage)
    degradation_threshold: ${LLM_FEEDBACK_DEGRADATION_THRESHOLD:0.10}
    # Keep N previous prompt versions for rollback
    versions_to_keep: ${LLM_FEEDBACK_VERSIONS_TO_KEEP:5}

  # Storage settings
  storage:
    # Directory for feedback data
    feedback_directory: ${LLM_FEEDBACK_DIRECTORY:data/feedback}
    # Enable persistent storage
    persistent_storage: ${LLM_FEEDBACK_PERSISTENT_STORAGE:true}
    # Retention period for feedback data (days)
    retention_days: ${LLM_FEEDBACK_RETENTION_DAYS:90}

  # Metrics tracking
  metrics:
    # Track metrics over time
    track_metrics: ${LLM_FEEDBACK_TRACK_METRICS:true}
    # Metrics aggregation window (hours)
    aggregation_window_hours: ${LLM_FEEDBACK_AGGREGATION_WINDOW:1}
    # Export metrics to external system
    export_enabled: ${LLM_FEEDBACK_METRICS_EXPORT:false}
