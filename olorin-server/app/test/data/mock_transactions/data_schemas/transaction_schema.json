{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Transaction Data Schema",
  "description": "Schema for realistic transaction data used in structured investigation testing",
  "type": "object",
  "properties": {
    "transaction": {
      "type": "object",
      "properties": {
        "transaction_id": {
          "type": "string",
          "description": "Unique transaction identifier"
        },
        "amount": {
          "type": "number",
          "description": "Transaction amount in USD"
        },
        "currency": {
          "type": "string",
          "default": "USD"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Transaction timestamp in ISO 8601 format"
        },
        "merchant": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string"
            },
            "category": {
              "type": "string"
            },
            "location": {
              "$ref": "#/definitions/location"
            }
          },
          "required": ["name", "category", "location"]
        }
      },
      "required": ["transaction_id", "amount", "timestamp", "merchant"]
    },
    "user": {
      "type": "object",
      "properties": {
        "user_id": {
          "type": "string"
        },
        "account_age_days": {
          "type": "integer"
        },
        "historical_patterns": {
          "type": "object",
          "properties": {
            "avg_transaction_amount": {
              "type": "number"
            },
            "common_locations": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/location"
              }
            },
            "typical_spending_categories": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      },
      "required": ["user_id", "account_age_days"]
    },
    "device": {
      "type": "object",
      "properties": {
        "device_id": {
          "type": "string"
        },
        "fingerprint": {
          "type": "object",
          "properties": {
            "user_agent": {
              "type": "string"
            },
            "screen_resolution": {
              "type": "string"
            },
            "timezone": {
              "type": "string"
            },
            "language": {
              "type": "string"
            },
            "platform": {
              "type": "string"
            },
            "browser": {
              "type": "string"
            }
          },
          "required": ["user_agent", "screen_resolution", "timezone"]
        },
        "first_seen": {
          "type": "string",
          "format": "date-time"
        },
        "is_trusted": {
          "type": "boolean"
        }
      },
      "required": ["device_id", "fingerprint", "first_seen", "is_trusted"]
    },
    "location": {
      "$ref": "#/definitions/location"
    },
    "network": {
      "type": "object",
      "properties": {
        "ip": {
          "type": "string",
          "format": "ipv4"
        },
        "proxy_detected": {
          "type": "boolean"
        },
        "vpn_detected": {
          "type": "boolean"
        },
        "tor_detected": {
          "type": "boolean"
        },
        "country_code": {
          "type": "string",
          "pattern": "^[A-Z]{2}$"
        },
        "asn": {
          "type": "string"
        },
        "isp": {
          "type": "string"
        }
      },
      "required": ["ip", "country_code"]
    },
    "behavioral_signals": {
      "type": "object",
      "properties": {
        "velocity_indicators": {
          "type": "object",
          "properties": {
            "transactions_last_hour": {
              "type": "integer"
            },
            "transactions_last_day": {
              "type": "integer"
            },
            "unique_devices_last_day": {
              "type": "integer"
            }
          }
        },
        "session_info": {
          "type": "object",
          "properties": {
            "session_duration": {
              "type": "integer",
              "description": "Session duration in seconds"
            },
            "pages_visited": {
              "type": "integer"
            },
            "time_on_checkout": {
              "type": "integer",
              "description": "Time spent on checkout page in seconds"
            }
          }
        }
      }
    }
  },
  "required": ["transaction", "user", "device", "location", "network"],
  "definitions": {
    "location": {
      "type": "object",
      "properties": {
        "latitude": {
          "type": "number",
          "minimum": -90,
          "maximum": 90
        },
        "longitude": {
          "type": "number",
          "minimum": -180,
          "maximum": 180
        },
        "city": {
          "type": "string"
        },
        "state": {
          "type": "string"
        },
        "country": {
          "type": "string"
        },
        "postal_code": {
          "type": "string"
        }
      },
      "required": ["latitude", "longitude", "city", "country"]
    }
  }
}