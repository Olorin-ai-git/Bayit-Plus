# Account Takeover (ATO) Detection System Configuration
# This file contains all configurable parameters for the fraud detection system

# Network Analysis Configuration
network:
  # Threshold for VPN-based risk (0.0 to 1.0)
  # Higher values mean VPN usage is considered more risky
  vpn_risk_threshold: 0.7

  # Threshold for proxy-based risk (0.0 to 1.0)
  # Higher values mean proxy usage is considered more risky
  proxy_risk_threshold: 0.8

  # Maximum allowed IP changes per day before flagging as suspicious
  ip_change_threshold: 5

# Device Fingerprint Configuration
device:
  # Maximum allowed device changes per week
  # Example: Switching between laptop, mobile, tablet
  device_change_threshold: 3

  # Maximum allowed browser changes per day
  # Example: Switching between Chrome, Firefox, Safari
  browser_change_threshold: 2

  # Threshold for unusual screen resolution (0.0 to 1.0)
  # Percentage of historical records that must contain a resolution
  # for it to be considered "normal"
  resolution_change_threshold: 0.1

# User Behavior Configuration
behavior:
  # Maximum number of login attempts per day before flagging
  login_frequency_threshold: 10

  # Maximum session duration in minutes before flagging
  session_duration_threshold: 120

  # Threshold for unusual login hours (0.0 to 1.0)
  # Percentage of historical logins that must occur in an hour
  # for it to be considered "normal"
  unusual_hour_threshold: 0.1

# Anomaly Detection Configuration
anomaly:
  # Risk threshold for high-risk activities (0.0 to 1.0)
  # Risks above this threshold trigger immediate alerts
  high_risk_threshold: 0.8

  # Risk threshold for medium-risk activities (0.0 to 1.0)
  # Must be lower than high_risk_threshold
  medium_risk_threshold: 0.6

  # Weights for different risk types (must sum to 1.0)
  network_weight: 0.35
  device_weight: 0.35
  behavior_weight: 0.30

  # Minimum number of correlated anomalies needed to
  # trigger a correlation-based risk increase
  correlation_threshold: 2

# System-wide Configuration
# Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
log_level: "INFO"

# Number of days to retain historical data
data_retention_days: 90

# Feature Flags
features:
  # Enable machine learning-based risk scoring
  enable_ml_scoring: false
  
  # Enable real-time alert notifications
  enable_realtime_alerts: true
  
  # Enable correlation analysis across users
  enable_cross_user_analysis: false

# Alert Thresholds
alerts:
  # Minimum risk score to trigger email alerts
  email_alert_threshold: 0.7
  
  # Minimum risk score to trigger SMS alerts
  sms_alert_threshold: 0.8
  
  # Minimum risk score to trigger account lockdown
  lockdown_threshold: 0.9

# Rate Limiting
rate_limits:
  # Maximum API requests per minute per user
  max_requests_per_minute: 60
  
  # Maximum concurrent sessions per user
  max_concurrent_sessions: 3
  
  # Cool-down period (in minutes) after reaching rate limit
  rate_limit_cooldown: 15

# Whitelisting
whitelist:
  # IPs that should never be considered suspicious
  trusted_ips:
    - "10.0.0.0/8"      # Internal network
    - "192.168.0.0/16"  # VPN network
  
  # User agents that should never be considered suspicious
  trusted_user_agents:
    - "Company Mobile App/1.0"
    - "Internal Tool/2.0"

# Blacklisting
blacklist:
  # Known malicious IP ranges
  blocked_ip_ranges:
    - "185.128.0.0/16"  # Known botnet
    
  # Known malicious ISPs
  blocked_isps:
    - "Suspicious ISP Ltd"
    
  # Countries with high fraud rates
  high_risk_countries:
    - "XX"
    - "YY" 